{"remainingRequest":"/Users/zzou/Downloads/backup_sample/node_modules/thread-loader/dist/cjs.js!/Users/zzou/Downloads/backup_sample/node_modules/babel-loader/lib/index.js!/Users/zzou/Downloads/backup_sample/node_modules/bootstrap-vue/esm/directives/scrollspy/helpers/bv-scrollspy.class.js","dependencies":[{"path":"/Users/zzou/Downloads/backup_sample/node_modules/bootstrap-vue/esm/directives/scrollspy/helpers/bv-scrollspy.class.js","mtime":1610263603568},{"path":"/Users/zzou/Downloads/backup_sample/node_modules/cache-loader/dist/cjs.js","mtime":1582363961748},{"path":"/Users/zzou/Downloads/backup_sample/node_modules/thread-loader/dist/cjs.js","mtime":1582363962038},{"path":"/Users/zzou/Downloads/backup_sample/node_modules/babel-loader/lib/index.js","mtime":1585275399303}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucmVkdWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc29ydCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5kZWZpbmUtcHJvcGVydGllcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5kZWZpbmUtcHJvcGVydHkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5jb25zdHJ1Y3RvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5tYXRjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnRpbWVycyI7CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsKICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7CgogIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7CiAgICB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsKICAgIGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsKICAgICAgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7CiAgICB9KTsKICAgIGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsKICB9CgogIHJldHVybiBrZXlzOwp9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgewogIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7CiAgICB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsKCiAgICBpZiAoaSAlIDIpIHsKICAgICAgb3duS2V5cyhPYmplY3Qoc291cmNlKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgewogICAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOwogICAgfSBlbHNlIHsKICAgICAgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7CiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7CiAgICAgIH0pOwogICAgfQogIH0KCiAgcmV0dXJuIHRhcmdldDsKfQoKZnVuY3Rpb24gX2RlZmluZVByb3BlcnR5KG9iaiwga2V5LCB2YWx1ZSkgewogIGlmIChrZXkgaW4gb2JqKSB7CiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHsKICAgICAgdmFsdWU6IHZhbHVlLAogICAgICBlbnVtZXJhYmxlOiB0cnVlLAogICAgICBjb25maWd1cmFibGU6IHRydWUsCiAgICAgIHdyaXRhYmxlOiB0cnVlCiAgICB9KTsKICB9IGVsc2UgewogICAgb2JqW2tleV0gPSB2YWx1ZTsKICB9CgogIHJldHVybiBvYmo7Cn0KCmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsKICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgewogICAgdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uIik7CiAgfQp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgewogICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsKICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsKICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsKICAgIGlmICgidmFsdWUiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOwogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOwogIH0KfQoKZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgewogIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOwogIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsKICByZXR1cm4gQ29uc3RydWN0b3I7Cn0KLyoKICogU2Nyb2xsU3B5IGNsYXNzIGRlZmluaXRpb24KICovCgoKaW1wb3J0IHsgRVZFTlRfT1BUSU9OU19OT19DQVBUVVJFIH0gZnJvbSAnLi4vLi4vLi4vY29uc3RhbnRzL2V2ZW50cyc7CmltcG9ydCB7IFJYX0hSRUYgfSBmcm9tICcuLi8uLi8uLi9jb25zdGFudHMvcmVnZXgnOwppbXBvcnQgeyBhZGRDbGFzcywgY2xvc2VzdCwgZ2V0QXR0ciwgZ2V0QkNSLCBoYXNDbGFzcywgaXNFbGVtZW50LCBpc1Zpc2libGUsIG1hdGNoZXMsIG9mZnNldCwgcG9zaXRpb24sIHJlbW92ZUNsYXNzLCBzZWxlY3QsIHNlbGVjdEFsbCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL2RvbSc7CmltcG9ydCB7IGdldFJvb3RFdmVudE5hbWUsIGV2ZW50T24sIGV2ZW50T2ZmIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvZXZlbnRzJzsKaW1wb3J0IHsgaWRlbnRpdHkgfSBmcm9tICcuLi8uLi8uLi91dGlscy9pZGVudGl0eSc7CmltcG9ydCB7IGlzU3RyaW5nLCBpc1VuZGVmaW5lZCB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL2luc3BlY3QnOwppbXBvcnQgeyBtYXRoTWF4IH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvbWF0aCc7CmltcG9ydCB7IHRvSW50ZWdlciB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL251bWJlcic7CmltcG9ydCB7IGhhc093blByb3BlcnR5LCB0b1N0cmluZyBhcyBvYmplY3RUb1N0cmluZyB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL29iamVjdCc7CmltcG9ydCB7IG9ic2VydmVEb20gfSBmcm9tICcuLi8uLi8uLi91dGlscy9vYnNlcnZlLWRvbSc7CmltcG9ydCB7IHdhcm4gfSBmcm9tICcuLi8uLi8uLi91dGlscy93YXJuJzsKLyoKICogQ29uc3RhbnRzIC8gRGVmYXVsdHMKICovCgp2YXIgTkFNRSA9ICd2LWItc2Nyb2xsc3B5JzsKdmFyIENMQVNTX05BTUVfRFJPUERPV05fSVRFTSA9ICdkcm9wZG93bi1pdGVtJzsKdmFyIENMQVNTX05BTUVfQUNUSVZFID0gJ2FjdGl2ZSc7CnZhciBTRUxFQ1RPUl9OQVZfTElTVF9HUk9VUCA9ICcubmF2LCAubGlzdC1ncm91cCc7CnZhciBTRUxFQ1RPUl9OQVZfTElOS1MgPSAnLm5hdi1saW5rJzsKdmFyIFNFTEVDVE9SX05BVl9JVEVNUyA9ICcubmF2LWl0ZW0nOwp2YXIgU0VMRUNUT1JfTElTVF9JVEVNUyA9ICcubGlzdC1ncm91cC1pdGVtJzsKdmFyIFNFTEVDVE9SX0RST1BET1dOID0gJy5kcm9wZG93biwgLmRyb3B1cCc7CnZhciBTRUxFQ1RPUl9EUk9QRE9XTl9JVEVNUyA9ICcuZHJvcGRvd24taXRlbSc7CnZhciBTRUxFQ1RPUl9EUk9QRE9XTl9UT0dHTEUgPSAnLmRyb3Bkb3duLXRvZ2dsZSc7CnZhciBST09UX0VWRU5UX05BTUVfQUNUSVZBVEUgPSBnZXRSb290RXZlbnROYW1lKCdCVlNjcm9sbHNweScsICdhY3RpdmF0ZScpOwp2YXIgTUVUSE9EX09GRlNFVCA9ICdvZmZzZXQnOwp2YXIgTUVUSE9EX1BPU0lUSU9OID0gJ3Bvc2l0aW9uJzsKdmFyIERlZmF1bHQgPSB7CiAgZWxlbWVudDogJ2JvZHknLAogIG9mZnNldDogMTAsCiAgbWV0aG9kOiAnYXV0bycsCiAgdGhyb3R0bGU6IDc1Cn07CnZhciBEZWZhdWx0VHlwZSA9IHsKICBlbGVtZW50OiAnKHN0cmluZ3xlbGVtZW50fGNvbXBvbmVudCknLAogIG9mZnNldDogJ251bWJlcicsCiAgbWV0aG9kOiAnc3RyaW5nJywKICB0aHJvdHRsZTogJ251bWJlcicKfTsgLy8gVHJhbnNpdGlvbiBFdmVudHMKCnZhciBUcmFuc2l0aW9uRW5kRXZlbnRzID0gWyd3ZWJraXRUcmFuc2l0aW9uRW5kJywgJ3RyYW5zaXRpb25lbmQnLCAnb3RyYW5zaXRpb25lbmQnLCAnb1RyYW5zaXRpb25FbmQnXTsKLyoKICogVXRpbGl0eSBNZXRob2RzCiAqLwovLyBCZXR0ZXIgdmFyIHR5cGUgZGV0ZWN0aW9uCgp2YXIgdG9UeXBlID0gZnVuY3Rpb24gdG9UeXBlKG9iaikKLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IG5vdCBlYXN5IHRvIHRlc3QgKi8KewogIHJldHVybiBvYmplY3RUb1N0cmluZyhvYmopLm1hdGNoKC9ccyhbYS16QS1aXSspLylbMV0udG9Mb3dlckNhc2UoKTsKfTsgLy8gQ2hlY2sgY29uZmlnIHByb3BlcnRpZXMgZm9yIGV4cGVjdGVkIHR5cGVzCgovKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoKCnZhciB0eXBlQ2hlY2tDb25maWcgPSBmdW5jdGlvbiB0eXBlQ2hlY2tDb25maWcoY29tcG9uZW50TmFtZSwgY29uZmlnLCBjb25maWdUeXBlcykKLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IG5vdCBlYXN5IHRvIHRlc3QgKi8KewogIGZvciAodmFyIHByb3BlcnR5IGluIGNvbmZpZ1R5cGVzKSB7CiAgICBpZiAoaGFzT3duUHJvcGVydHkoY29uZmlnVHlwZXMsIHByb3BlcnR5KSkgewogICAgICB2YXIgZXhwZWN0ZWRUeXBlcyA9IGNvbmZpZ1R5cGVzW3Byb3BlcnR5XTsKICAgICAgdmFyIHZhbHVlID0gY29uZmlnW3Byb3BlcnR5XTsKICAgICAgdmFyIHZhbHVlVHlwZSA9IHZhbHVlICYmIGlzRWxlbWVudCh2YWx1ZSkgPyAnZWxlbWVudCcgOiB0b1R5cGUodmFsdWUpOyAvLyBoYW5kbGUgVnVlIGluc3RhbmNlcwoKICAgICAgdmFsdWVUeXBlID0gdmFsdWUgJiYgdmFsdWUuX2lzVnVlID8gJ2NvbXBvbmVudCcgOiB2YWx1ZVR5cGU7CgogICAgICBpZiAoIW5ldyBSZWdFeHAoZXhwZWN0ZWRUeXBlcykudGVzdCh2YWx1ZVR5cGUpKSB7CiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KICAgICAgICB3YXJuKCIiLmNvbmNhdChjb21wb25lbnROYW1lLCAiOiBPcHRpb24gXCIiKS5jb25jYXQocHJvcGVydHksICJcIiBwcm92aWRlZCB0eXBlIFwiIikuY29uY2F0KHZhbHVlVHlwZSwgIlwiIGJ1dCBleHBlY3RlZCB0eXBlIFwiIikuY29uY2F0KGV4cGVjdGVkVHlwZXMsICJcIiIpKTsKICAgICAgfQogICAgfQogIH0KfTsKLyoKICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAqIENsYXNzIERlZmluaXRpb24KICogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCiAqLwoKLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IG5vdCBlYXN5IHRvIHRlc3QgKi8KCgpleHBvcnQgdmFyIEJWU2Nyb2xsU3B5Ci8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBub3QgZWFzeSB0byB0ZXN0ICovCj0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQlZTY3JvbGxTcHkoZWxlbWVudCwgY29uZmlnLCAkcm9vdCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJWU2Nyb2xsU3B5KTsgLy8gVGhlIGVsZW1lbnQgd2UgYWN0aXZhdGUgbGlua3MgaW4KCgogICAgdGhpcy4kZWwgPSBlbGVtZW50OwogICAgdGhpcy4kc2Nyb2xsZXIgPSBudWxsOwogICAgdGhpcy4kc2VsZWN0b3IgPSBbU0VMRUNUT1JfTkFWX0xJTktTLCBTRUxFQ1RPUl9MSVNUX0lURU1TLCBTRUxFQ1RPUl9EUk9QRE9XTl9JVEVNU10uam9pbignLCcpOwogICAgdGhpcy4kb2Zmc2V0cyA9IFtdOwogICAgdGhpcy4kdGFyZ2V0cyA9IFtdOwogICAgdGhpcy4kYWN0aXZlVGFyZ2V0ID0gbnVsbDsKICAgIHRoaXMuJHNjcm9sbEhlaWdodCA9IDA7CiAgICB0aGlzLiRyZXNpemVUaW1lb3V0ID0gbnVsbDsKICAgIHRoaXMuJHNjcm9sbGVyT2JzZXJ2ZXIgPSBudWxsOwogICAgdGhpcy4kdGFyZ2V0c09ic2VydmVyID0gbnVsbDsKICAgIHRoaXMuJHJvb3QgPSAkcm9vdCB8fCBudWxsOwogICAgdGhpcy4kY29uZmlnID0gbnVsbDsKICAgIHRoaXMudXBkYXRlQ29uZmlnKGNvbmZpZyk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQlZTY3JvbGxTcHksIFt7CiAgICBrZXk6ICJ1cGRhdGVDb25maWciLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZUNvbmZpZyhjb25maWcsICRyb290KSB7CiAgICAgIGlmICh0aGlzLiRzY3JvbGxlcikgewogICAgICAgIC8vIEp1c3QgaW4gY2FzZSBvdXQgc2Nyb2xsIGVsZW1lbnQgaGFzIGNoYW5nZWQKICAgICAgICB0aGlzLnVubGlzdGVuKCk7CiAgICAgICAgdGhpcy4kc2Nyb2xsZXIgPSBudWxsOwogICAgICB9CgogICAgICB2YXIgY2ZnID0gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCB0aGlzLmNvbnN0cnVjdG9yLkRlZmF1bHQpLCBjb25maWcpOwoKICAgICAgaWYgKCRyb290KSB7CiAgICAgICAgdGhpcy4kcm9vdCA9ICRyb290OwogICAgICB9CgogICAgICB0eXBlQ2hlY2tDb25maWcodGhpcy5jb25zdHJ1Y3Rvci5OYW1lLCBjZmcsIHRoaXMuY29uc3RydWN0b3IuRGVmYXVsdFR5cGUpOwogICAgICB0aGlzLiRjb25maWcgPSBjZmc7CgogICAgICBpZiAodGhpcy4kcm9vdCkgewogICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICB0aGlzLiRyb290LiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICBzZWxmLmxpc3RlbigpOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMubGlzdGVuKCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJkaXNwb3NlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkaXNwb3NlKCkgewogICAgICB0aGlzLnVubGlzdGVuKCk7CiAgICAgIGNsZWFyVGltZW91dCh0aGlzLiRyZXNpemVUaW1lb3V0KTsKICAgICAgdGhpcy4kcmVzaXplVGltZW91dCA9IG51bGw7CiAgICAgIHRoaXMuJGVsID0gbnVsbDsKICAgICAgdGhpcy4kY29uZmlnID0gbnVsbDsKICAgICAgdGhpcy4kc2Nyb2xsZXIgPSBudWxsOwogICAgICB0aGlzLiRzZWxlY3RvciA9IG51bGw7CiAgICAgIHRoaXMuJG9mZnNldHMgPSBudWxsOwogICAgICB0aGlzLiR0YXJnZXRzID0gbnVsbDsKICAgICAgdGhpcy4kYWN0aXZlVGFyZ2V0ID0gbnVsbDsKICAgICAgdGhpcy4kc2Nyb2xsSGVpZ2h0ID0gbnVsbDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsaXN0ZW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGxpc3RlbigpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBzY3JvbGxlciA9IHRoaXMuZ2V0U2Nyb2xsZXIoKTsKCiAgICAgIGlmIChzY3JvbGxlciAmJiBzY3JvbGxlci50YWdOYW1lICE9PSAnQk9EWScpIHsKICAgICAgICBldmVudE9uKHNjcm9sbGVyLCAnc2Nyb2xsJywgdGhpcywgRVZFTlRfT1BUSU9OU19OT19DQVBUVVJFKTsKICAgICAgfQoKICAgICAgZXZlbnRPbih3aW5kb3csICdzY3JvbGwnLCB0aGlzLCBFVkVOVF9PUFRJT05TX05PX0NBUFRVUkUpOwogICAgICBldmVudE9uKHdpbmRvdywgJ3Jlc2l6ZScsIHRoaXMsIEVWRU5UX09QVElPTlNfTk9fQ0FQVFVSRSk7CiAgICAgIGV2ZW50T24od2luZG93LCAnb3JpZW50YXRpb25jaGFuZ2UnLCB0aGlzLCBFVkVOVF9PUFRJT05TX05PX0NBUFRVUkUpOwogICAgICBUcmFuc2l0aW9uRW5kRXZlbnRzLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50TmFtZSkgewogICAgICAgIGV2ZW50T24od2luZG93LCBldmVudE5hbWUsIF90aGlzLCBFVkVOVF9PUFRJT05TX05PX0NBUFRVUkUpOwogICAgICB9KTsKICAgICAgdGhpcy5zZXRPYnNlcnZlcnModHJ1ZSk7IC8vIFNjaGVkdWxlIGEgcmVmcmVzaAoKICAgICAgdGhpcy5oYW5kbGVFdmVudCgncmVmcmVzaCcpOwogICAgfQogIH0sIHsKICAgIGtleTogInVubGlzdGVuIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1bmxpc3RlbigpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICB2YXIgc2Nyb2xsZXIgPSB0aGlzLmdldFNjcm9sbGVyKCk7CiAgICAgIHRoaXMuc2V0T2JzZXJ2ZXJzKGZhbHNlKTsKCiAgICAgIGlmIChzY3JvbGxlciAmJiBzY3JvbGxlci50YWdOYW1lICE9PSAnQk9EWScpIHsKICAgICAgICBldmVudE9mZihzY3JvbGxlciwgJ3Njcm9sbCcsIHRoaXMsIEVWRU5UX09QVElPTlNfTk9fQ0FQVFVSRSk7CiAgICAgIH0KCiAgICAgIGV2ZW50T2ZmKHdpbmRvdywgJ3Njcm9sbCcsIHRoaXMsIEVWRU5UX09QVElPTlNfTk9fQ0FQVFVSRSk7CiAgICAgIGV2ZW50T2ZmKHdpbmRvdywgJ3Jlc2l6ZScsIHRoaXMsIEVWRU5UX09QVElPTlNfTk9fQ0FQVFVSRSk7CiAgICAgIGV2ZW50T2ZmKHdpbmRvdywgJ29yaWVudGF0aW9uY2hhbmdlJywgdGhpcywgRVZFTlRfT1BUSU9OU19OT19DQVBUVVJFKTsKICAgICAgVHJhbnNpdGlvbkVuZEV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChldmVudE5hbWUpIHsKICAgICAgICBldmVudE9mZih3aW5kb3csIGV2ZW50TmFtZSwgX3RoaXMyLCBFVkVOVF9PUFRJT05TX05PX0NBUFRVUkUpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRPYnNlcnZlcnMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldE9ic2VydmVycyhvbikgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsgLy8gV2Ugb2JzZXJ2ZSBib3RoIHRoZSBzY3JvbGxlciBmb3IgY29udGVudCBjaGFuZ2VzLCBhbmQgdGhlIHRhcmdldCBsaW5rcwoKCiAgICAgIHRoaXMuJHNjcm9sbGVyT2JzZXJ2ZXIgJiYgdGhpcy4kc2Nyb2xsZXJPYnNlcnZlci5kaXNjb25uZWN0KCk7CiAgICAgIHRoaXMuJHRhcmdldHNPYnNlcnZlciAmJiB0aGlzLiR0YXJnZXRzT2JzZXJ2ZXIuZGlzY29ubmVjdCgpOwogICAgICB0aGlzLiRzY3JvbGxlck9ic2VydmVyID0gbnVsbDsKICAgICAgdGhpcy4kdGFyZ2V0c09ic2VydmVyID0gbnVsbDsKCiAgICAgIGlmIChvbikgewogICAgICAgIHRoaXMuJHRhcmdldHNPYnNlcnZlciA9IG9ic2VydmVEb20odGhpcy4kZWwsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzMy5oYW5kbGVFdmVudCgnbXV0YXRpb24nKTsKICAgICAgICB9LCB7CiAgICAgICAgICBzdWJ0cmVlOiB0cnVlLAogICAgICAgICAgY2hpbGRMaXN0OiB0cnVlLAogICAgICAgICAgYXR0cmlidXRlczogdHJ1ZSwKICAgICAgICAgIGF0dHJpYnV0ZUZpbHRlcjogWydocmVmJ10KICAgICAgICB9KTsKICAgICAgICB0aGlzLiRzY3JvbGxlck9ic2VydmVyID0gb2JzZXJ2ZURvbSh0aGlzLmdldFNjcm9sbGVyKCksIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzMy5oYW5kbGVFdmVudCgnbXV0YXRpb24nKTsKICAgICAgICB9LCB7CiAgICAgICAgICBzdWJ0cmVlOiB0cnVlLAogICAgICAgICAgY2hpbGRMaXN0OiB0cnVlLAogICAgICAgICAgY2hhcmFjdGVyRGF0YTogdHJ1ZSwKICAgICAgICAgIGF0dHJpYnV0ZXM6IHRydWUsCiAgICAgICAgICBhdHRyaWJ1dGVGaWx0ZXI6IFsnaWQnLCAnc3R5bGUnLCAnY2xhc3MnXQogICAgICAgIH0pOwogICAgICB9CiAgICB9IC8vIEdlbmVyYWwgZXZlbnQgaGFuZGxlcgoKICB9LCB7CiAgICBrZXk6ICJoYW5kbGVFdmVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlRXZlbnQoZXZlbnQpIHsKICAgICAgdmFyIHR5cGUgPSBpc1N0cmluZyhldmVudCkgPyBldmVudCA6IGV2ZW50LnR5cGU7CiAgICAgIHZhciBzZWxmID0gdGhpczsKCiAgICAgIHZhciByZXNpemVUaHJvdHRsZSA9IGZ1bmN0aW9uIHJlc2l6ZVRocm90dGxlKCkgewogICAgICAgIGlmICghc2VsZi4kcmVzaXplVGltZW91dCkgewogICAgICAgICAgc2VsZi4kcmVzaXplVGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgICBzZWxmLnJlZnJlc2goKTsKICAgICAgICAgICAgc2VsZi5wcm9jZXNzKCk7CiAgICAgICAgICAgIHNlbGYuJHJlc2l6ZVRpbWVvdXQgPSBudWxsOwogICAgICAgICAgfSwgc2VsZi4kY29uZmlnLnRocm90dGxlKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICBpZiAodHlwZSA9PT0gJ3Njcm9sbCcpIHsKICAgICAgICBpZiAoIXRoaXMuJHNjcm9sbGVyT2JzZXJ2ZXIpIHsKICAgICAgICAgIC8vIEp1c3QgaW4gY2FzZSB3ZSBhcmUgYWRkZWQgdG8gdGhlIERPTSBiZWZvcmUgdGhlIHNjcm9sbCB0YXJnZXQgaXMKICAgICAgICAgIC8vIFdlIHJlLWluc3RhbnRpYXRlIG91ciBsaXN0ZW5lcnMsIGp1c3QgaW4gY2FzZQogICAgICAgICAgdGhpcy5saXN0ZW4oKTsKICAgICAgICB9CgogICAgICAgIHRoaXMucHJvY2VzcygpOwogICAgICB9IGVsc2UgaWYgKC8ocmVzaXplfG9yaWVudGF0aW9uY2hhbmdlfG11dGF0aW9ufHJlZnJlc2gpLy50ZXN0KHR5cGUpKSB7CiAgICAgICAgLy8gUG9zdHBvbmUgdGhlc2UgZXZlbnRzIGJ5IHRocm90dGxlIHRpbWUKICAgICAgICByZXNpemVUaHJvdHRsZSgpOwogICAgICB9CiAgICB9IC8vIFJlZnJlc2ggdGhlIGxpc3Qgb2YgdGFyZ2V0IGxpbmtzIG9uIHRoZSBlbGVtZW50IHdlIGFyZSBhcHBsaWVkIHRvCgogIH0sIHsKICAgIGtleTogInJlZnJlc2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlZnJlc2goKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdmFyIHNjcm9sbGVyID0gdGhpcy5nZXRTY3JvbGxlcigpOwoKICAgICAgaWYgKCFzY3JvbGxlcikgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGF1dG9NZXRob2QgPSBzY3JvbGxlciAhPT0gc2Nyb2xsZXIud2luZG93ID8gTUVUSE9EX1BPU0lUSU9OIDogTUVUSE9EX09GRlNFVDsKICAgICAgdmFyIG1ldGhvZCA9IHRoaXMuJGNvbmZpZy5tZXRob2QgPT09ICdhdXRvJyA/IGF1dG9NZXRob2QgOiB0aGlzLiRjb25maWcubWV0aG9kOwogICAgICB2YXIgbWV0aG9kRm4gPSBtZXRob2QgPT09IE1FVEhPRF9QT1NJVElPTiA/IHBvc2l0aW9uIDogb2Zmc2V0OwogICAgICB2YXIgb2Zmc2V0QmFzZSA9IG1ldGhvZCA9PT0gTUVUSE9EX1BPU0lUSU9OID8gdGhpcy5nZXRTY3JvbGxUb3AoKSA6IDA7CiAgICAgIHRoaXMuJG9mZnNldHMgPSBbXTsKICAgICAgdGhpcy4kdGFyZ2V0cyA9IFtdOwogICAgICB0aGlzLiRzY3JvbGxIZWlnaHQgPSB0aGlzLmdldFNjcm9sbEhlaWdodCgpOyAvLyBGaW5kIGFsbCB0aGUgdW5pcXVlIGxpbmsgSFJFRnMgdGhhdCB3ZSB3aWxsIGNvbnRyb2wKCiAgICAgIHNlbGVjdEFsbCh0aGlzLiRzZWxlY3RvciwgdGhpcy4kZWwpIC8vIEdldCBIUkVGIHZhbHVlCiAgICAgIC5tYXAoZnVuY3Rpb24gKGxpbmspIHsKICAgICAgICByZXR1cm4gZ2V0QXR0cihsaW5rLCAnaHJlZicpOwogICAgICB9KSAvLyBGaWx0ZXIgb3V0IEhSRUZzIHRoYXQgZG8gbm90IG1hdGNoIG91ciBSZWdFeHAKICAgICAgLmZpbHRlcihmdW5jdGlvbiAoaHJlZikgewogICAgICAgIHJldHVybiBocmVmICYmIFJYX0hSRUYudGVzdChocmVmIHx8ICcnKTsKICAgICAgfSkgLy8gRmluZCBhbGwgZWxlbWVudHMgd2l0aCBJRCB0aGF0IG1hdGNoIEhSRUYgaGFzaAogICAgICAubWFwKGZ1bmN0aW9uIChocmVmKSB7CiAgICAgICAgLy8gQ29udmVydCBIUkVGIGludG8gYW4gSUQgKGluY2x1ZGluZyAjIGF0IGJlZ2lubmluZykKICAgICAgICB2YXIgaWQgPSBocmVmLnJlcGxhY2UoUlhfSFJFRiwgJyQxJykudHJpbSgpOwoKICAgICAgICBpZiAoIWlkKSB7CiAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICB9IC8vIEZpbmQgdGhlIGVsZW1lbnQgd2l0aCB0aGUgSUQgc3BlY2lmaWVkIGJ5IGlkCgoKICAgICAgICB2YXIgZWwgPSBzZWxlY3QoaWQsIHNjcm9sbGVyKTsKCiAgICAgICAgaWYgKGVsICYmIGlzVmlzaWJsZShlbCkpIHsKICAgICAgICAgIHJldHVybiB7CiAgICAgICAgICAgIG9mZnNldDogdG9JbnRlZ2VyKG1ldGhvZEZuKGVsKS50b3AsIDApICsgb2Zmc2V0QmFzZSwKICAgICAgICAgICAgdGFyZ2V0OiBpZAogICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIHJldHVybiBudWxsOwogICAgICB9KS5maWx0ZXIoaWRlbnRpdHkpIC8vIFNvcnQgdGhlbSBieSB0aGVpciBvZmZzZXRzIChzbWFsbGVzdCBmaXJzdCkKICAgICAgLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgICByZXR1cm4gYS5vZmZzZXQgLSBiLm9mZnNldDsKICAgICAgfSkgLy8gcmVjb3JkIG9ubHkgdW5pcXVlIHRhcmdldHMvb2Zmc2V0cwogICAgICAucmVkdWNlKGZ1bmN0aW9uIChtZW1vLCBpdGVtKSB7CiAgICAgICAgaWYgKCFtZW1vW2l0ZW0udGFyZ2V0XSkgewogICAgICAgICAgX3RoaXM0LiRvZmZzZXRzLnB1c2goaXRlbS5vZmZzZXQpOwoKICAgICAgICAgIF90aGlzNC4kdGFyZ2V0cy5wdXNoKGl0ZW0udGFyZ2V0KTsKCiAgICAgICAgICBtZW1vW2l0ZW0udGFyZ2V0XSA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gbWVtbzsKICAgICAgfSwge30pOyAvLyBSZXR1cm4gdGhpcyBmb3IgZWFzeSBjaGFpbmluZwoKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9IC8vIEhhbmRsZSBhY3RpdmF0aW5nL2NsZWFyaW5nCgogIH0sIHsKICAgIGtleTogInByb2Nlc3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByb2Nlc3MoKSB7CiAgICAgIHZhciBzY3JvbGxUb3AgPSB0aGlzLmdldFNjcm9sbFRvcCgpICsgdGhpcy4kY29uZmlnLm9mZnNldDsKICAgICAgdmFyIHNjcm9sbEhlaWdodCA9IHRoaXMuZ2V0U2Nyb2xsSGVpZ2h0KCk7CiAgICAgIHZhciBtYXhTY3JvbGwgPSB0aGlzLiRjb25maWcub2Zmc2V0ICsgc2Nyb2xsSGVpZ2h0IC0gdGhpcy5nZXRPZmZzZXRIZWlnaHQoKTsKCiAgICAgIGlmICh0aGlzLiRzY3JvbGxIZWlnaHQgIT09IHNjcm9sbEhlaWdodCkgewogICAgICAgIHRoaXMucmVmcmVzaCgpOwogICAgICB9CgogICAgICBpZiAoc2Nyb2xsVG9wID49IG1heFNjcm9sbCkgewogICAgICAgIHZhciB0YXJnZXQgPSB0aGlzLiR0YXJnZXRzW3RoaXMuJHRhcmdldHMubGVuZ3RoIC0gMV07CgogICAgICAgIGlmICh0aGlzLiRhY3RpdmVUYXJnZXQgIT09IHRhcmdldCkgewogICAgICAgICAgdGhpcy5hY3RpdmF0ZSh0YXJnZXQpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy4kYWN0aXZlVGFyZ2V0ICYmIHNjcm9sbFRvcCA8IHRoaXMuJG9mZnNldHNbMF0gJiYgdGhpcy4kb2Zmc2V0c1swXSA+IDApIHsKICAgICAgICB0aGlzLiRhY3RpdmVUYXJnZXQgPSBudWxsOwogICAgICAgIHRoaXMuY2xlYXIoKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGZvciAodmFyIGkgPSB0aGlzLiRvZmZzZXRzLmxlbmd0aDsgaS0tOykgewogICAgICAgIHZhciBpc0FjdGl2ZVRhcmdldCA9IHRoaXMuJGFjdGl2ZVRhcmdldCAhPT0gdGhpcy4kdGFyZ2V0c1tpXSAmJiBzY3JvbGxUb3AgPj0gdGhpcy4kb2Zmc2V0c1tpXSAmJiAoaXNVbmRlZmluZWQodGhpcy4kb2Zmc2V0c1tpICsgMV0pIHx8IHNjcm9sbFRvcCA8IHRoaXMuJG9mZnNldHNbaSArIDFdKTsKCiAgICAgICAgaWYgKGlzQWN0aXZlVGFyZ2V0KSB7CiAgICAgICAgICB0aGlzLmFjdGl2YXRlKHRoaXMuJHRhcmdldHNbaV0pOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogImdldFNjcm9sbGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTY3JvbGxlcigpIHsKICAgICAgaWYgKHRoaXMuJHNjcm9sbGVyKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJHNjcm9sbGVyOwogICAgICB9CgogICAgICB2YXIgc2Nyb2xsZXIgPSB0aGlzLiRjb25maWcuZWxlbWVudDsKCiAgICAgIGlmICghc2Nyb2xsZXIpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfSBlbHNlIGlmIChpc0VsZW1lbnQoc2Nyb2xsZXIuJGVsKSkgewogICAgICAgIHNjcm9sbGVyID0gc2Nyb2xsZXIuJGVsOwogICAgICB9IGVsc2UgaWYgKGlzU3RyaW5nKHNjcm9sbGVyKSkgewogICAgICAgIHNjcm9sbGVyID0gc2VsZWN0KHNjcm9sbGVyKTsKICAgICAgfQoKICAgICAgaWYgKCFzY3JvbGxlcikgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CgogICAgICB0aGlzLiRzY3JvbGxlciA9IHNjcm9sbGVyLnRhZ05hbWUgPT09ICdCT0RZJyA/IHdpbmRvdyA6IHNjcm9sbGVyOwogICAgICByZXR1cm4gdGhpcy4kc2Nyb2xsZXI7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0U2Nyb2xsVG9wIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTY3JvbGxUb3AoKSB7CiAgICAgIHZhciBzY3JvbGxlciA9IHRoaXMuZ2V0U2Nyb2xsZXIoKTsKICAgICAgcmV0dXJuIHNjcm9sbGVyID09PSB3aW5kb3cgPyBzY3JvbGxlci5wYWdlWU9mZnNldCA6IHNjcm9sbGVyLnNjcm9sbFRvcDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRTY3JvbGxIZWlnaHQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFNjcm9sbEhlaWdodCgpIHsKICAgICAgcmV0dXJuIHRoaXMuZ2V0U2Nyb2xsZXIoKS5zY3JvbGxIZWlnaHQgfHwgbWF0aE1heChkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodCwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbEhlaWdodCk7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0T2Zmc2V0SGVpZ2h0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRPZmZzZXRIZWlnaHQoKSB7CiAgICAgIHZhciBzY3JvbGxlciA9IHRoaXMuZ2V0U2Nyb2xsZXIoKTsKICAgICAgcmV0dXJuIHNjcm9sbGVyID09PSB3aW5kb3cgPyB3aW5kb3cuaW5uZXJIZWlnaHQgOiBnZXRCQ1Ioc2Nyb2xsZXIpLmhlaWdodDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJhY3RpdmF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWN0aXZhdGUodGFyZ2V0KSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgdGhpcy4kYWN0aXZlVGFyZ2V0ID0gdGFyZ2V0OwogICAgICB0aGlzLmNsZWFyKCk7IC8vIEdyYWIgdGhlIGxpc3Qgb2YgdGFyZ2V0IGxpbmtzICg8YSBocmVmPSJ7JHRhcmdldH0iPikKCiAgICAgIHZhciBsaW5rcyA9IHNlbGVjdEFsbCh0aGlzLiRzZWxlY3RvciAvLyBTcGxpdCBvdXQgdGhlIGJhc2Ugc2VsZWN0b3JzCiAgICAgIC5zcGxpdCgnLCcpIC8vIE1hcCB0byBhIHNlbGVjdG9yIHRoYXQgbWF0Y2hlcyBsaW5rcyB3aXRoIEhSRUYgZW5kaW5nIGluIHRoZSBJRCAoaW5jbHVkaW5nICcjJykKICAgICAgLm1hcChmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgICAgICByZXR1cm4gIiIuY29uY2F0KHNlbGVjdG9yLCAiW2hyZWYkPVwiIikuY29uY2F0KHRhcmdldCwgIlwiXSIpOwogICAgICB9KSAvLyBKb2luIGJhY2sgaW50byBhIHNpbmdsZSBzZWxlY3RvciBzdHJpbmcKICAgICAgLmpvaW4oJywnKSwgdGhpcy4kZWwpOwogICAgICBsaW5rcy5mb3JFYWNoKGZ1bmN0aW9uIChsaW5rKSB7CiAgICAgICAgaWYgKGhhc0NsYXNzKGxpbmssIENMQVNTX05BTUVfRFJPUERPV05fSVRFTSkpIHsKICAgICAgICAgIC8vIFRoaXMgaXMgYSBkcm9wZG93biBpdGVtLCBzbyBmaW5kIHRoZSAuZHJvcGRvd24tdG9nZ2xlIGFuZCBzZXQgaXRzIHN0YXRlCiAgICAgICAgICB2YXIgZHJvcGRvd24gPSBjbG9zZXN0KFNFTEVDVE9SX0RST1BET1dOLCBsaW5rKTsKCiAgICAgICAgICBpZiAoZHJvcGRvd24pIHsKICAgICAgICAgICAgX3RoaXM1LnNldEFjdGl2ZVN0YXRlKHNlbGVjdChTRUxFQ1RPUl9EUk9QRE9XTl9UT0dHTEUsIGRyb3Bkb3duKSwgdHJ1ZSk7CiAgICAgICAgICB9IC8vIEFsc28gc2V0IHRoaXMgbGluaydzIHN0YXRlCgoKICAgICAgICAgIF90aGlzNS5zZXRBY3RpdmVTdGF0ZShsaW5rLCB0cnVlKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gU2V0IHRyaWdnZXJlZCBsaW5rIGFzIGFjdGl2ZQogICAgICAgICAgX3RoaXM1LnNldEFjdGl2ZVN0YXRlKGxpbmssIHRydWUpOwoKICAgICAgICAgIGlmIChtYXRjaGVzKGxpbmsucGFyZW50RWxlbWVudCwgU0VMRUNUT1JfTkFWX0lURU1TKSkgewogICAgICAgICAgICAvLyBIYW5kbGUgbmF2LWxpbmsgaW5zaWRlIG5hdi1pdGVtLCBhbmQgc2V0IG5hdi1pdGVtIGFjdGl2ZQogICAgICAgICAgICBfdGhpczUuc2V0QWN0aXZlU3RhdGUobGluay5wYXJlbnRFbGVtZW50LCB0cnVlKTsKICAgICAgICAgIH0gLy8gU2V0IHRyaWdnZXJlZCBsaW5rcyBwYXJlbnRzIGFzIGFjdGl2ZQogICAgICAgICAgLy8gV2l0aCBib3RoIDx1bD4gYW5kIDxuYXY+IG1hcmt1cCBhIHBhcmVudCBpcyB0aGUgcHJldmlvdXMgc2libGluZyBvZiBhbnkgbmF2IGFuY2VzdG9yCgoKICAgICAgICAgIHZhciBlbCA9IGxpbms7CgogICAgICAgICAgd2hpbGUgKGVsKSB7CiAgICAgICAgICAgIGVsID0gY2xvc2VzdChTRUxFQ1RPUl9OQVZfTElTVF9HUk9VUCwgZWwpOwogICAgICAgICAgICB2YXIgc2libGluZyA9IGVsID8gZWwucHJldmlvdXNFbGVtZW50U2libGluZyA6IG51bGw7CgogICAgICAgICAgICBpZiAoc2libGluZyAmJiBtYXRjaGVzKHNpYmxpbmcsICIiLmNvbmNhdChTRUxFQ1RPUl9OQVZfTElOS1MsICIsICIpLmNvbmNhdChTRUxFQ1RPUl9MSVNUX0lURU1TKSkpIHsKICAgICAgICAgICAgICBfdGhpczUuc2V0QWN0aXZlU3RhdGUoc2libGluZywgdHJ1ZSk7CiAgICAgICAgICAgIH0gLy8gSGFuZGxlIHNwZWNpYWwgY2FzZSB3aGVyZSBuYXYtbGluayBpcyBpbnNpZGUgYSBuYXYtaXRlbQoKCiAgICAgICAgICAgIGlmIChzaWJsaW5nICYmIG1hdGNoZXMoc2libGluZywgU0VMRUNUT1JfTkFWX0lURU1TKSkgewogICAgICAgICAgICAgIF90aGlzNS5zZXRBY3RpdmVTdGF0ZShzZWxlY3QoU0VMRUNUT1JfTkFWX0xJTktTLCBzaWJsaW5nKSwgdHJ1ZSk7IC8vIEFkZCBhY3RpdmUgc3RhdGUgdG8gbmF2LWl0ZW0gYXMgd2VsbAoKCiAgICAgICAgICAgICAgX3RoaXM1LnNldEFjdGl2ZVN0YXRlKHNpYmxpbmcsIHRydWUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsgLy8gU2lnbmFsIGV2ZW50IHRvIHZpYSAkcm9vdCwgcGFzc2luZyBJRCBvZiBhY3RpdmF0ZWQgdGFyZ2V0IGFuZCByZWZlcmVuY2UgdG8gYXJyYXkgb2YgbGlua3MKCiAgICAgIGlmIChsaW5rcyAmJiBsaW5rcy5sZW5ndGggPiAwICYmIHRoaXMuJHJvb3QpIHsKICAgICAgICB0aGlzLiRyb290LiRlbWl0KFJPT1RfRVZFTlRfTkFNRV9BQ1RJVkFURSwgdGFyZ2V0LCBsaW5rcyk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJjbGVhciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xlYXIoKSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgc2VsZWN0QWxsKCIiLmNvbmNhdCh0aGlzLiRzZWxlY3RvciwgIiwgIikuY29uY2F0KFNFTEVDVE9SX05BVl9JVEVNUyksIHRoaXMuJGVsKS5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgcmV0dXJuIGhhc0NsYXNzKGVsLCBDTEFTU19OQU1FX0FDVElWRSk7CiAgICAgIH0pLmZvckVhY2goZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgcmV0dXJuIF90aGlzNi5zZXRBY3RpdmVTdGF0ZShlbCwgZmFsc2UpOwogICAgICB9KTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRBY3RpdmVTdGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0QWN0aXZlU3RhdGUoZWwsIGFjdGl2ZSkgewogICAgICBpZiAoIWVsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoYWN0aXZlKSB7CiAgICAgICAgYWRkQ2xhc3MoZWwsIENMQVNTX05BTUVfQUNUSVZFKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZW1vdmVDbGFzcyhlbCwgQ0xBU1NfTkFNRV9BQ1RJVkUpOwogICAgICB9CiAgICB9CiAgfV0sIFt7CiAgICBrZXk6ICJOYW1lIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gTkFNRTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJEZWZhdWx0IiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gRGVmYXVsdDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJEZWZhdWx0VHlwZSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuIERlZmF1bHRUeXBlOwogICAgfQogIH1dKTsKCiAgcmV0dXJuIEJWU2Nyb2xsU3B5Owp9KCk7"},null]}