{"remainingRequest":"/Users/zzou/Downloads/backup_sample/node_modules/thread-loader/dist/cjs.js!/Users/zzou/Downloads/backup_sample/node_modules/babel-loader/lib/index.js!/Users/zzou/Downloads/backup_sample/node_modules/bootstrap-vue/esm/components/calendar/calendar.js","dependencies":[{"path":"/Users/zzou/Downloads/backup_sample/node_modules/bootstrap-vue/esm/components/calendar/calendar.js","mtime":1610263603568},{"path":"/Users/zzou/Downloads/backup_sample/node_modules/cache-loader/dist/cjs.js","mtime":1582363961748},{"path":"/Users/zzou/Downloads/backup_sample/node_modules/thread-loader/dist/cjs.js","mtime":1582363962038},{"path":"/Users/zzou/Downloads/backup_sample/node_modules/babel-loader/lib/index.js","mtime":1585275399303}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5qb2luIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkubWFwIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZGVmaW5lLXByb3BlcnRpZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZGVmaW5lLXByb3BlcnR5IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3JzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7Cgp2YXIgX3dhdGNoOwoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7CiAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOwoKICBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgewogICAgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7CiAgICBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7CiAgICAgIHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOwogICAgfSk7CiAgICBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7CiAgfQoKICByZXR1cm4ga2V5czsKfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsKICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgewogICAgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307CgogICAgaWYgKGkgJSAyKSB7CiAgICAgIG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsKICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsKICAgIH0gZWxzZSB7CiAgICAgIG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgewogICAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOwogICAgICB9KTsKICAgIH0KICB9CgogIHJldHVybiB0YXJnZXQ7Cn0KCmZ1bmN0aW9uIF9kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgdmFsdWUpIHsKICBpZiAoa2V5IGluIG9iaikgewogICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KG9iaiwga2V5LCB7CiAgICAgIHZhbHVlOiB2YWx1ZSwKICAgICAgZW51bWVyYWJsZTogdHJ1ZSwKICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICB3cml0YWJsZTogdHJ1ZQogICAgfSk7CiAgfSBlbHNlIHsKICAgIG9ialtrZXldID0gdmFsdWU7CiAgfQoKICByZXR1cm4gb2JqOwp9CgppbXBvcnQgeyBWdWUgfSBmcm9tICcuLi8uLi92dWUnOwppbXBvcnQgeyBOQU1FX0NBTEVOREFSIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL2NvbXBvbmVudHMnOwppbXBvcnQgeyBDQUxFTkRBUl9HUkVHT1JZLCBDQUxFTkRBUl9MT05HLCBDQUxFTkRBUl9OQVJST1csIENBTEVOREFSX1NIT1JULCBEQVRFX0ZPUk1BVF8yX0RJR0lULCBEQVRFX0ZPUk1BVF9OVU1FUklDIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL2RhdGUnOwppbXBvcnQgeyBFVkVOVF9OQU1FX0NPTlRFWFQsIEVWRU5UX05BTUVfU0VMRUNURUQgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvZXZlbnRzJzsKaW1wb3J0IHsgQ09ERV9ET1dOLCBDT0RFX0VORCwgQ09ERV9FTlRFUiwgQ09ERV9IT01FLCBDT0RFX0xFRlQsIENPREVfUEFHRURPV04sIENPREVfUEFHRVVQLCBDT0RFX1JJR0hULCBDT0RFX1NQQUNFLCBDT0RFX1VQIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL2tleS1jb2Rlcyc7CmltcG9ydCB7IFBST1BfVFlQRV9BUlJBWV9TVFJJTkcsIFBST1BfVFlQRV9CT09MRUFOLCBQUk9QX1RZUEVfREFURV9TVFJJTkcsIFBST1BfVFlQRV9GVU5DVElPTiwgUFJPUF9UWVBFX05VTUJFUl9TVFJJTkcsIFBST1BfVFlQRV9PQkpFQ1QsIFBST1BfVFlQRV9TVFJJTkcgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvcHJvcHMnOwppbXBvcnQgeyBTTE9UX05BTUVfTkFWX05FWFRfREVDQURFLCBTTE9UX05BTUVfTkFWX05FWFRfTU9OVEgsIFNMT1RfTkFNRV9OQVZfTkVYVF9ZRUFSLCBTTE9UX05BTUVfTkFWX1BFVl9ERUNBREUsIFNMT1RfTkFNRV9OQVZfUEVWX01PTlRILCBTTE9UX05BTUVfTkFWX1BFVl9ZRUFSLCBTTE9UX05BTUVfTkFWX1RISVNfTU9OVEggfSBmcm9tICcuLi8uLi9jb25zdGFudHMvc2xvdHMnOwppbXBvcnQgeyBhcnJheUluY2x1ZGVzLCBjb25jYXQgfSBmcm9tICcuLi8uLi91dGlscy9hcnJheSc7CmltcG9ydCB7IGNyZWF0ZURhdGUsIGNyZWF0ZURhdGVGb3JtYXR0ZXIsIGNvbnN0cmFpbkRhdGUgYXMgX2NvbnN0cmFpbkRhdGUsIGRhdGVzRXF1YWwsIGZpcnN0RGF0ZU9mTW9udGgsIGZvcm1hdFlNRCwgbGFzdERhdGVPZk1vbnRoLCBvbmVNb250aEFnbywgb25lTW9udGhBaGVhZCwgb25lWWVhckFnbywgb25lWWVhckFoZWFkLCBvbmVEZWNhZGVBZ28sIG9uZURlY2FkZUFoZWFkLCBwYXJzZVlNRCwgcmVzb2x2ZUxvY2FsZSB9IGZyb20gJy4uLy4uL3V0aWxzL2RhdGUnOwppbXBvcnQgeyBhdHRlbXB0Qmx1ciwgYXR0ZW1wdEZvY3VzLCByZXF1ZXN0QUYgfSBmcm9tICcuLi8uLi91dGlscy9kb20nOwppbXBvcnQgeyBzdG9wRXZlbnQgfSBmcm9tICcuLi8uLi91dGlscy9ldmVudHMnOwppbXBvcnQgeyBpZGVudGl0eSB9IGZyb20gJy4uLy4uL3V0aWxzL2lkZW50aXR5JzsKaW1wb3J0IHsgaXNBcnJheSwgaXNQbGFpbk9iamVjdCwgaXNTdHJpbmcgfSBmcm9tICcuLi8uLi91dGlscy9pbnNwZWN0JzsKaW1wb3J0IHsgaXNMb2NhbGVSVEwgfSBmcm9tICcuLi8uLi91dGlscy9sb2NhbGUnOwppbXBvcnQgeyBsb29zZUVxdWFsIH0gZnJvbSAnLi4vLi4vdXRpbHMvbG9vc2UtZXF1YWwnOwppbXBvcnQgeyBtYXRoTWF4IH0gZnJvbSAnLi4vLi4vdXRpbHMvbWF0aCc7CmltcG9ydCB7IG1ha2VNb2RlbE1peGluIH0gZnJvbSAnLi4vLi4vdXRpbHMvbW9kZWwnOwppbXBvcnQgeyB0b0ludGVnZXIgfSBmcm9tICcuLi8uLi91dGlscy9udW1iZXInOwppbXBvcnQgeyBzb3J0S2V5cyB9IGZyb20gJy4uLy4uL3V0aWxzL29iamVjdCc7CmltcG9ydCB7IGhhc1Byb3BGdW5jdGlvbiwgbWFrZVByb3AsIG1ha2VQcm9wc0NvbmZpZ3VyYWJsZSB9IGZyb20gJy4uLy4uL3V0aWxzL3Byb3BzJzsKaW1wb3J0IHsgdG9TdHJpbmcgfSBmcm9tICcuLi8uLi91dGlscy9zdHJpbmcnOwppbXBvcnQgeyBhdHRyc01peGluIH0gZnJvbSAnLi4vLi4vbWl4aW5zL2F0dHJzJzsKaW1wb3J0IHsgaWRNaXhpbiwgcHJvcHMgYXMgaWRQcm9wcyB9IGZyb20gJy4uLy4uL21peGlucy9pZCc7CmltcG9ydCB7IG5vcm1hbGl6ZVNsb3RNaXhpbiB9IGZyb20gJy4uLy4uL21peGlucy9ub3JtYWxpemUtc2xvdCc7CmltcG9ydCB7IEJJY29uQ2hldnJvbkxlZnQsIEJJY29uQ2hldnJvbkRvdWJsZUxlZnQsIEJJY29uQ2hldnJvbkJhckxlZnQsIEJJY29uQ2lyY2xlRmlsbCB9IGZyb20gJy4uLy4uL2ljb25zL2ljb25zJzsgLy8gLS0tIENvbnN0YW50cyAtLS0KCnZhciBfbWFrZU1vZGVsTWl4aW4gPSBtYWtlTW9kZWxNaXhpbigndmFsdWUnLCB7CiAgdHlwZTogUFJPUF9UWVBFX0RBVEVfU1RSSU5HCn0pLAogICAgbW9kZWxNaXhpbiA9IF9tYWtlTW9kZWxNaXhpbi5taXhpbiwKICAgIG1vZGVsUHJvcHMgPSBfbWFrZU1vZGVsTWl4aW4ucHJvcHMsCiAgICBNT0RFTF9QUk9QX05BTUUgPSBfbWFrZU1vZGVsTWl4aW4ucHJvcCwKICAgIE1PREVMX0VWRU5UX05BTUUgPSBfbWFrZU1vZGVsTWl4aW4uZXZlbnQ7IC8vIC0tLSBQcm9wcyAtLS0KCgpleHBvcnQgdmFyIHByb3BzID0gbWFrZVByb3BzQ29uZmlndXJhYmxlKHNvcnRLZXlzKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBpZFByb3BzKSwgbW9kZWxQcm9wcyksIHt9LCB7CiAgYXJpYUNvbnRyb2xzOiBtYWtlUHJvcChQUk9QX1RZUEVfU1RSSU5HKSwKICAvLyBNYWtlcyBjYWxlbmRhciB0aGUgZnVsbCB3aWR0aCBvZiBpdHMgcGFyZW50IGNvbnRhaW5lcgogIGJsb2NrOiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpLAogIGRhdGVEaXNhYmxlZEZuOiBtYWtlUHJvcChQUk9QX1RZUEVfRlVOQ1RJT04pLAogIC8vIGBJbnRsLkRhdGVUaW1lRm9ybWF0YCBvYmplY3QKICBkYXRlRm9ybWF0T3B0aW9uczogbWFrZVByb3AoUFJPUF9UWVBFX09CSkVDVCwgewogICAgeWVhcjogREFURV9GT1JNQVRfTlVNRVJJQywKICAgIG1vbnRoOiBDQUxFTkRBUl9MT05HLAogICAgZGF5OiBEQVRFX0ZPUk1BVF9OVU1FUklDLAogICAgd2Vla2RheTogQ0FMRU5EQVJfTE9ORwogIH0pLAogIC8vIEZ1bmN0aW9uIHRvIHNldCBhIGNsYXNzIG9mIChjbGFzc2VzKSBvbiB0aGUgZGF0ZSBjZWxsCiAgLy8gaWYgcGFzc2VkIGEgc3RyaW5nIG9yIGFuIGFycmF5CiAgLy8gVE9ETzoKICAvLyAgIElmIHRoZSBmdW5jdGlvbiByZXR1cm5zIGFuIG9iamVjdCwgbG9vayBmb3IgY2xhc3MgcHJvcCBmb3IgY2xhc3NlcywKICAvLyAgIGFuZCBvdGhlciBwcm9wcyBmb3IgaGFuZGxpbmcgZXZlbnRzL2RldGFpbHMvZGVzY3JpcHRpb25zCiAgZGF0ZUluZm9GbjogbWFrZVByb3AoUFJPUF9UWVBFX0ZVTkNUSU9OKSwKICAvLyAnbHRyJywgJ3J0bCcsIG9yIGBudWxsYCAoZm9yIGF1dG8gZGV0ZWN0KQogIGRpcmVjdGlvbjogbWFrZVByb3AoUFJPUF9UWVBFX1NUUklORyksCiAgZGlzYWJsZWQ6IG1ha2VQcm9wKFBST1BfVFlQRV9CT09MRUFOLCBmYWxzZSksCiAgLy8gV2hlbiBgdHJ1ZWAsIHJlbmRlcnMgYSBjb21tZW50IG5vZGUsIGJ1dCBrZWVwcyB0aGUgY29tcG9uZW50IGluc3RhbmNlIGFjdGl2ZQogIC8vIE1haW5seSBmb3IgPGItZm9ybS1kYXRlPiwgc28gdGhhdCB3ZSBjYW4gZ2V0IHRoZSBjb21wb25lbnQncyB2YWx1ZSBhbmQgbG9jYWxlCiAgLy8gQnV0IHdlIG1pZ2h0IGp1c3QgdXNlIHNlcGFyYXRlIGRhdGUgZm9ybWF0dGVycywgdXNpbmcgdGhlIHJlc29sdmVkIGxvY2FsZQogIC8vIChhZGp1c3RlZCBmb3IgdGhlIGdyZWdvcmlhbiBjYWxlbmRhcikKICBoaWRkZW46IG1ha2VQcm9wKFBST1BfVFlQRV9CT09MRUFOLCBmYWxzZSksCiAgLy8gV2hlbiBgdHJ1ZWAgbWFrZXMgdGhlIHNlbGVjdGVkIGRhdGUgaGVhZGVyIGBzci1vbmx5YAogIGhpZGVIZWFkZXI6IG1ha2VQcm9wKFBST1BfVFlQRV9CT09MRUFOLCBmYWxzZSksCiAgLy8gVGhpcyBzcGVjaWZpZXMgdGhlIGNhbGVuZGFyIHllYXIvbW9udGgvZGF5IHRoYXQgd2lsbCBiZSBzaG93biB3aGVuCiAgLy8gZmlyc3Qgb3BlbmluZyB0aGUgZGF0ZXBpY2tlciBpZiBubyB2LW1vZGVsIHZhbHVlIGlzIHByb3ZpZGVkCiAgLy8gRGVmYXVsdCBpcyB0aGUgY3VycmVudCBkYXRlIChvciBgbWluYC9gbWF4YCkKICBpbml0aWFsRGF0ZTogbWFrZVByb3AoUFJPUF9UWVBFX0RBVEVfU1RSSU5HKSwKICAvLyBMYWJlbHMgZm9yIGJ1dHRvbnMgYW5kIGtleWJvYXJkIHNob3J0Y3V0cwogIGxhYmVsQ2FsZW5kYXI6IG1ha2VQcm9wKFBST1BfVFlQRV9TVFJJTkcsICdDYWxlbmRhcicpLAogIGxhYmVsQ3VycmVudE1vbnRoOiBtYWtlUHJvcChQUk9QX1RZUEVfU1RSSU5HLCAnQ3VycmVudCBtb250aCcpLAogIGxhYmVsSGVscDogbWFrZVByb3AoUFJPUF9UWVBFX1NUUklORywgJ1VzZSBjdXJzb3Iga2V5cyB0byBuYXZpZ2F0ZSBjYWxlbmRhciBkYXRlcycpLAogIGxhYmVsTmF2OiBtYWtlUHJvcChQUk9QX1RZUEVfU1RSSU5HLCAnQ2FsZW5kYXIgbmF2aWdhdGlvbicpLAogIGxhYmVsTmV4dERlY2FkZTogbWFrZVByb3AoUFJPUF9UWVBFX1NUUklORywgJ05leHQgZGVjYWRlJyksCiAgbGFiZWxOZXh0TW9udGg6IG1ha2VQcm9wKFBST1BfVFlQRV9TVFJJTkcsICdOZXh0IG1vbnRoJyksCiAgbGFiZWxOZXh0WWVhcjogbWFrZVByb3AoUFJPUF9UWVBFX1NUUklORywgJ05leHQgeWVhcicpLAogIGxhYmVsTm9EYXRlU2VsZWN0ZWQ6IG1ha2VQcm9wKFBST1BfVFlQRV9TVFJJTkcsICdObyBkYXRlIHNlbGVjdGVkJyksCiAgbGFiZWxQcmV2RGVjYWRlOiBtYWtlUHJvcChQUk9QX1RZUEVfU1RSSU5HLCAnUHJldmlvdXMgZGVjYWRlJyksCiAgbGFiZWxQcmV2TW9udGg6IG1ha2VQcm9wKFBST1BfVFlQRV9TVFJJTkcsICdQcmV2aW91cyBtb250aCcpLAogIGxhYmVsUHJldlllYXI6IG1ha2VQcm9wKFBST1BfVFlQRV9TVFJJTkcsICdQcmV2aW91cyB5ZWFyJyksCiAgbGFiZWxTZWxlY3RlZDogbWFrZVByb3AoUFJPUF9UWVBFX1NUUklORywgJ1NlbGVjdGVkIGRhdGUnKSwKICBsYWJlbFRvZGF5OiBtYWtlUHJvcChQUk9QX1RZUEVfU1RSSU5HLCAnVG9kYXknKSwKICAvLyBMb2NhbGUocykgdG8gdXNlCiAgLy8gRGVmYXVsdCBpcyB0byB1c2UgcGFnZS9icm93c2VyIGRlZmF1bHQgc2V0dGluZwogIGxvY2FsZTogbWFrZVByb3AoUFJPUF9UWVBFX0FSUkFZX1NUUklORyksCiAgbWF4OiBtYWtlUHJvcChQUk9QX1RZUEVfREFURV9TVFJJTkcpLAogIG1pbjogbWFrZVByb3AoUFJPUF9UWVBFX0RBVEVfU1RSSU5HKSwKICAvLyBWYXJpYW50IGNvbG9yIHRvIHVzZSBmb3IgdGhlIG5hdmlnYXRpb24gYnV0dG9ucwogIG5hdkJ1dHRvblZhcmlhbnQ6IG1ha2VQcm9wKFBST1BfVFlQRV9TVFJJTkcsICdzZWNvbmRhcnknKSwKICAvLyBEaXNhYmxlIGhpZ2hsaWdodGluZyB0b2RheSdzIGRhdGUKICBub0hpZ2hsaWdodFRvZGF5OiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpLAogIG5vS2V5TmF2OiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpLAogIHJlYWRvbmx5OiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpLAogIHJvbGVEZXNjcmlwdGlvbjogbWFrZVByb3AoUFJPUF9UWVBFX1NUUklORyksCiAgLy8gVmFyaWFudCBjb2xvciB0byB1c2UgZm9yIHRoZSBzZWxlY3RlZCBkYXRlCiAgc2VsZWN0ZWRWYXJpYW50OiBtYWtlUHJvcChQUk9QX1RZUEVfU1RSSU5HLCAncHJpbWFyeScpLAogIC8vIFdoZW4gYHRydWVgIGVuYWJsZXMgdGhlIGRlY2FkZSBuYXZpZ2F0aW9uIGJ1dHRvbnMKICBzaG93RGVjYWRlTmF2OiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpLAogIC8vIERheSBvZiB3ZWVrIHRvIHN0YXJ0IGNhbGVuZGFyIG9uCiAgLy8gYDBgIChTdW5kYXkpLCBgMWAgKE1vbmRheSksIC4uLiBgNmAgKFNhdHVyZGF5KQogIHN0YXJ0V2Vla2RheTogbWFrZVByb3AoUFJPUF9UWVBFX05VTUJFUl9TVFJJTkcsIDApLAogIC8vIFZhcmlhbnQgY29sb3IgdG8gdXNlIGZvciB0b2RheSdzIGRhdGUgKGRlZmF1bHRzIHRvIGBzZWxlY3RlZFZhcmlhbnRgKQogIHRvZGF5VmFyaWFudDogbWFrZVByb3AoUFJPUF9UWVBFX1NUUklORyksCiAgLy8gQWx3YXlzIHJldHVybiB0aGUgYHYtbW9kZWxgIHZhbHVlIGFzIGEgZGF0ZSBvYmplY3QKICB2YWx1ZUFzRGF0ZTogbWFrZVByb3AoUFJPUF9UWVBFX0JPT0xFQU4sIGZhbHNlKSwKICAvLyBGb3JtYXQgb2YgdGhlIHdlZWtkYXkgbmFtZXMgYXQgdGhlIHRvcCBvZiB0aGUgY2FsZW5kYXIKICAvLyBgc2hvcnRgIGlzIHR5cGljYWxseSBhIDMgbGV0dGVyIGFiYnJldmlhdGlvbiwKICAvLyBgbmFycm93YCBpcyB0eXBpY2FsbHkgYSBzaW5nbGUgbGV0dGVyCiAgLy8gYGxvbmdgIGlzIHRoZSBmdWxsIHdlZWsgZGF5IG5hbWUKICAvLyBBbHRob3VnaCBzb21lIGxvY2FsZXMgbWF5IG92ZXJyaWRlIHRoaXMgKGkuZSBgYXJgLCBldGMuKQogIHdlZWtkYXlIZWFkZXJGb3JtYXQ6IG1ha2VQcm9wKFBST1BfVFlQRV9TVFJJTkcsIENBTEVOREFSX1NIT1JULCBmdW5jdGlvbiAodmFsdWUpIHsKICAgIHJldHVybiBhcnJheUluY2x1ZGVzKFtDQUxFTkRBUl9MT05HLCBDQUxFTkRBUl9TSE9SVCwgQ0FMRU5EQVJfTkFSUk9XXSwgdmFsdWUpOwogIH0pLAogIC8vIEhhcyBubyBlZmZlY3QgaWYgcHJvcCBgYmxvY2tgIGlzIHNldAogIHdpZHRoOiBtYWtlUHJvcChQUk9QX1RZUEVfU1RSSU5HLCAnMjcwcHgnKQp9KSksIE5BTUVfQ0FMRU5EQVIpOyAvLyAtLS0gTWFpbiBjb21wb25lbnQgLS0tCi8vIEB2dWUvY29tcG9uZW50CgpleHBvcnQgdmFyIEJDYWxlbmRhciA9IFZ1ZS5leHRlbmQoewogIG5hbWU6IE5BTUVfQ0FMRU5EQVIsCiAgLy8gTWl4aW4gb3JkZXIgaXMgaW1wb3J0YW50IQogIG1peGluczogW2F0dHJzTWl4aW4sIGlkTWl4aW4sIG1vZGVsTWl4aW4sIG5vcm1hbGl6ZVNsb3RNaXhpbl0sCiAgcHJvcHM6IHByb3BzLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICB2YXIgc2VsZWN0ZWQgPSBmb3JtYXRZTUQodGhpc1tNT0RFTF9QUk9QX05BTUVdKSB8fCAnJzsKICAgIHJldHVybiB7CiAgICAgIC8vIFNlbGVjdGVkIGRhdGUKICAgICAgc2VsZWN0ZWRZTUQ6IHNlbGVjdGVkLAogICAgICAvLyBEYXRlIGluIGNhbGVuZGFyIGdyaWQgdGhhdCBoYXMgYHRhYmluZGV4YCBvZiBgMGAKICAgICAgYWN0aXZlWU1EOiBzZWxlY3RlZCB8fCBmb3JtYXRZTUQoX2NvbnN0cmFpbkRhdGUodGhpcy5pbml0aWFsRGF0ZSB8fCB0aGlzLmdldFRvZGF5KCkpLCB0aGlzLm1pbiwgdGhpcy5tYXgpLAogICAgICAvLyBXaWxsIGJlIHRydWUgaWYgdGhlIGNhbGVuZGFyIGdyaWQgaGFzL2NvbnRhaW5zIGZvY3VzCiAgICAgIGdyaWRIYXNGb2N1czogZmFsc2UsCiAgICAgIC8vIEZsYWcgdG8gZW5hYmxlIHRoZSBgYXJpYS1saXZlYCByZWdpb24ocykgYWZ0ZXIgbW91bnQKICAgICAgLy8gdG8gcHJldmVudCBzY3JlZW4gcmVhZGVyICJvdXRidXJzdHMiIHdoZW4gbW91bnRpbmcKICAgICAgaXNMaXZlOiBmYWxzZQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICB2YWx1ZUlkOiBmdW5jdGlvbiB2YWx1ZUlkKCkgewogICAgICByZXR1cm4gdGhpcy5zYWZlSWQoKTsKICAgIH0sCiAgICB3aWRnZXRJZDogZnVuY3Rpb24gd2lkZ2V0SWQoKSB7CiAgICAgIHJldHVybiB0aGlzLnNhZmVJZCgnX2NhbGVuZGFyLXdyYXBwZXJfJyk7CiAgICB9LAogICAgbmF2SWQ6IGZ1bmN0aW9uIG5hdklkKCkgewogICAgICByZXR1cm4gdGhpcy5zYWZlSWQoJ19jYWxlbmRhci1uYXZfJyk7CiAgICB9LAogICAgZ3JpZElkOiBmdW5jdGlvbiBncmlkSWQoKSB7CiAgICAgIHJldHVybiB0aGlzLnNhZmVJZCgnX2NhbGVuZGFyLWdyaWRfJyk7CiAgICB9LAogICAgZ3JpZENhcHRpb25JZDogZnVuY3Rpb24gZ3JpZENhcHRpb25JZCgpIHsKICAgICAgcmV0dXJuIHRoaXMuc2FmZUlkKCdfY2FsZW5kYXItZ3JpZC1jYXB0aW9uXycpOwogICAgfSwKICAgIGdyaWRIZWxwSWQ6IGZ1bmN0aW9uIGdyaWRIZWxwSWQoKSB7CiAgICAgIHJldHVybiB0aGlzLnNhZmVJZCgnX2NhbGVuZGFyLWdyaWQtaGVscF8nKTsKICAgIH0sCiAgICBhY3RpdmVJZDogZnVuY3Rpb24gYWN0aXZlSWQoKSB7CiAgICAgIHJldHVybiB0aGlzLmFjdGl2ZVlNRCA/IHRoaXMuc2FmZUlkKCJfY2VsbC0iLmNvbmNhdCh0aGlzLmFjdGl2ZVlNRCwgIl8iKSkgOiBudWxsOwogICAgfSwKICAgIC8vIFRPRE86IFVzZSBjb21wdXRlZCBwcm9wcyB0byBjb252ZXJ0IGBZWVlZLU1NLUREYCB0byBgRGF0ZWAgb2JqZWN0CiAgICBzZWxlY3RlZERhdGU6IGZ1bmN0aW9uIHNlbGVjdGVkRGF0ZSgpIHsKICAgICAgLy8gU2VsZWN0ZWQgYXMgYSBgRGF0ZWAgb2JqZWN0CiAgICAgIHJldHVybiBwYXJzZVlNRCh0aGlzLnNlbGVjdGVkWU1EKTsKICAgIH0sCiAgICBhY3RpdmVEYXRlOiBmdW5jdGlvbiBhY3RpdmVEYXRlKCkgewogICAgICAvLyBBY3RpdmUgYXMgYSBgRGF0ZWAgb2JqZWN0CiAgICAgIHJldHVybiBwYXJzZVlNRCh0aGlzLmFjdGl2ZVlNRCk7CiAgICB9LAogICAgY29tcHV0ZWRNaW46IGZ1bmN0aW9uIGNvbXB1dGVkTWluKCkgewogICAgICByZXR1cm4gcGFyc2VZTUQodGhpcy5taW4pOwogICAgfSwKICAgIGNvbXB1dGVkTWF4OiBmdW5jdGlvbiBjb21wdXRlZE1heCgpIHsKICAgICAgcmV0dXJuIHBhcnNlWU1EKHRoaXMubWF4KTsKICAgIH0sCiAgICBjb21wdXRlZFdlZWtTdGFydHM6IGZ1bmN0aW9uIGNvbXB1dGVkV2Vla1N0YXJ0cygpIHsKICAgICAgLy8gYHN0YXJ0V2Vla2RheWAgaXMgYSBwcm9wIChjb25zdHJhaW5lZCB0byBgMGAgdGhyb3VnaCBgNmApCiAgICAgIHJldHVybiBtYXRoTWF4KHRvSW50ZWdlcih0aGlzLnN0YXJ0V2Vla2RheSwgMCksIDApICUgNzsKICAgIH0sCiAgICBjb21wdXRlZExvY2FsZTogZnVuY3Rpb24gY29tcHV0ZWRMb2NhbGUoKSB7CiAgICAgIC8vIFJldHVybnMgdGhlIHJlc29sdmVkIGxvY2FsZSB1c2VkIGJ5IHRoZSBjYWxlbmRhcgogICAgICByZXR1cm4gcmVzb2x2ZUxvY2FsZShjb25jYXQodGhpcy5sb2NhbGUpLmZpbHRlcihpZGVudGl0eSksIENBTEVOREFSX0dSRUdPUlkpOwogICAgfSwKICAgIGNvbXB1dGVkRGF0ZURpc2FibGVkRm46IGZ1bmN0aW9uIGNvbXB1dGVkRGF0ZURpc2FibGVkRm4oKSB7CiAgICAgIHZhciBkYXRlRGlzYWJsZWRGbiA9IHRoaXMuZGF0ZURpc2FibGVkRm47CiAgICAgIHJldHVybiBoYXNQcm9wRnVuY3Rpb24oZGF0ZURpc2FibGVkRm4pID8gZGF0ZURpc2FibGVkRm4gOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9OwogICAgfSwKICAgIC8vIFRPRE86IENoYW5nZSBgZGF0ZUluZm9GbmAgdG8gaGFuZGxlIGV2ZW50cyBhbmQgbm90ZXMgYXMgd2VsbCBhcyBjbGFzc2VzCiAgICBjb21wdXRlZERhdGVJbmZvRm46IGZ1bmN0aW9uIGNvbXB1dGVkRGF0ZUluZm9GbigpIHsKICAgICAgdmFyIGRhdGVJbmZvRm4gPSB0aGlzLmRhdGVJbmZvRm47CiAgICAgIHJldHVybiBoYXNQcm9wRnVuY3Rpb24oZGF0ZUluZm9GbikgPyBkYXRlSW5mb0ZuIDogZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiB7fTsKICAgICAgfTsKICAgIH0sCiAgICBjYWxlbmRhckxvY2FsZTogZnVuY3Rpb24gY2FsZW5kYXJMb2NhbGUoKSB7CiAgICAgIC8vIFRoaXMgbG9jYWxlIGVuZm9yY2VzIHRoZSBncmVnb3JpYW4gY2FsZW5kYXIgKGZvciB1c2UgaW4gZm9ybWF0dGVyIGZ1bmN0aW9ucykKICAgICAgLy8gTmVlZGVkIGJlY2F1c2UgSUUgMTEgcmVzb2x2ZXMgYGFyLUlSYCBhcyBpc2xhbWljLWNpdmlsIGNhbGVuZGFyCiAgICAgIC8vIGFuZCBJRSAxMSAoYW5kIHNvbWUgb3RoZXIgYnJvd3NlcnMpIGRvIG5vdCBzdXBwb3J0IHRoZSBgY2FsZW5kYXJgIG9wdGlvbgogICAgICAvLyBBbmQgd2UgY3VycmVudGx5IG9ubHkgc3VwcG9ydCB0aGUgZ3JlZ29yaWFuIGNhbGVuZGFyCiAgICAgIHZhciBmbXQgPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdCh0aGlzLmNvbXB1dGVkTG9jYWxlLCB7CiAgICAgICAgY2FsZW5kYXI6IENBTEVOREFSX0dSRUdPUlkKICAgICAgfSk7CiAgICAgIHZhciBjYWxlbmRhciA9IGZtdC5yZXNvbHZlZE9wdGlvbnMoKS5jYWxlbmRhcjsKICAgICAgdmFyIGxvY2FsZSA9IGZtdC5yZXNvbHZlZE9wdGlvbnMoKS5sb2NhbGU7CiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZjogbWFpbmx5IGZvciBJRSAxMSBhbmQgYSBmZXcgb3RoZXIgYnJvd3NlcnMsIGhhcmQgdG8gdGVzdCBpbiBKU0RPTSAqLwoKICAgICAgaWYgKGNhbGVuZGFyICE9PSBDQUxFTkRBUl9HUkVHT1JZKSB7CiAgICAgICAgLy8gRW5zdXJlIHRoZSBsb2NhbGUgcmVxdWVzdHMgdGhlIGdyZWdvcmlhbiBjYWxlbmRhcgogICAgICAgIC8vIE1haW5seSBmb3IgSUUgMTEsIGFuZCBjdXJyZW50bHkgd2UgY2FuJ3QgaGFuZGxlIG5vbi1ncmVnb3JpYW4gY2FsZW5kYXJzCiAgICAgICAgLy8gVE9ETzogU2hvdWxkIHdlIGFsd2F5cyByZXR1cm4gdGhpcyB2YWx1ZT8KICAgICAgICBsb2NhbGUgPSBsb2NhbGUucmVwbGFjZSgvLXUtLiskL2ksICcnKS5jb25jYXQoJy11LWNhLWdyZWdvcnknKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGxvY2FsZTsKICAgIH0sCiAgICBjYWxlbmRhclllYXI6IGZ1bmN0aW9uIGNhbGVuZGFyWWVhcigpIHsKICAgICAgcmV0dXJuIHRoaXMuYWN0aXZlRGF0ZS5nZXRGdWxsWWVhcigpOwogICAgfSwKICAgIGNhbGVuZGFyTW9udGg6IGZ1bmN0aW9uIGNhbGVuZGFyTW9udGgoKSB7CiAgICAgIHJldHVybiB0aGlzLmFjdGl2ZURhdGUuZ2V0TW9udGgoKTsKICAgIH0sCiAgICBjYWxlbmRhckZpcnN0RGF5OiBmdW5jdGlvbiBjYWxlbmRhckZpcnN0RGF5KCkgewogICAgICAvLyBXZSBzZXQgdGhlIHRpbWUgZm9yIHRoaXMgZGF0ZSB0byAxMnBtIHRvIHdvcmsgYXJvdW5kCiAgICAgIC8vIGRhdGUgZm9ybWF0dGluZyBpc3N1ZXMgaW4gRmlyZWZveCBhbmQgU2FmYXJpCiAgICAgIC8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2Jvb3RzdHJhcC12dWUvYm9vdHN0cmFwLXZ1ZS9pc3N1ZXMvNTgxOAogICAgICByZXR1cm4gY3JlYXRlRGF0ZSh0aGlzLmNhbGVuZGFyWWVhciwgdGhpcy5jYWxlbmRhck1vbnRoLCAxLCAxMik7CiAgICB9LAogICAgY2FsZW5kYXJEYXlzSW5Nb250aDogZnVuY3Rpb24gY2FsZW5kYXJEYXlzSW5Nb250aCgpIHsKICAgICAgLy8gV2UgY3JlYXRlIGEgbmV3IGRhdGUgYXMgdG8gbm90IG11dGF0ZSB0aGUgb3JpZ2luYWwKICAgICAgdmFyIGRhdGUgPSBjcmVhdGVEYXRlKHRoaXMuY2FsZW5kYXJGaXJzdERheSk7CiAgICAgIGRhdGUuc2V0TW9udGgoZGF0ZS5nZXRNb250aCgpICsgMSwgMCk7CiAgICAgIHJldHVybiBkYXRlLmdldERhdGUoKTsKICAgIH0sCiAgICBjb21wdXRlZFZhcmlhbnQ6IGZ1bmN0aW9uIGNvbXB1dGVkVmFyaWFudCgpIHsKICAgICAgcmV0dXJuICJidG4tIi5jb25jYXQodGhpcy5zZWxlY3RlZFZhcmlhbnQgfHwgJ3ByaW1hcnknKTsKICAgIH0sCiAgICBjb21wdXRlZFRvZGF5VmFyaWFudDogZnVuY3Rpb24gY29tcHV0ZWRUb2RheVZhcmlhbnQoKSB7CiAgICAgIHJldHVybiAiYnRuLW91dGxpbmUtIi5jb25jYXQodGhpcy50b2RheVZhcmlhbnQgfHwgdGhpcy5zZWxlY3RlZFZhcmlhbnQgfHwgJ3ByaW1hcnknKTsKICAgIH0sCiAgICBjb21wdXRlZE5hdkJ1dHRvblZhcmlhbnQ6IGZ1bmN0aW9uIGNvbXB1dGVkTmF2QnV0dG9uVmFyaWFudCgpIHsKICAgICAgcmV0dXJuICJidG4tb3V0bGluZS0iLmNvbmNhdCh0aGlzLm5hdkJ1dHRvblZhcmlhbnQgfHwgJ3ByaW1hcnknKTsKICAgIH0sCiAgICBpc1JUTDogZnVuY3Rpb24gaXNSVEwoKSB7CiAgICAgIC8vIGB0cnVlYCBpZiB0aGUgbGFuZ3VhZ2UgcmVxdWVzdGVkIGlzIFJUTAogICAgICB2YXIgZGlyID0gdG9TdHJpbmcodGhpcy5kaXJlY3Rpb24pLnRvTG93ZXJDYXNlKCk7CgogICAgICBpZiAoZGlyID09PSAncnRsJykgewogICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0gZWxzZSBpZiAoZGlyID09PSAnbHRyJykgewogICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByZXR1cm4gaXNMb2NhbGVSVEwodGhpcy5jb21wdXRlZExvY2FsZSk7CiAgICB9LAogICAgY29udGV4dDogZnVuY3Rpb24gY29udGV4dCgpIHsKICAgICAgdmFyIHNlbGVjdGVkWU1EID0gdGhpcy5zZWxlY3RlZFlNRCwKICAgICAgICAgIGFjdGl2ZVlNRCA9IHRoaXMuYWN0aXZlWU1EOwogICAgICB2YXIgc2VsZWN0ZWREYXRlID0gcGFyc2VZTUQoc2VsZWN0ZWRZTUQpOwogICAgICB2YXIgYWN0aXZlRGF0ZSA9IHBhcnNlWU1EKGFjdGl2ZVlNRCk7CiAgICAgIHJldHVybiB7CiAgICAgICAgLy8gVGhlIGN1cnJlbnQgdmFsdWUgb2YgdGhlIGB2LW1vZGVsYAogICAgICAgIHNlbGVjdGVkWU1EOiBzZWxlY3RlZFlNRCwKICAgICAgICBzZWxlY3RlZERhdGU6IHNlbGVjdGVkRGF0ZSwKICAgICAgICBzZWxlY3RlZEZvcm1hdHRlZDogc2VsZWN0ZWREYXRlID8gdGhpcy5mb3JtYXREYXRlU3RyaW5nKHNlbGVjdGVkRGF0ZSkgOiB0aGlzLmxhYmVsTm9EYXRlU2VsZWN0ZWQsCiAgICAgICAgLy8gV2hpY2ggZGF0ZSBjZWxsIGlzIGNvbnNpZGVyZWQgYWN0aXZlIGR1ZSB0byBuYXZpZ2F0aW9uCiAgICAgICAgYWN0aXZlWU1EOiBhY3RpdmVZTUQsCiAgICAgICAgYWN0aXZlRGF0ZTogYWN0aXZlRGF0ZSwKICAgICAgICBhY3RpdmVGb3JtYXR0ZWQ6IGFjdGl2ZURhdGUgPyB0aGlzLmZvcm1hdERhdGVTdHJpbmcoYWN0aXZlRGF0ZSkgOiAnJywKICAgICAgICAvLyBgdHJ1ZWAgaWYgdGhlIGRhdGUgaXMgZGlzYWJsZWQgKHdoZW4gdXNpbmcga2V5Ym9hcmQgbmF2aWdhdGlvbikKICAgICAgICBkaXNhYmxlZDogdGhpcy5kYXRlRGlzYWJsZWQoYWN0aXZlRGF0ZSksCiAgICAgICAgLy8gTG9jYWxlcyB1c2VkIGluIGZvcm1hdHRpbmcgZGF0ZXMKICAgICAgICBsb2NhbGU6IHRoaXMuY29tcHV0ZWRMb2NhbGUsCiAgICAgICAgY2FsZW5kYXJMb2NhbGU6IHRoaXMuY2FsZW5kYXJMb2NhbGUsCiAgICAgICAgcnRsOiB0aGlzLmlzUlRMCiAgICAgIH07CiAgICB9LAogICAgLy8gQ29tcHV0ZWQgcHJvcHMgdGhhdCByZXR1cm4gYSBmdW5jdGlvbiByZWZlcmVuY2UKICAgIGRhdGVPdXRPZlJhbmdlOiBmdW5jdGlvbiBkYXRlT3V0T2ZSYW5nZSgpIHsKICAgICAgLy8gQ2hlY2sgd2hldGhlciBhIGRhdGUgaXMgd2l0aGluIHRoZSBtaW4vbWF4IHJhbmdlCiAgICAgIC8vIFJldHVybnMgYSBuZXcgZnVuY3Rpb24gcmVmIGlmIHRoZSBwb3BzIGNoYW5nZQogICAgICAvLyBXZSBkbyB0aGlzIGFzIHdlIG5lZWQgdG8gdHJpZ2dlciB0aGUgY2FsZW5kYXIgY29tcHV0ZWQgcHJvcAogICAgICAvLyB0byB1cGRhdGUgd2hlbiB0aGVzZSBwcm9wcyB1cGRhdGUKICAgICAgdmFyIG1pbiA9IHRoaXMuY29tcHV0ZWRNaW4sCiAgICAgICAgICBtYXggPSB0aGlzLmNvbXB1dGVkTWF4OwogICAgICByZXR1cm4gZnVuY3Rpb24gKGRhdGUpIHsKICAgICAgICAvLyBIYW5kbGUgYm90aCBgWVlZWS1NTS1ERGAgYW5kIGBEYXRlYCBvYmplY3RzCiAgICAgICAgZGF0ZSA9IHBhcnNlWU1EKGRhdGUpOwogICAgICAgIHJldHVybiBtaW4gJiYgZGF0ZSA8IG1pbiB8fCBtYXggJiYgZGF0ZSA+IG1heDsKICAgICAgfTsKICAgIH0sCiAgICBkYXRlRGlzYWJsZWQ6IGZ1bmN0aW9uIGRhdGVEaXNhYmxlZCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsgLy8gUmV0dXJucyBhIGZ1bmN0aW9uIGZvciB2YWxpZGF0aW5nIGlmIGEgZGF0ZSBpcyB3aXRoaW4gcmFuZ2UKICAgICAgLy8gV2UgZ3JhYiB0aGlzIHZhcmlhYmxlcyBmaXJzdCB0byBlbnN1cmUgYSBuZXcgZnVuY3Rpb24gcmVmCiAgICAgIC8vIGlzIGdlbmVyYXRlZCB3aGVuIHRoZSBwcm9wcyB2YWx1ZSBjaGFuZ2VzCiAgICAgIC8vIFdlIGRvIHRoaXMgYXMgd2UgbmVlZCB0byB0cmlnZ2VyIHRoZSBjYWxlbmRhciBjb21wdXRlZCBwcm9wCiAgICAgIC8vIHRvIHVwZGF0ZSB3aGVuIHRoZXNlIHByb3BzIHVwZGF0ZQoKCiAgICAgIHZhciByYW5nZUZuID0gdGhpcy5kYXRlT3V0T2ZSYW5nZTsgLy8gUmV0dXJuIHRoZSBmdW5jdGlvbiByZWYKCiAgICAgIHJldHVybiBmdW5jdGlvbiAoZGF0ZSkgewogICAgICAgIC8vIEhhbmRsZSBib3RoIGBZWVlZLU1NLUREYCBhbmQgYERhdGVgIG9iamVjdHMKICAgICAgICBkYXRlID0gcGFyc2VZTUQoZGF0ZSk7CiAgICAgICAgdmFyIHltZCA9IGZvcm1hdFlNRChkYXRlKTsKICAgICAgICByZXR1cm4gISEocmFuZ2VGbihkYXRlKSB8fCBfdGhpcy5jb21wdXRlZERhdGVEaXNhYmxlZEZuKHltZCwgZGF0ZSkpOwogICAgICB9OwogICAgfSwKICAgIC8vIENvbXB1dGVkIHByb3BzIHRoYXQgcmV0dXJuIGRhdGUgZm9ybWF0dGVyIGZ1bmN0aW9ucwogICAgZm9ybWF0RGF0ZVN0cmluZzogZnVuY3Rpb24gZm9ybWF0RGF0ZVN0cmluZygpIHsKICAgICAgLy8gUmV0dXJucyBhIGRhdGUgZm9ybWF0dGVyIGZ1bmN0aW9uCiAgICAgIHJldHVybiBjcmVhdGVEYXRlRm9ybWF0dGVyKHRoaXMuY2FsZW5kYXJMb2NhbGUsIF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7CiAgICAgICAgLy8gRW5zdXJlIHdlIGhhdmUgeWVhciwgbW9udGgsIGRheSBzaG93biBmb3Igc2NyZWVuIHJlYWRlcnMvQVJJQQogICAgICAgIC8vIElmIHVzZXJzIHJlYWxseSB3YW50IHRvIGxlYXZlIG9uZSBvZiB0aGVzZSBvdXQsIHRoZXkgY2FuCiAgICAgICAgLy8gcGFzcyBgdW5kZWZpbmVkYCBmb3IgdGhlIHByb3BlcnR5IHZhbHVlCiAgICAgICAgeWVhcjogREFURV9GT1JNQVRfTlVNRVJJQywKICAgICAgICBtb250aDogREFURV9GT1JNQVRfMl9ESUdJVCwKICAgICAgICBkYXk6IERBVEVfRk9STUFUXzJfRElHSVQKICAgICAgfSwgdGhpcy5kYXRlRm9ybWF0T3B0aW9ucyksIHt9LCB7CiAgICAgICAgLy8gRW5zdXJlIGhvdXJzL21pbnV0ZXMvc2Vjb25kcyBhcmUgbm90IHNob3duCiAgICAgICAgLy8gQXMgd2UgZG8gbm90IHN1cHBvcnQgdGhlIHRpbWUgcG9ydGlvbiAoeWV0KQogICAgICAgIGhvdXI6IHVuZGVmaW5lZCwKICAgICAgICBtaW51dGU6IHVuZGVmaW5lZCwKICAgICAgICBzZWNvbmQ6IHVuZGVmaW5lZCwKICAgICAgICAvLyBFbnN1cmUgY2FsZW5kYXIgaXMgZ3JlZ29yaWFuCiAgICAgICAgY2FsZW5kYXI6IENBTEVOREFSX0dSRUdPUlkKICAgICAgfSkpOwogICAgfSwKICAgIGZvcm1hdFllYXJNb250aDogZnVuY3Rpb24gZm9ybWF0WWVhck1vbnRoKCkgewogICAgICAvLyBSZXR1cm5zIGEgZGF0ZSBmb3JtYXR0ZXIgZnVuY3Rpb24KICAgICAgcmV0dXJuIGNyZWF0ZURhdGVGb3JtYXR0ZXIodGhpcy5jYWxlbmRhckxvY2FsZSwgewogICAgICAgIHllYXI6IERBVEVfRk9STUFUX05VTUVSSUMsCiAgICAgICAgbW9udGg6IENBTEVOREFSX0xPTkcsCiAgICAgICAgY2FsZW5kYXI6IENBTEVOREFSX0dSRUdPUlkKICAgICAgfSk7CiAgICB9LAogICAgZm9ybWF0V2Vla2RheU5hbWU6IGZ1bmN0aW9uIGZvcm1hdFdlZWtkYXlOYW1lKCkgewogICAgICAvLyBMb25nIHdlZWtkYXkgbmFtZSBmb3Igd2Vla2RheSBoZWFkZXIgYXJpYS1sYWJlbAogICAgICByZXR1cm4gY3JlYXRlRGF0ZUZvcm1hdHRlcih0aGlzLmNhbGVuZGFyTG9jYWxlLCB7CiAgICAgICAgd2Vla2RheTogQ0FMRU5EQVJfTE9ORywKICAgICAgICBjYWxlbmRhcjogQ0FMRU5EQVJfR1JFR09SWQogICAgICB9KTsKICAgIH0sCiAgICBmb3JtYXRXZWVrZGF5TmFtZVNob3J0OiBmdW5jdGlvbiBmb3JtYXRXZWVrZGF5TmFtZVNob3J0KCkgewogICAgICAvLyBXZWVrZGF5IGhlYWRlciBjZWxsIGZvcm1hdAogICAgICAvLyBkZWZhdWx0cyB0byAnc2hvcnQnIDMgbGV0dGVyIGRheXMsIHdoZXJlIHBvc3NpYmxlCiAgICAgIHJldHVybiBjcmVhdGVEYXRlRm9ybWF0dGVyKHRoaXMuY2FsZW5kYXJMb2NhbGUsIHsKICAgICAgICB3ZWVrZGF5OiB0aGlzLndlZWtkYXlIZWFkZXJGb3JtYXQgfHwgQ0FMRU5EQVJfU0hPUlQsCiAgICAgICAgY2FsZW5kYXI6IENBTEVOREFSX0dSRUdPUlkKICAgICAgfSk7CiAgICB9LAogICAgZm9ybWF0RGF5OiBmdW5jdGlvbiBmb3JtYXREYXkoKSB7CiAgICAgIC8vIENhbGVuZGFyIGdyaWQgZGF5IG51bWJlciBmb3JtYXR0ZXIKICAgICAgLy8gV2UgZG9uJ3QgdXNlIERhdGVUaW1lRm9ybWF0dGVyIGhlcmUgYXMgaXQgY2FuIHBsYWNlIGV4dHJhCiAgICAgIC8vIGNoYXJhY3RlcihzKSBhZnRlciB0aGUgbnVtYmVyIChpLmUgdGhlIGB6aGAgbG9jYWxlKQogICAgICB2YXIgbmYgPSBuZXcgSW50bC5OdW1iZXJGb3JtYXQoW3RoaXMuY29tcHV0ZWRMb2NhbGVdLCB7CiAgICAgICAgc3R5bGU6ICdkZWNpbWFsJywKICAgICAgICBtaW5pbXVtSW50ZWdlckRpZ2l0czogMSwKICAgICAgICBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IDAsCiAgICAgICAgbWF4aW11bUZyYWN0aW9uRGlnaXRzOiAwLAogICAgICAgIG5vdGF0aW9uOiAnc3RhbmRhcmQnCiAgICAgIH0pOyAvLyBSZXR1cm4gYSBmb3JtYXR0ZXIgZnVuY3Rpb24gaW5zdGFuY2UKCiAgICAgIHJldHVybiBmdW5jdGlvbiAoZGF0ZSkgewogICAgICAgIHJldHVybiBuZi5mb3JtYXQoZGF0ZS5nZXREYXRlKCkpOwogICAgICB9OwogICAgfSwKICAgIC8vIERpc2FibGVkIHN0YXRlcyBmb3IgdGhlIG5hdiBidXR0b25zCiAgICBwcmV2RGVjYWRlRGlzYWJsZWQ6IGZ1bmN0aW9uIHByZXZEZWNhZGVEaXNhYmxlZCgpIHsKICAgICAgdmFyIG1pbiA9IHRoaXMuY29tcHV0ZWRNaW47CiAgICAgIHJldHVybiB0aGlzLmRpc2FibGVkIHx8IG1pbiAmJiBsYXN0RGF0ZU9mTW9udGgob25lRGVjYWRlQWdvKHRoaXMuYWN0aXZlRGF0ZSkpIDwgbWluOwogICAgfSwKICAgIHByZXZZZWFyRGlzYWJsZWQ6IGZ1bmN0aW9uIHByZXZZZWFyRGlzYWJsZWQoKSB7CiAgICAgIHZhciBtaW4gPSB0aGlzLmNvbXB1dGVkTWluOwogICAgICByZXR1cm4gdGhpcy5kaXNhYmxlZCB8fCBtaW4gJiYgbGFzdERhdGVPZk1vbnRoKG9uZVllYXJBZ28odGhpcy5hY3RpdmVEYXRlKSkgPCBtaW47CiAgICB9LAogICAgcHJldk1vbnRoRGlzYWJsZWQ6IGZ1bmN0aW9uIHByZXZNb250aERpc2FibGVkKCkgewogICAgICB2YXIgbWluID0gdGhpcy5jb21wdXRlZE1pbjsKICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQgfHwgbWluICYmIGxhc3REYXRlT2ZNb250aChvbmVNb250aEFnbyh0aGlzLmFjdGl2ZURhdGUpKSA8IG1pbjsKICAgIH0sCiAgICB0aGlzTW9udGhEaXNhYmxlZDogZnVuY3Rpb24gdGhpc01vbnRoRGlzYWJsZWQoKSB7CiAgICAgIC8vIFRPRE86IFdlIGNvdWxkL3Nob3VsZCBjaGVjayBpZiB0b2RheSBpcyBvdXQgb2YgcmFuZ2UKICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQ7CiAgICB9LAogICAgbmV4dE1vbnRoRGlzYWJsZWQ6IGZ1bmN0aW9uIG5leHRNb250aERpc2FibGVkKCkgewogICAgICB2YXIgbWF4ID0gdGhpcy5jb21wdXRlZE1heDsKICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQgfHwgbWF4ICYmIGZpcnN0RGF0ZU9mTW9udGgob25lTW9udGhBaGVhZCh0aGlzLmFjdGl2ZURhdGUpKSA+IG1heDsKICAgIH0sCiAgICBuZXh0WWVhckRpc2FibGVkOiBmdW5jdGlvbiBuZXh0WWVhckRpc2FibGVkKCkgewogICAgICB2YXIgbWF4ID0gdGhpcy5jb21wdXRlZE1heDsKICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQgfHwgbWF4ICYmIGZpcnN0RGF0ZU9mTW9udGgob25lWWVhckFoZWFkKHRoaXMuYWN0aXZlRGF0ZSkpID4gbWF4OwogICAgfSwKICAgIG5leHREZWNhZGVEaXNhYmxlZDogZnVuY3Rpb24gbmV4dERlY2FkZURpc2FibGVkKCkgewogICAgICB2YXIgbWF4ID0gdGhpcy5jb21wdXRlZE1heDsKICAgICAgcmV0dXJuIHRoaXMuZGlzYWJsZWQgfHwgbWF4ICYmIGZpcnN0RGF0ZU9mTW9udGgob25lRGVjYWRlQWhlYWQodGhpcy5hY3RpdmVEYXRlKSkgPiBtYXg7CiAgICB9LAogICAgLy8gQ2FsZW5kYXIgZGF0ZXMgZ2VuZXJhdGlvbgogICAgY2FsZW5kYXI6IGZ1bmN0aW9uIGNhbGVuZGFyKCkgewogICAgICB2YXIgbWF0cml4ID0gW107CiAgICAgIHZhciBmaXJzdERheSA9IHRoaXMuY2FsZW5kYXJGaXJzdERheTsKICAgICAgdmFyIGNhbGVuZGFyWWVhciA9IGZpcnN0RGF5LmdldEZ1bGxZZWFyKCk7CiAgICAgIHZhciBjYWxlbmRhck1vbnRoID0gZmlyc3REYXkuZ2V0TW9udGgoKTsKICAgICAgdmFyIGRheXNJbk1vbnRoID0gdGhpcy5jYWxlbmRhckRheXNJbk1vbnRoOwogICAgICB2YXIgc3RhcnRJbmRleCA9IGZpcnN0RGF5LmdldERheSgpOyAvLyBgMGAuLmA2YAoKICAgICAgdmFyIHdlZWtPZmZzZXQgPSAodGhpcy5jb21wdXRlZFdlZWtTdGFydHMgPiBzdGFydEluZGV4ID8gNyA6IDApIC0gdGhpcy5jb21wdXRlZFdlZWtTdGFydHM7IC8vIEJ1aWxkIHRoZSBjYWxlbmRhciBtYXRyaXgKCiAgICAgIHZhciBjdXJyZW50RGF5ID0gMCAtIHdlZWtPZmZzZXQgLSBzdGFydEluZGV4OwoKICAgICAgZm9yICh2YXIgd2VlayA9IDA7IHdlZWsgPCA2ICYmIGN1cnJlbnREYXkgPCBkYXlzSW5Nb250aDsgd2VlaysrKSB7CiAgICAgICAgLy8gRm9yIGVhY2ggd2VlawogICAgICAgIG1hdHJpeFt3ZWVrXSA9IFtdOyAvLyBUaGUgZm9sbG93aW5nIGNvdWxkIGJlIGEgbWFwIGZ1bmN0aW9uCgogICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgNzsgaisrKSB7CiAgICAgICAgICAvLyBGb3IgZWFjaCBkYXkgaW4gd2VlawogICAgICAgICAgY3VycmVudERheSsrOwogICAgICAgICAgdmFyIGRhdGUgPSBjcmVhdGVEYXRlKGNhbGVuZGFyWWVhciwgY2FsZW5kYXJNb250aCwgY3VycmVudERheSk7CiAgICAgICAgICB2YXIgbW9udGggPSBkYXRlLmdldE1vbnRoKCk7CiAgICAgICAgICB2YXIgZGF5WU1EID0gZm9ybWF0WU1EKGRhdGUpOwogICAgICAgICAgdmFyIGRheURpc2FibGVkID0gdGhpcy5kYXRlRGlzYWJsZWQoZGF0ZSk7IC8vIFRPRE86IFRoaXMgY291bGQgYmUgYSBub3JtYWxpemVyIG1ldGhvZAoKICAgICAgICAgIHZhciBkYXRlSW5mbyA9IHRoaXMuY29tcHV0ZWREYXRlSW5mb0ZuKGRheVlNRCwgcGFyc2VZTUQoZGF5WU1EKSk7CiAgICAgICAgICBkYXRlSW5mbyA9IGlzU3RyaW5nKGRhdGVJbmZvKSB8fCBpc0FycmF5KGRhdGVJbmZvKSA/CiAgICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwogICAgICAgICAgewogICAgICAgICAgICAiY2xhc3MiOiBkYXRlSW5mbwogICAgICAgICAgfSA6IGlzUGxhaW5PYmplY3QoZGF0ZUluZm8pID8gX29iamVjdFNwcmVhZCh7CiAgICAgICAgICAgICJjbGFzcyI6ICcnCiAgICAgICAgICB9LCBkYXRlSW5mbykgOgogICAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KICAgICAgICAgIHsKICAgICAgICAgICAgImNsYXNzIjogJycKICAgICAgICAgIH07CiAgICAgICAgICBtYXRyaXhbd2Vla10ucHVzaCh7CiAgICAgICAgICAgIHltZDogZGF5WU1ELAogICAgICAgICAgICAvLyBDZWxsIGNvbnRlbnQKICAgICAgICAgICAgZGF5OiB0aGlzLmZvcm1hdERheShkYXRlKSwKICAgICAgICAgICAgbGFiZWw6IHRoaXMuZm9ybWF0RGF0ZVN0cmluZyhkYXRlKSwKICAgICAgICAgICAgLy8gRmxhZ3MgZm9yIHN0eWxpbmcKICAgICAgICAgICAgaXNUaGlzTW9udGg6IG1vbnRoID09PSBjYWxlbmRhck1vbnRoLAogICAgICAgICAgICBpc0Rpc2FibGVkOiBkYXlEaXNhYmxlZCwKICAgICAgICAgICAgLy8gVE9ETzogSGFuZGxlIG90aGVyIGRhdGVJbmZvIHByb3BlcnRpZXMgc3VjaCBhcyBub3Rlcy9ldmVudHMKICAgICAgICAgICAgaW5mbzogZGF0ZUluZm8KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG1hdHJpeDsKICAgIH0sCiAgICBjYWxlbmRhckhlYWRpbmdzOiBmdW5jdGlvbiBjYWxlbmRhckhlYWRpbmdzKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiB0aGlzLmNhbGVuZGFyWzBdLm1hcChmdW5jdGlvbiAoZCkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICB0ZXh0OiBfdGhpczIuZm9ybWF0V2Vla2RheU5hbWVTaG9ydChwYXJzZVlNRChkLnltZCkpLAogICAgICAgICAgbGFiZWw6IF90aGlzMi5mb3JtYXRXZWVrZGF5TmFtZShwYXJzZVlNRChkLnltZCkpCiAgICAgICAgfTsKICAgICAgfSk7CiAgICB9CiAgfSwKICB3YXRjaDogKF93YXRjaCA9IHt9LCBfZGVmaW5lUHJvcGVydHkoX3dhdGNoLCBNT0RFTF9QUk9QX05BTUUsIGZ1bmN0aW9uIChuZXdWYWx1ZSwgb2xkVmFsdWUpIHsKICAgIHZhciBzZWxlY3RlZCA9IGZvcm1hdFlNRChuZXdWYWx1ZSkgfHwgJyc7CiAgICB2YXIgb2xkID0gZm9ybWF0WU1EKG9sZFZhbHVlKSB8fCAnJzsKCiAgICBpZiAoIWRhdGVzRXF1YWwoc2VsZWN0ZWQsIG9sZCkpIHsKICAgICAgdGhpcy5hY3RpdmVZTUQgPSBzZWxlY3RlZCB8fCB0aGlzLmFjdGl2ZVlNRDsKICAgICAgdGhpcy5zZWxlY3RlZFlNRCA9IHNlbGVjdGVkOwogICAgfQogIH0pLCBfZGVmaW5lUHJvcGVydHkoX3dhdGNoLCAic2VsZWN0ZWRZTUQiLCBmdW5jdGlvbiBzZWxlY3RlZFlNRChuZXdZTUQsIG9sZFlNRCkgewogICAgLy8gVE9ETzoKICAgIC8vICAgU2hvdWxkIHdlIGNvbXBhcmUgdG8gYGZvcm1hdFlNRCh0aGlzLnZhbHVlKWAgYW5kIGVtaXQKICAgIC8vICAgb25seSBpZiB0aGV5IGFyZSBkaWZmZXJlbnQ/CiAgICBpZiAobmV3WU1EICE9PSBvbGRZTUQpIHsKICAgICAgdGhpcy4kZW1pdChNT0RFTF9FVkVOVF9OQU1FLCB0aGlzLnZhbHVlQXNEYXRlID8gcGFyc2VZTUQobmV3WU1EKSB8fCBudWxsIDogbmV3WU1EIHx8ICcnKTsKICAgIH0KICB9KSwgX2RlZmluZVByb3BlcnR5KF93YXRjaCwgImNvbnRleHQiLCBmdW5jdGlvbiBjb250ZXh0KG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgaWYgKCFsb29zZUVxdWFsKG5ld1ZhbHVlLCBvbGRWYWx1ZSkpIHsKICAgICAgdGhpcy4kZW1pdChFVkVOVF9OQU1FX0NPTlRFWFQsIG5ld1ZhbHVlKTsKICAgIH0KICB9KSwgX2RlZmluZVByb3BlcnR5KF93YXRjaCwgImhpZGRlbiIsIGZ1bmN0aW9uIGhpZGRlbihuZXdWYWx1ZSkgewogICAgLy8gUmVzZXQgdGhlIGFjdGl2ZSBmb2N1c2VkIGRheSB3aGVuIGhpZGRlbgogICAgdGhpcy5hY3RpdmVZTUQgPSB0aGlzLnNlbGVjdGVkWU1EIHx8IGZvcm1hdFlNRCh0aGlzW01PREVMX1BST1BfTkFNRV0gfHwgdGhpcy5jb25zdHJhaW5EYXRlKHRoaXMuaW5pdGlhbERhdGUgfHwgdGhpcy5nZXRUb2RheSgpKSk7IC8vIEVuYWJsZS9kaXNhYmxlIHRoZSBsaXZlIHJlZ2lvbnMKCiAgICB0aGlzLnNldExpdmUoIW5ld1ZhbHVlKTsKICB9KSwgX3dhdGNoKSwKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICBfdGhpczMuJGVtaXQoRVZFTlRfTkFNRV9DT05URVhULCBfdGhpczMuY29udGV4dCk7CiAgICB9KTsKICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICB0aGlzLnNldExpdmUodHJ1ZSk7CiAgfSwKCiAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KICBhY3RpdmF0ZWQ6IGZ1bmN0aW9uIGFjdGl2YXRlZCgpIHsKICAgIHRoaXMuc2V0TGl2ZSh0cnVlKTsKICB9LAoKICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwogIGRlYWN0aXZhdGVkOiBmdW5jdGlvbiBkZWFjdGl2YXRlZCgpIHsKICAgIHRoaXMuc2V0TGl2ZShmYWxzZSk7CiAgfSwKICBiZWZvcmVEZXN0cm95OiBmdW5jdGlvbiBiZWZvcmVEZXN0cm95KCkgewogICAgdGhpcy5zZXRMaXZlKGZhbHNlKTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC8vIFB1YmxpYyBtZXRob2QocykKICAgIGZvY3VzOiBmdW5jdGlvbiBmb2N1cygpIHsKICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKSB7CiAgICAgICAgYXR0ZW1wdEZvY3VzKHRoaXMuJHJlZnMuZ3JpZCk7CiAgICAgIH0KICAgIH0sCiAgICBibHVyOiBmdW5jdGlvbiBibHVyKCkgewogICAgICBpZiAoIXRoaXMuZGlzYWJsZWQpIHsKICAgICAgICBhdHRlbXB0Qmx1cih0aGlzLiRyZWZzLmdyaWQpOwogICAgICB9CiAgICB9LAogICAgLy8gUHJpdmF0ZSBtZXRob2RzCiAgICBzZXRMaXZlOiBmdW5jdGlvbiBzZXRMaXZlKG9uKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgaWYgKG9uKSB7CiAgICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgcmVxdWVzdEFGKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgX3RoaXM0LmlzTGl2ZSA9IHRydWU7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmlzTGl2ZSA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgZ2V0VG9kYXk6IGZ1bmN0aW9uIGdldFRvZGF5KCkgewogICAgICByZXR1cm4gcGFyc2VZTUQoY3JlYXRlRGF0ZSgpKTsKICAgIH0sCiAgICBjb25zdHJhaW5EYXRlOiBmdW5jdGlvbiBjb25zdHJhaW5EYXRlKGRhdGUpIHsKICAgICAgLy8gQ29uc3RyYWlucyBhIGRhdGUgYmV0d2VlbiBtaW4gYW5kIG1heAogICAgICAvLyByZXR1cm5zIGEgbmV3IGBEYXRlYCBvYmplY3QgaW5zdGFuY2UKICAgICAgcmV0dXJuIF9jb25zdHJhaW5EYXRlKGRhdGUsIHRoaXMuY29tcHV0ZWRNaW4sIHRoaXMuY29tcHV0ZWRNYXgpOwogICAgfSwKICAgIGVtaXRTZWxlY3RlZDogZnVuY3Rpb24gZW1pdFNlbGVjdGVkKGRhdGUpIHsKICAgICAgdmFyIF90aGlzNSA9IHRoaXM7IC8vIFBlcmZvcm1lZCBpbiBhIGAkbmV4dFRpY2soKWAgdG8gKHByb2JhYmx5KSBlbnN1cmUKICAgICAgLy8gdGhlIGlucHV0IGV2ZW50IGhhcyBlbWl0dGVkIGZpcnN0CgoKICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzNS4kZW1pdChFVkVOVF9OQU1FX1NFTEVDVEVELCBmb3JtYXRZTUQoZGF0ZSkgfHwgJycsIHBhcnNlWU1EKGRhdGUpIHx8IG51bGwpOwogICAgICB9KTsKICAgIH0sCiAgICAvLyBFdmVudCBoYW5kbGVycwogICAgc2V0R3JpZEZvY3VzRmxhZzogZnVuY3Rpb24gc2V0R3JpZEZvY3VzRmxhZyhldmVudCkgewogICAgICAvLyBTZXRzIHRoZSBncmlkSGFzRm9jdXMgZmxhZyB0byBtYWtlIGRhdGUgImJ1dHRvbiIgbG9vayBmb2N1c2VkCiAgICAgIHRoaXMuZ3JpZEhhc0ZvY3VzID0gIXRoaXMuZGlzYWJsZWQgJiYgZXZlbnQudHlwZSA9PT0gJ2ZvY3VzJzsKICAgIH0sCiAgICBvbktleWRvd25XcmFwcGVyOiBmdW5jdGlvbiBvbktleWRvd25XcmFwcGVyKGV2ZW50KSB7CiAgICAgIC8vIENhbGVuZGFyIGtleWJvYXJkIG5hdmlnYXRpb24KICAgICAgLy8gSGFuZGxlcyBQQUdFVVAvUEFHRURPV04vRU5EL0hPTUUvTEVGVC9VUC9SSUdIVC9ET1dOCiAgICAgIC8vIEZvY3VzZXMgZ3JpZCBhZnRlciB1cGRhdGluZwogICAgICBpZiAodGhpcy5ub0tleU5hdikgewogICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgYWx0S2V5ID0gZXZlbnQuYWx0S2V5LAogICAgICAgICAgY3RybEtleSA9IGV2ZW50LmN0cmxLZXksCiAgICAgICAgICBrZXlDb2RlID0gZXZlbnQua2V5Q29kZTsKCiAgICAgIGlmICghYXJyYXlJbmNsdWRlcyhbQ09ERV9QQUdFVVAsIENPREVfUEFHRURPV04sIENPREVfRU5ELCBDT0RFX0hPTUUsIENPREVfTEVGVCwgQ09ERV9VUCwgQ09ERV9SSUdIVCwgQ09ERV9ET1dOXSwga2V5Q29kZSkpIHsKICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgc3RvcEV2ZW50KGV2ZW50KTsKICAgICAgdmFyIGFjdGl2ZURhdGUgPSBjcmVhdGVEYXRlKHRoaXMuYWN0aXZlRGF0ZSk7CiAgICAgIHZhciBjaGVja0RhdGUgPSBjcmVhdGVEYXRlKHRoaXMuYWN0aXZlRGF0ZSk7CiAgICAgIHZhciBkYXkgPSBhY3RpdmVEYXRlLmdldERhdGUoKTsKICAgICAgdmFyIGNvbnN0cmFpbmVkVG9kYXkgPSB0aGlzLmNvbnN0cmFpbkRhdGUodGhpcy5nZXRUb2RheSgpKTsKICAgICAgdmFyIGlzUlRMID0gdGhpcy5pc1JUTDsKCiAgICAgIGlmIChrZXlDb2RlID09PSBDT0RFX1BBR0VVUCkgewogICAgICAgIC8vIFBBR0VVUCAtIFByZXZpb3VzIG1vbnRoL3llYXIKICAgICAgICBhY3RpdmVEYXRlID0gKGFsdEtleSA/IGN0cmxLZXkgPyBvbmVEZWNhZGVBZ28gOiBvbmVZZWFyQWdvIDogb25lTW9udGhBZ28pKGFjdGl2ZURhdGUpOyAvLyBXZSBjaGVjayB0aGUgZmlyc3QgZGF5IG9mIG1vbnRoIHRvIGJlIGluIHJhZ2UKCiAgICAgICAgY2hlY2tEYXRlID0gY3JlYXRlRGF0ZShhY3RpdmVEYXRlKTsKICAgICAgICBjaGVja0RhdGUuc2V0RGF0ZSgxKTsKICAgICAgfSBlbHNlIGlmIChrZXlDb2RlID09PSBDT0RFX1BBR0VET1dOKSB7CiAgICAgICAgLy8gUEFHRURPV04gLSBOZXh0IG1vbnRoL3llYXIKICAgICAgICBhY3RpdmVEYXRlID0gKGFsdEtleSA/IGN0cmxLZXkgPyBvbmVEZWNhZGVBaGVhZCA6IG9uZVllYXJBaGVhZCA6IG9uZU1vbnRoQWhlYWQpKGFjdGl2ZURhdGUpOyAvLyBXZSBjaGVjayB0aGUgbGFzdCBkYXkgb2YgbW9udGggdG8gYmUgaW4gcmFnZQoKICAgICAgICBjaGVja0RhdGUgPSBjcmVhdGVEYXRlKGFjdGl2ZURhdGUpOwogICAgICAgIGNoZWNrRGF0ZS5zZXRNb250aChjaGVja0RhdGUuZ2V0TW9udGgoKSArIDEpOwogICAgICAgIGNoZWNrRGF0ZS5zZXREYXRlKDApOwogICAgICB9IGVsc2UgaWYgKGtleUNvZGUgPT09IENPREVfTEVGVCkgewogICAgICAgIC8vIExFRlQgLSBQcmV2aW91cyBkYXkgKG9yIG5leHQgZGF5IGZvciBSVEwpCiAgICAgICAgYWN0aXZlRGF0ZS5zZXREYXRlKGRheSArIChpc1JUTCA/IDEgOiAtMSkpOwogICAgICAgIGFjdGl2ZURhdGUgPSB0aGlzLmNvbnN0cmFpbkRhdGUoYWN0aXZlRGF0ZSk7CiAgICAgICAgY2hlY2tEYXRlID0gYWN0aXZlRGF0ZTsKICAgICAgfSBlbHNlIGlmIChrZXlDb2RlID09PSBDT0RFX1JJR0hUKSB7CiAgICAgICAgLy8gUklHSFQgLSBOZXh0IGRheSAob3IgcHJldmlvdXMgZGF5IGZvciBSVEwpCiAgICAgICAgYWN0aXZlRGF0ZS5zZXREYXRlKGRheSArIChpc1JUTCA/IC0xIDogMSkpOwogICAgICAgIGFjdGl2ZURhdGUgPSB0aGlzLmNvbnN0cmFpbkRhdGUoYWN0aXZlRGF0ZSk7CiAgICAgICAgY2hlY2tEYXRlID0gYWN0aXZlRGF0ZTsKICAgICAgfSBlbHNlIGlmIChrZXlDb2RlID09PSBDT0RFX1VQKSB7CiAgICAgICAgLy8gVVAgLSBQcmV2aW91cyB3ZWVrCiAgICAgICAgYWN0aXZlRGF0ZS5zZXREYXRlKGRheSAtIDcpOwogICAgICAgIGFjdGl2ZURhdGUgPSB0aGlzLmNvbnN0cmFpbkRhdGUoYWN0aXZlRGF0ZSk7CiAgICAgICAgY2hlY2tEYXRlID0gYWN0aXZlRGF0ZTsKICAgICAgfSBlbHNlIGlmIChrZXlDb2RlID09PSBDT0RFX0RPV04pIHsKICAgICAgICAvLyBET1dOIC0gTmV4dCB3ZWVrCiAgICAgICAgYWN0aXZlRGF0ZS5zZXREYXRlKGRheSArIDcpOwogICAgICAgIGFjdGl2ZURhdGUgPSB0aGlzLmNvbnN0cmFpbkRhdGUoYWN0aXZlRGF0ZSk7CiAgICAgICAgY2hlY2tEYXRlID0gYWN0aXZlRGF0ZTsKICAgICAgfSBlbHNlIGlmIChrZXlDb2RlID09PSBDT0RFX0hPTUUpIHsKICAgICAgICAvLyBIT01FIC0gVG9kYXkKICAgICAgICBhY3RpdmVEYXRlID0gY29uc3RyYWluZWRUb2RheTsKICAgICAgICBjaGVja0RhdGUgPSBhY3RpdmVEYXRlOwogICAgICB9IGVsc2UgaWYgKGtleUNvZGUgPT09IENPREVfRU5EKSB7CiAgICAgICAgLy8gRU5EIC0gU2VsZWN0ZWQgZGF0ZSwgb3IgdG9kYXkgaWYgbm8gc2VsZWN0ZWQgZGF0ZQogICAgICAgIGFjdGl2ZURhdGUgPSBwYXJzZVlNRCh0aGlzLnNlbGVjdGVkRGF0ZSkgfHwgY29uc3RyYWluZWRUb2RheTsKICAgICAgICBjaGVja0RhdGUgPSBhY3RpdmVEYXRlOwogICAgICB9CgogICAgICBpZiAoIXRoaXMuZGF0ZU91dE9mUmFuZ2UoY2hlY2tEYXRlKSAmJiAhZGF0ZXNFcXVhbChhY3RpdmVEYXRlLCB0aGlzLmFjdGl2ZURhdGUpKSB7CiAgICAgICAgLy8gV2Ugb25seSBqdW1wIHRvIGRhdGUgaWYgd2l0aGluIG1pbi9tYXgKICAgICAgICAvLyBXZSBkb24ndCBjaGVjayBmb3IgaW5kaXZpZHVhbCBkaXNhYmxlZCBkYXRlcyB0aG91Z2ggKHZpYSB1c2VyIGZ1bmN0aW9uKQogICAgICAgIHRoaXMuYWN0aXZlWU1EID0gZm9ybWF0WU1EKGFjdGl2ZURhdGUpOwogICAgICB9IC8vIEVuc3VyZSBncmlkIGlzIGZvY3VzZWQKCgogICAgICB0aGlzLmZvY3VzKCk7CiAgICB9LAogICAgb25LZXlkb3duR3JpZDogZnVuY3Rpb24gb25LZXlkb3duR3JpZChldmVudCkgewogICAgICAvLyBQcmVzc2luZyBlbnRlci9zcGFjZSBvbiBncmlkIHRvIHNlbGVjdCBhY3RpdmUgZGF0ZQogICAgICB2YXIga2V5Q29kZSA9IGV2ZW50LmtleUNvZGU7CiAgICAgIHZhciBhY3RpdmVEYXRlID0gdGhpcy5hY3RpdmVEYXRlOwoKICAgICAgaWYgKGtleUNvZGUgPT09IENPREVfRU5URVIgfHwga2V5Q29kZSA9PT0gQ09ERV9TUEFDRSkgewogICAgICAgIHN0b3BFdmVudChldmVudCk7CgogICAgICAgIGlmICghdGhpcy5kaXNhYmxlZCAmJiAhdGhpcy5yZWFkb25seSAmJiAhdGhpcy5kYXRlRGlzYWJsZWQoYWN0aXZlRGF0ZSkpIHsKICAgICAgICAgIHRoaXMuc2VsZWN0ZWRZTUQgPSBmb3JtYXRZTUQoYWN0aXZlRGF0ZSk7CiAgICAgICAgICB0aGlzLmVtaXRTZWxlY3RlZChhY3RpdmVEYXRlKTsKICAgICAgICB9IC8vIEVuc3VyZSBncmlkIGlzIGZvY3VzZWQKCgogICAgICAgIHRoaXMuZm9jdXMoKTsKICAgICAgfQogICAgfSwKICAgIG9uQ2xpY2tEYXk6IGZ1bmN0aW9uIG9uQ2xpY2tEYXkoZGF5KSB7CiAgICAgIC8vIENsaWNraW5nIG9uIGEgZGF0ZSAiYnV0dG9uIiB0byBzZWxlY3QgaXQKICAgICAgdmFyIHNlbGVjdGVkRGF0ZSA9IHRoaXMuc2VsZWN0ZWREYXRlLAogICAgICAgICAgYWN0aXZlRGF0ZSA9IHRoaXMuYWN0aXZlRGF0ZTsKICAgICAgdmFyIGNsaWNrZWREYXRlID0gcGFyc2VZTUQoZGF5LnltZCk7CgogICAgICBpZiAoIXRoaXMuZGlzYWJsZWQgJiYgIWRheS5pc0Rpc2FibGVkICYmICF0aGlzLmRhdGVEaXNhYmxlZChjbGlja2VkRGF0ZSkpIHsKICAgICAgICBpZiAoIXRoaXMucmVhZG9ubHkpIHsKICAgICAgICAgIC8vIElmIHJlYWRvbmx5IG1vZGUsIHdlIGRvbid0IHNldCB0aGUgc2VsZWN0ZWQgZGF0ZSwganVzdCB0aGUgYWN0aXZlIGRhdGUKICAgICAgICAgIC8vIElmIHRoZSBjbGlja2VkIGRhdGUgaXMgZXF1YWwgdG8gdGhlIGFscmVhZHkgc2VsZWN0ZWQgZGF0ZSwgd2UgZG9uJ3QgdXBkYXRlIHRoZSBtb2RlbAogICAgICAgICAgdGhpcy5zZWxlY3RlZFlNRCA9IGZvcm1hdFlNRChkYXRlc0VxdWFsKGNsaWNrZWREYXRlLCBzZWxlY3RlZERhdGUpID8gc2VsZWN0ZWREYXRlIDogY2xpY2tlZERhdGUpOwogICAgICAgICAgdGhpcy5lbWl0U2VsZWN0ZWQoY2xpY2tlZERhdGUpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5hY3RpdmVZTUQgPSBmb3JtYXRZTUQoZGF0ZXNFcXVhbChjbGlja2VkRGF0ZSwgYWN0aXZlRGF0ZSkgPyBhY3RpdmVEYXRlIDogY3JlYXRlRGF0ZShjbGlja2VkRGF0ZSkpOyAvLyBFbnN1cmUgZ3JpZCBpcyBmb2N1c2VkCgogICAgICAgIHRoaXMuZm9jdXMoKTsKICAgICAgfQogICAgfSwKICAgIGdvdG9QcmV2RGVjYWRlOiBmdW5jdGlvbiBnb3RvUHJldkRlY2FkZSgpIHsKICAgICAgdGhpcy5hY3RpdmVZTUQgPSBmb3JtYXRZTUQodGhpcy5jb25zdHJhaW5EYXRlKG9uZURlY2FkZUFnbyh0aGlzLmFjdGl2ZURhdGUpKSk7CiAgICB9LAogICAgZ290b1ByZXZZZWFyOiBmdW5jdGlvbiBnb3RvUHJldlllYXIoKSB7CiAgICAgIHRoaXMuYWN0aXZlWU1EID0gZm9ybWF0WU1EKHRoaXMuY29uc3RyYWluRGF0ZShvbmVZZWFyQWdvKHRoaXMuYWN0aXZlRGF0ZSkpKTsKICAgIH0sCiAgICBnb3RvUHJldk1vbnRoOiBmdW5jdGlvbiBnb3RvUHJldk1vbnRoKCkgewogICAgICB0aGlzLmFjdGl2ZVlNRCA9IGZvcm1hdFlNRCh0aGlzLmNvbnN0cmFpbkRhdGUob25lTW9udGhBZ28odGhpcy5hY3RpdmVEYXRlKSkpOwogICAgfSwKICAgIGdvdG9DdXJyZW50TW9udGg6IGZ1bmN0aW9uIGdvdG9DdXJyZW50TW9udGgoKSB7CiAgICAgIC8vIFRPRE86IE1heWJlIHRoaXMgZ290byBkYXRlIHNob3VsZCBiZSBjb25maWd1cmFibGU/CiAgICAgIHRoaXMuYWN0aXZlWU1EID0gZm9ybWF0WU1EKHRoaXMuY29uc3RyYWluRGF0ZSh0aGlzLmdldFRvZGF5KCkpKTsKICAgIH0sCiAgICBnb3RvTmV4dE1vbnRoOiBmdW5jdGlvbiBnb3RvTmV4dE1vbnRoKCkgewogICAgICB0aGlzLmFjdGl2ZVlNRCA9IGZvcm1hdFlNRCh0aGlzLmNvbnN0cmFpbkRhdGUob25lTW9udGhBaGVhZCh0aGlzLmFjdGl2ZURhdGUpKSk7CiAgICB9LAogICAgZ290b05leHRZZWFyOiBmdW5jdGlvbiBnb3RvTmV4dFllYXIoKSB7CiAgICAgIHRoaXMuYWN0aXZlWU1EID0gZm9ybWF0WU1EKHRoaXMuY29uc3RyYWluRGF0ZShvbmVZZWFyQWhlYWQodGhpcy5hY3RpdmVEYXRlKSkpOwogICAgfSwKICAgIGdvdG9OZXh0RGVjYWRlOiBmdW5jdGlvbiBnb3RvTmV4dERlY2FkZSgpIHsKICAgICAgdGhpcy5hY3RpdmVZTUQgPSBmb3JtYXRZTUQodGhpcy5jb25zdHJhaW5EYXRlKG9uZURlY2FkZUFoZWFkKHRoaXMuYWN0aXZlRGF0ZSkpKTsKICAgIH0sCiAgICBvbkhlYWRlckNsaWNrOiBmdW5jdGlvbiBvbkhlYWRlckNsaWNrKCkgewogICAgICBpZiAoIXRoaXMuZGlzYWJsZWQpIHsKICAgICAgICB0aGlzLmFjdGl2ZVlNRCA9IHRoaXMuc2VsZWN0ZWRZTUQgfHwgZm9ybWF0WU1EKHRoaXMuZ2V0VG9kYXkoKSk7CiAgICAgICAgdGhpcy5mb2N1cygpOwogICAgICB9CiAgICB9CiAgfSwKICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihoKSB7CiAgICB2YXIgX3RoaXM2ID0gdGhpczsgLy8gSWYgYGhpZGRlbmAgcHJvcCBpcyBzZXQsIHJlbmRlciBqdXN0IGEgcGxhY2Vob2xkZXIgbm9kZQoKCiAgICBpZiAodGhpcy5oaWRkZW4pIHsKICAgICAgcmV0dXJuIGgoKTsKICAgIH0KCiAgICB2YXIgdmFsdWVJZCA9IHRoaXMudmFsdWVJZCwKICAgICAgICB3aWRnZXRJZCA9IHRoaXMud2lkZ2V0SWQsCiAgICAgICAgbmF2SWQgPSB0aGlzLm5hdklkLAogICAgICAgIGdyaWRJZCA9IHRoaXMuZ3JpZElkLAogICAgICAgIGdyaWRDYXB0aW9uSWQgPSB0aGlzLmdyaWRDYXB0aW9uSWQsCiAgICAgICAgZ3JpZEhlbHBJZCA9IHRoaXMuZ3JpZEhlbHBJZCwKICAgICAgICBhY3RpdmVJZCA9IHRoaXMuYWN0aXZlSWQsCiAgICAgICAgZGlzYWJsZWQgPSB0aGlzLmRpc2FibGVkLAogICAgICAgIG5vS2V5TmF2ID0gdGhpcy5ub0tleU5hdiwKICAgICAgICBpc0xpdmUgPSB0aGlzLmlzTGl2ZSwKICAgICAgICBpc1JUTCA9IHRoaXMuaXNSVEwsCiAgICAgICAgYWN0aXZlWU1EID0gdGhpcy5hY3RpdmVZTUQsCiAgICAgICAgc2VsZWN0ZWRZTUQgPSB0aGlzLnNlbGVjdGVkWU1ELAogICAgICAgIHNhZmVJZCA9IHRoaXMuc2FmZUlkOwogICAgdmFyIGhpZGVEZWNhZGVOYXYgPSAhdGhpcy5zaG93RGVjYWRlTmF2OwogICAgdmFyIHRvZGF5WU1EID0gZm9ybWF0WU1EKHRoaXMuZ2V0VG9kYXkoKSk7CiAgICB2YXIgaGlnaGxpZ2h0VG9kYXkgPSAhdGhpcy5ub0hpZ2hsaWdodFRvZGF5OyAvLyBIZWFkZXIgc2hvd2luZyBjdXJyZW50IHNlbGVjdGVkIGRhdGUKCiAgICB2YXIgJGhlYWRlciA9IGgoJ291dHB1dCcsIHsKICAgICAgc3RhdGljQ2xhc3M6ICdmb3JtLWNvbnRyb2wgZm9ybS1jb250cm9sLXNtIHRleHQtY2VudGVyJywKICAgICAgImNsYXNzIjogewogICAgICAgICd0ZXh0LW11dGVkJzogZGlzYWJsZWQsCiAgICAgICAgcmVhZG9ubHk6IHRoaXMucmVhZG9ubHkgfHwgZGlzYWJsZWQKICAgICAgfSwKICAgICAgYXR0cnM6IHsKICAgICAgICBpZDogdmFsdWVJZCwKICAgICAgICAiZm9yIjogZ3JpZElkLAogICAgICAgIHJvbGU6ICdzdGF0dXMnLAogICAgICAgIHRhYmluZGV4OiBkaXNhYmxlZCA/IG51bGwgOiAnLTEnLAogICAgICAgIC8vIE1haW5seSBmb3IgdGVzdGluZyBwdXJwb3NlcywgYXMgd2UgZG8gbm90IGtub3cKICAgICAgICAvLyB0aGUgZXhhY3QgZm9ybWF0IGBJbnRsYCB3aWxsIGZvcm1hdCB0aGUgZGF0ZSBzdHJpbmcKICAgICAgICAnZGF0YS1zZWxlY3RlZCc6IHRvU3RyaW5nKHNlbGVjdGVkWU1EKSwKICAgICAgICAvLyBXZSB3YWl0IHVudGlsIGFmdGVyIG1vdW50IHRvIGVuYWJsZSBgYXJpYS1saXZlYAogICAgICAgIC8vIHRvIHByZXZlbnQgaW5pdGlhbCBhbm5vdW5jZW1lbnQgb24gcGFnZSByZW5kZXIKICAgICAgICAnYXJpYS1saXZlJzogaXNMaXZlID8gJ3BvbGl0ZScgOiAnb2ZmJywKICAgICAgICAnYXJpYS1hdG9taWMnOiBpc0xpdmUgPyAndHJ1ZScgOiBudWxsCiAgICAgIH0sCiAgICAgIG9uOiB7CiAgICAgICAgLy8gVHJhbnNmZXIgZm9jdXMvY2xpY2sgdG8gZm9jdXMgZ3JpZAogICAgICAgIC8vIGFuZCBmb2N1cyBhY3RpdmUgZGF0ZSAob3IgdG9kYXkgaWYgbm8gc2VsZWN0aW9uKQogICAgICAgIGNsaWNrOiB0aGlzLm9uSGVhZGVyQ2xpY2ssCiAgICAgICAgZm9jdXM6IHRoaXMub25IZWFkZXJDbGljawogICAgICB9CiAgICB9LCB0aGlzLnNlbGVjdGVkRGF0ZSA/IFsvLyBXZSB1c2UgYGJkaWAgZWxlbWVudHMgaGVyZSBpbiBjYXNlIHRoZSBsYWJlbCBkb2Vzbid0IG1hdGNoIHRoZSBsb2NhbGUKICAgIC8vIEFsdGhvdWdoIElFIDExIGRvZXMgbm90IGRlYWwgd2l0aCA8QkRJPiBhdCBhbGwgKGVxdWl2YWxlbnQgdG8gYSBzcGFuKQogICAgaCgnYmRpJywgewogICAgICBzdGF0aWNDbGFzczogJ3NyLW9ubHknCiAgICB9LCAiICgiLmNvbmNhdCh0b1N0cmluZyh0aGlzLmxhYmVsU2VsZWN0ZWQpLCAiKSAiKSksIGgoJ2JkaScsIHRoaXMuZm9ybWF0RGF0ZVN0cmluZyh0aGlzLnNlbGVjdGVkRGF0ZSkpXSA6IHRoaXMubGFiZWxOb0RhdGVTZWxlY3RlZCB8fCAiXHhBMCIgLy8gJyZuYnNwOycKICAgICk7CiAgICAkaGVhZGVyID0gaCgnaGVhZGVyJywgewogICAgICBzdGF0aWNDbGFzczogJ2ItY2FsZW5kYXItaGVhZGVyJywKICAgICAgImNsYXNzIjogewogICAgICAgICdzci1vbmx5JzogdGhpcy5oaWRlSGVhZGVyCiAgICAgIH0sCiAgICAgIGF0dHJzOiB7CiAgICAgICAgdGl0bGU6IHRoaXMuc2VsZWN0ZWREYXRlID8gdGhpcy5sYWJlbFNlbGVjdGVkRGF0ZSB8fCBudWxsIDogbnVsbAogICAgICB9CiAgICB9LCBbJGhlYWRlcl0pOyAvLyBDb250ZW50IGZvciB0aGUgZGF0ZSBuYXZpZ2F0aW9uIGJ1dHRvbnMKCiAgICB2YXIgbmF2U2NvcGUgPSB7CiAgICAgIGlzUlRMOiBpc1JUTAogICAgfTsKICAgIHZhciBuYXZQcm9wcyA9IHsKICAgICAgc2hpZnRWOiAwLjUKICAgIH07CgogICAgdmFyIG5hdlByZXZQcm9wcyA9IF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgbmF2UHJvcHMpLCB7fSwgewogICAgICBmbGlwSDogaXNSVEwKICAgIH0pOwoKICAgIHZhciBuYXZOZXh0UHJvcHMgPSBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIG5hdlByb3BzKSwge30sIHsKICAgICAgZmxpcEg6ICFpc1JUTAogICAgfSk7CgogICAgdmFyICRwcmV2RGVjYWRlSWNvbiA9IHRoaXMubm9ybWFsaXplU2xvdChTTE9UX05BTUVfTkFWX1BFVl9ERUNBREUsIG5hdlNjb3BlKSB8fCBoKEJJY29uQ2hldnJvbkJhckxlZnQsIHsKICAgICAgcHJvcHM6IG5hdlByZXZQcm9wcwogICAgfSk7CiAgICB2YXIgJHByZXZZZWFySWNvbiA9IHRoaXMubm9ybWFsaXplU2xvdChTTE9UX05BTUVfTkFWX1BFVl9ZRUFSLCBuYXZTY29wZSkgfHwgaChCSWNvbkNoZXZyb25Eb3VibGVMZWZ0LCB7CiAgICAgIHByb3BzOiBuYXZQcmV2UHJvcHMKICAgIH0pOwogICAgdmFyICRwcmV2TW9udGhJY29uID0gdGhpcy5ub3JtYWxpemVTbG90KFNMT1RfTkFNRV9OQVZfUEVWX01PTlRILCBuYXZTY29wZSkgfHwgaChCSWNvbkNoZXZyb25MZWZ0LCB7CiAgICAgIHByb3BzOiBuYXZQcmV2UHJvcHMKICAgIH0pOwogICAgdmFyICR0aGlzTW9udGhJY29uID0gdGhpcy5ub3JtYWxpemVTbG90KFNMT1RfTkFNRV9OQVZfVEhJU19NT05USCwgbmF2U2NvcGUpIHx8IGgoQkljb25DaXJjbGVGaWxsLCB7CiAgICAgIHByb3BzOiBuYXZQcm9wcwogICAgfSk7CiAgICB2YXIgJG5leHRNb250aEljb24gPSB0aGlzLm5vcm1hbGl6ZVNsb3QoU0xPVF9OQU1FX05BVl9ORVhUX01PTlRILCBuYXZTY29wZSkgfHwgaChCSWNvbkNoZXZyb25MZWZ0LCB7CiAgICAgIHByb3BzOiBuYXZOZXh0UHJvcHMKICAgIH0pOwogICAgdmFyICRuZXh0WWVhckljb24gPSB0aGlzLm5vcm1hbGl6ZVNsb3QoU0xPVF9OQU1FX05BVl9ORVhUX1lFQVIsIG5hdlNjb3BlKSB8fCBoKEJJY29uQ2hldnJvbkRvdWJsZUxlZnQsIHsKICAgICAgcHJvcHM6IG5hdk5leHRQcm9wcwogICAgfSk7CiAgICB2YXIgJG5leHREZWNhZGVJY29uID0gdGhpcy5ub3JtYWxpemVTbG90KFNMT1RfTkFNRV9OQVZfTkVYVF9ERUNBREUsIG5hdlNjb3BlKSB8fCBoKEJJY29uQ2hldnJvbkJhckxlZnQsIHsKICAgICAgcHJvcHM6IG5hdk5leHRQcm9wcwogICAgfSk7IC8vIFV0aWxpdHkgdG8gY3JlYXRlIHRoZSBkYXRlIG5hdmlnYXRpb24gYnV0dG9ucwoKICAgIHZhciBtYWtlTmF2QnRuID0gZnVuY3Rpb24gbWFrZU5hdkJ0bihjb250ZW50LCBsYWJlbCwgaGFuZGxlciwgYnRuRGlzYWJsZWQsIHNob3J0Y3V0KSB7CiAgICAgIHJldHVybiBoKCdidXR0b24nLCB7CiAgICAgICAgc3RhdGljQ2xhc3M6ICdidG4gYnRuLXNtIGJvcmRlci0wIGZsZXgtZmlsbCcsCiAgICAgICAgImNsYXNzIjogW190aGlzNi5jb21wdXRlZE5hdkJ1dHRvblZhcmlhbnQsIHsKICAgICAgICAgIGRpc2FibGVkOiBidG5EaXNhYmxlZAogICAgICAgIH1dLAogICAgICAgIGF0dHJzOiB7CiAgICAgICAgICB0aXRsZTogbGFiZWwgfHwgbnVsbCwKICAgICAgICAgIHR5cGU6ICdidXR0b24nLAogICAgICAgICAgdGFiaW5kZXg6IG5vS2V5TmF2ID8gJy0xJyA6IG51bGwsCiAgICAgICAgICAnYXJpYS1sYWJlbCc6IGxhYmVsIHx8IG51bGwsCiAgICAgICAgICAnYXJpYS1kaXNhYmxlZCc6IGJ0bkRpc2FibGVkID8gJ3RydWUnIDogbnVsbCwKICAgICAgICAgICdhcmlhLWtleXNob3J0Y3V0cyc6IHNob3J0Y3V0IHx8IG51bGwKICAgICAgICB9LAogICAgICAgIG9uOiBidG5EaXNhYmxlZCA/IHt9IDogewogICAgICAgICAgY2xpY2s6IGhhbmRsZXIKICAgICAgICB9CiAgICAgIH0sIFtoKCdkaXYnLCB7CiAgICAgICAgYXR0cnM6IHsKICAgICAgICAgICdhcmlhLWhpZGRlbic6ICd0cnVlJwogICAgICAgIH0KICAgICAgfSwgW2NvbnRlbnRdKV0pOwogICAgfTsgLy8gR2VuZXJhdGUgdGhlIGRhdGUgbmF2aWdhdGlvbiBidXR0b25zCgoKICAgIHZhciAkbmF2ID0gaCgnZGl2JywgewogICAgICBzdGF0aWNDbGFzczogJ2ItY2FsZW5kYXItbmF2IGQtZmxleCcsCiAgICAgIGF0dHJzOiB7CiAgICAgICAgaWQ6IG5hdklkLAogICAgICAgIHJvbGU6ICdncm91cCcsCiAgICAgICAgdGFiaW5kZXg6IG5vS2V5TmF2ID8gJy0xJyA6IG51bGwsCiAgICAgICAgJ2FyaWEtaGlkZGVuJzogZGlzYWJsZWQgPyAndHJ1ZScgOiBudWxsLAogICAgICAgICdhcmlhLWxhYmVsJzogdGhpcy5sYWJlbE5hdiB8fCBudWxsLAogICAgICAgICdhcmlhLWNvbnRyb2xzJzogZ3JpZElkCiAgICAgIH0KICAgIH0sIFtoaWRlRGVjYWRlTmF2ID8gaCgpIDogbWFrZU5hdkJ0bigkcHJldkRlY2FkZUljb24sIHRoaXMubGFiZWxQcmV2RGVjYWRlLCB0aGlzLmdvdG9QcmV2RGVjYWRlLCB0aGlzLnByZXZEZWNhZGVEaXNhYmxlZCwgJ0N0cmwrQWx0K1BhZ2VEb3duJyksIG1ha2VOYXZCdG4oJHByZXZZZWFySWNvbiwgdGhpcy5sYWJlbFByZXZZZWFyLCB0aGlzLmdvdG9QcmV2WWVhciwgdGhpcy5wcmV2WWVhckRpc2FibGVkLCAnQWx0K1BhZ2VEb3duJyksIG1ha2VOYXZCdG4oJHByZXZNb250aEljb24sIHRoaXMubGFiZWxQcmV2TW9udGgsIHRoaXMuZ290b1ByZXZNb250aCwgdGhpcy5wcmV2TW9udGhEaXNhYmxlZCwgJ1BhZ2VEb3duJyksIG1ha2VOYXZCdG4oJHRoaXNNb250aEljb24sIHRoaXMubGFiZWxDdXJyZW50TW9udGgsIHRoaXMuZ290b0N1cnJlbnRNb250aCwgdGhpcy50aGlzTW9udGhEaXNhYmxlZCwgJ0hvbWUnKSwgbWFrZU5hdkJ0bigkbmV4dE1vbnRoSWNvbiwgdGhpcy5sYWJlbE5leHRNb250aCwgdGhpcy5nb3RvTmV4dE1vbnRoLCB0aGlzLm5leHRNb250aERpc2FibGVkLCAnUGFnZVVwJyksIG1ha2VOYXZCdG4oJG5leHRZZWFySWNvbiwgdGhpcy5sYWJlbE5leHRZZWFyLCB0aGlzLmdvdG9OZXh0WWVhciwgdGhpcy5uZXh0WWVhckRpc2FibGVkLCAnQWx0K1BhZ2VVcCcpLCBoaWRlRGVjYWRlTmF2ID8gaCgpIDogbWFrZU5hdkJ0bigkbmV4dERlY2FkZUljb24sIHRoaXMubGFiZWxOZXh0RGVjYWRlLCB0aGlzLmdvdG9OZXh0RGVjYWRlLCB0aGlzLm5leHREZWNhZGVEaXNhYmxlZCwgJ0N0cmwrQWx0K1BhZ2VVcCcpXSk7IC8vIENhcHRpb24gZm9yIGNhbGVuZGFyIGdyaWQKCiAgICB2YXIgJGdyaWRDYXB0aW9uID0gaCgnaGVhZGVyJywgewogICAgICBzdGF0aWNDbGFzczogJ2ItY2FsZW5kYXItZ3JpZC1jYXB0aW9uIHRleHQtY2VudGVyIGZvbnQtd2VpZ2h0LWJvbGQnLAogICAgICAiY2xhc3MiOiB7CiAgICAgICAgJ3RleHQtbXV0ZWQnOiBkaXNhYmxlZAogICAgICB9LAogICAgICBhdHRyczogewogICAgICAgIGlkOiBncmlkQ2FwdGlvbklkLAogICAgICAgICdhcmlhLWxpdmUnOiBpc0xpdmUgPyAncG9saXRlJyA6IG51bGwsCiAgICAgICAgJ2FyaWEtYXRvbWljJzogaXNMaXZlID8gJ3RydWUnIDogbnVsbAogICAgICB9LAogICAgICBrZXk6ICdncmlkLWNhcHRpb24nCiAgICB9LCB0aGlzLmZvcm1hdFllYXJNb250aCh0aGlzLmNhbGVuZGFyRmlyc3REYXkpKTsgLy8gQ2FsZW5kYXIgd2Vla2RheSBoZWFkaW5ncwoKICAgIHZhciAkZ3JpZFdlZWtEYXlzID0gaCgnZGl2JywgewogICAgICBzdGF0aWNDbGFzczogJ2ItY2FsZW5kYXItZ3JpZC13ZWVrZGF5cyByb3cgbm8tZ3V0dGVycyBib3JkZXItYm90dG9tJywKICAgICAgYXR0cnM6IHsKICAgICAgICAnYXJpYS1oaWRkZW4nOiAndHJ1ZScKICAgICAgfQogICAgfSwgdGhpcy5jYWxlbmRhckhlYWRpbmdzLm1hcChmdW5jdGlvbiAoZCwgaWR4KSB7CiAgICAgIHJldHVybiBoKCdzbWFsbCcsIHsKICAgICAgICBzdGF0aWNDbGFzczogJ2NvbCB0ZXh0LXRydW5jYXRlJywKICAgICAgICAiY2xhc3MiOiB7CiAgICAgICAgICAndGV4dC1tdXRlZCc6IGRpc2FibGVkCiAgICAgICAgfSwKICAgICAgICBhdHRyczogewogICAgICAgICAgdGl0bGU6IGQubGFiZWwgPT09IGQudGV4dCA/IG51bGwgOiBkLmxhYmVsLAogICAgICAgICAgJ2FyaWEtbGFiZWwnOiBkLmxhYmVsCiAgICAgICAgfSwKICAgICAgICBrZXk6IGlkeAogICAgICB9LCBkLnRleHQpOwogICAgfSkpOyAvLyBDYWxlbmRhciBkYXkgZ3JpZAoKICAgIHZhciAkZ3JpZEJvZHkgPSB0aGlzLmNhbGVuZGFyLm1hcChmdW5jdGlvbiAod2VlaykgewogICAgICB2YXIgJGNlbGxzID0gd2Vlay5tYXAoZnVuY3Rpb24gKGRheSwgZEluZGV4KSB7CiAgICAgICAgdmFyIF9jbGFzczsKCiAgICAgICAgdmFyIGlzU2VsZWN0ZWQgPSBkYXkueW1kID09PSBzZWxlY3RlZFlNRDsKICAgICAgICB2YXIgaXNBY3RpdmUgPSBkYXkueW1kID09PSBhY3RpdmVZTUQ7CiAgICAgICAgdmFyIGlzVG9kYXkgPSBkYXkueW1kID09PSB0b2RheVlNRDsKICAgICAgICB2YXIgaWRDZWxsID0gc2FmZUlkKCJfY2VsbC0iLmNvbmNhdChkYXkueW1kLCAiXyIpKTsgLy8gImZha2UiIGJ1dHRvbgoKICAgICAgICB2YXIgJGJ0biA9IGgoJ3NwYW4nLCB7CiAgICAgICAgICBzdGF0aWNDbGFzczogJ2J0biBib3JkZXItMCByb3VuZGVkLWNpcmNsZSB0ZXh0LW5vd3JhcCcsCiAgICAgICAgICAvLyBTaG91bGQgd2UgYWRkIHNvbWUgY2xhc3NlcyB0byBzaWduaWZ5IGlmIHRvZGF5L3NlbGVjdGVkL2V0Yz8KICAgICAgICAgICJjbGFzcyI6IChfY2xhc3MgPSB7CiAgICAgICAgICAgIC8vIEdpdmUgdGhlIGZha2UgYnV0dG9uIGEgZm9jdXMgcmluZwogICAgICAgICAgICBmb2N1czogaXNBY3RpdmUgJiYgX3RoaXM2LmdyaWRIYXNGb2N1cywKICAgICAgICAgICAgLy8gU3R5bGluZwogICAgICAgICAgICBkaXNhYmxlZDogZGF5LmlzRGlzYWJsZWQgfHwgZGlzYWJsZWQsCiAgICAgICAgICAgIGFjdGl2ZTogaXNTZWxlY3RlZAogICAgICAgICAgfSwgX2RlZmluZVByb3BlcnR5KF9jbGFzcywgX3RoaXM2LmNvbXB1dGVkVmFyaWFudCwgaXNTZWxlY3RlZCksIF9kZWZpbmVQcm9wZXJ0eShfY2xhc3MsIF90aGlzNi5jb21wdXRlZFRvZGF5VmFyaWFudCwgaXNUb2RheSAmJiBoaWdobGlnaHRUb2RheSAmJiAhaXNTZWxlY3RlZCAmJiBkYXkuaXNUaGlzTW9udGgpLCBfZGVmaW5lUHJvcGVydHkoX2NsYXNzLCAnYnRuLW91dGxpbmUtbGlnaHQnLCAhKGlzVG9kYXkgJiYgaGlnaGxpZ2h0VG9kYXkpICYmICFpc1NlbGVjdGVkICYmICFpc0FjdGl2ZSksIF9kZWZpbmVQcm9wZXJ0eShfY2xhc3MsICdidG4tbGlnaHQnLCAhKGlzVG9kYXkgJiYgaGlnaGxpZ2h0VG9kYXkpICYmICFpc1NlbGVjdGVkICYmIGlzQWN0aXZlKSwgX2RlZmluZVByb3BlcnR5KF9jbGFzcywgJ3RleHQtbXV0ZWQnLCAhZGF5LmlzVGhpc01vbnRoICYmICFpc1NlbGVjdGVkKSwgX2RlZmluZVByb3BlcnR5KF9jbGFzcywgJ3RleHQtZGFyaycsICEoaXNUb2RheSAmJiBoaWdobGlnaHRUb2RheSkgJiYgIWlzU2VsZWN0ZWQgJiYgIWlzQWN0aXZlICYmIGRheS5pc1RoaXNNb250aCksIF9kZWZpbmVQcm9wZXJ0eShfY2xhc3MsICdmb250LXdlaWdodC1ib2xkJywgKGlzU2VsZWN0ZWQgfHwgZGF5LmlzVGhpc01vbnRoKSAmJiAhZGF5LmlzRGlzYWJsZWQpLCBfY2xhc3MpLAogICAgICAgICAgb246IHsKICAgICAgICAgICAgY2xpY2s6IGZ1bmN0aW9uIGNsaWNrKCkgewogICAgICAgICAgICAgIHJldHVybiBfdGhpczYub25DbGlja0RheShkYXkpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgZGF5LmRheSk7CiAgICAgICAgcmV0dXJuIGgoJ2RpdicsIC8vIENlbGwgd2l0aCBidXR0b24KICAgICAgICB7CiAgICAgICAgICBzdGF0aWNDbGFzczogJ2NvbCBwLTAnLAogICAgICAgICAgImNsYXNzIjogZGF5LmlzRGlzYWJsZWQgPyAnYmctbGlnaHQnIDogZGF5LmluZm9bImNsYXNzIl0gfHwgJycsCiAgICAgICAgICBhdHRyczogewogICAgICAgICAgICBpZDogaWRDZWxsLAogICAgICAgICAgICByb2xlOiAnYnV0dG9uJywKICAgICAgICAgICAgJ2RhdGEtZGF0ZSc6IGRheS55bWQsCiAgICAgICAgICAgIC8vIFByaW1hcmlseSBmb3IgdGVzdGluZyBwdXJwb3NlcwogICAgICAgICAgICAvLyBPbmx5IGRheXMgaW4gdGhlIG1vbnRoIGFyZSBwcmVzZW50ZWQgYXMgYnV0dG9ucyB0byBzY3JlZW4gcmVhZGVycwogICAgICAgICAgICAnYXJpYS1oaWRkZW4nOiBkYXkuaXNUaGlzTW9udGggPyBudWxsIDogJ3RydWUnLAogICAgICAgICAgICAnYXJpYS1kaXNhYmxlZCc6IGRheS5pc0Rpc2FibGVkIHx8IGRpc2FibGVkID8gJ3RydWUnIDogbnVsbCwKICAgICAgICAgICAgJ2FyaWEtbGFiZWwnOiBbZGF5LmxhYmVsLCBpc1NlbGVjdGVkID8gIigiLmNvbmNhdChfdGhpczYubGFiZWxTZWxlY3RlZCwgIikiKSA6IG51bGwsIGlzVG9kYXkgPyAiKCIuY29uY2F0KF90aGlzNi5sYWJlbFRvZGF5LCAiKSIpIDogbnVsbF0uZmlsdGVyKGlkZW50aXR5KS5qb2luKCcgJyksCiAgICAgICAgICAgIC8vIE5WREEgZG9lc24ndCBjb252ZXkgYGFyaWEtc2VsZWN0ZWRgLCBidXQgZG9lcyBgYXJpYS1jdXJyZW50YCwKICAgICAgICAgICAgLy8gQ2hyb21lVm94IGRvZXNuJ3QgY29udmV5IGBhcmlhLWN1cnJlbnRgLCBidXQgZG9lcyBgYXJpYS1zZWxlY3RlZGAsCiAgICAgICAgICAgIC8vIHNvIHdlIHNldCBib3RoIGF0dHJpYnV0ZXMgZm9yIHJvYnVzdG5lc3MKICAgICAgICAgICAgJ2FyaWEtc2VsZWN0ZWQnOiBpc1NlbGVjdGVkID8gJ3RydWUnIDogbnVsbCwKICAgICAgICAgICAgJ2FyaWEtY3VycmVudCc6IGlzU2VsZWN0ZWQgPyAnZGF0ZScgOiBudWxsCiAgICAgICAgICB9LAogICAgICAgICAga2V5OiBkSW5kZXgKICAgICAgICB9LCBbJGJ0bl0pOwogICAgICB9KTsgLy8gUmV0dXJuIHRoZSB3ZWVrICJyb3ciCiAgICAgIC8vIFdlIHVzZSB0aGUgZmlyc3QgZGF5IG9mIHRoZSB3ZWVrcyBZTUQgdmFsdWUgYXMgYQogICAgICAvLyBrZXkgZm9yIGVmZmljaWVudCBET00gcGF0Y2hpbmcgLyBlbGVtZW50IHJlLXVzZQoKICAgICAgcmV0dXJuIGgoJ2RpdicsIHsKICAgICAgICBzdGF0aWNDbGFzczogJ3JvdyBuby1ndXR0ZXJzJywKICAgICAgICBrZXk6IHdlZWtbMF0ueW1kCiAgICAgIH0sICRjZWxscyk7CiAgICB9KTsKICAgICRncmlkQm9keSA9IGgoJ2RpdicsIHsKICAgICAgLy8gQSBrZXkgaXMgb25seSByZXF1aXJlZCBvbiB0aGUgYm9keSBpZiB3ZSBhZGQgaW4gdHJhbnNpdGlvbiBzdXBwb3J0CiAgICAgIHN0YXRpY0NsYXNzOiAnYi1jYWxlbmRhci1ncmlkLWJvZHknLAogICAgICBzdHlsZTogZGlzYWJsZWQgPyB7CiAgICAgICAgcG9pbnRlckV2ZW50czogJ25vbmUnCiAgICAgIH0gOiB7fSAvLyBrZXk6IHRoaXMuYWN0aXZlWU1ELnNsaWNlKDAsIC0zKQoKICAgIH0sICRncmlkQm9keSk7CiAgICB2YXIgJGdyaWRIZWxwID0gaCgnZm9vdGVyJywgewogICAgICBzdGF0aWNDbGFzczogJ2ItY2FsZW5kYXItZ3JpZC1oZWxwIGJvcmRlci10b3Agc21hbGwgdGV4dC1tdXRlZCB0ZXh0LWNlbnRlciBiZy1saWdodCcsCiAgICAgIGF0dHJzOiB7CiAgICAgICAgaWQ6IGdyaWRIZWxwSWQKICAgICAgfQogICAgfSwgW2goJ2RpdicsIHsKICAgICAgc3RhdGljQ2xhc3M6ICdzbWFsbCcKICAgIH0sIHRoaXMubGFiZWxIZWxwKV0pOwogICAgdmFyICRncmlkID0gaCgnZGl2JywgewogICAgICBzdGF0aWNDbGFzczogJ2ItY2FsZW5kYXItZ3JpZCBmb3JtLWNvbnRyb2wgaC1hdXRvIHRleHQtY2VudGVyJywKICAgICAgYXR0cnM6IHsKICAgICAgICBpZDogZ3JpZElkLAogICAgICAgIHJvbGU6ICdhcHBsaWNhdGlvbicsCiAgICAgICAgdGFiaW5kZXg6IG5vS2V5TmF2ID8gJy0xJyA6IGRpc2FibGVkID8gbnVsbCA6ICcwJywKICAgICAgICAnZGF0YS1tb250aCc6IGFjdGl2ZVlNRC5zbGljZSgwLCAtMyksCiAgICAgICAgLy8gYFlZWVktTU1gLCBtYWlubHkgZm9yIHRlc3RpbmcKICAgICAgICAnYXJpYS1yb2xlZGVzY3JpcHRpb24nOiB0aGlzLmxhYmVsQ2FsZW5kYXIgfHwgbnVsbCwKICAgICAgICAnYXJpYS1sYWJlbGxlZGJ5JzogZ3JpZENhcHRpb25JZCwKICAgICAgICAnYXJpYS1kZXNjcmliZWRieSc6IGdyaWRIZWxwSWQsCiAgICAgICAgLy8gYGFyaWEtcmVhZG9ubHlgIGlzIG5vdCBjb25zaWRlcmVkIHZhbGlkIG9uIGByb2xlPSJhcHBsaWNhdGlvbiJgCiAgICAgICAgLy8gaHR0cHM6Ly93d3cudzMub3JnL1RSL3dhaS1hcmlhLTEuMS8jYXJpYS1yZWFkb25seQogICAgICAgIC8vICdhcmlhLXJlYWRvbmx5JzogdGhpcy5yZWFkb25seSAmJiAhZGlzYWJsZWQgPyAndHJ1ZScgOiBudWxsLAogICAgICAgICdhcmlhLWRpc2FibGVkJzogZGlzYWJsZWQgPyAndHJ1ZScgOiBudWxsLAogICAgICAgICdhcmlhLWFjdGl2ZWRlc2NlbmRhbnQnOiBhY3RpdmVJZAogICAgICB9LAogICAgICBvbjogewogICAgICAgIGtleWRvd246IHRoaXMub25LZXlkb3duR3JpZCwKICAgICAgICBmb2N1czogdGhpcy5zZXRHcmlkRm9jdXNGbGFnLAogICAgICAgIGJsdXI6IHRoaXMuc2V0R3JpZEZvY3VzRmxhZwogICAgICB9LAogICAgICByZWY6ICdncmlkJwogICAgfSwgWyRncmlkQ2FwdGlvbiwgJGdyaWRXZWVrRGF5cywgJGdyaWRCb2R5LCAkZ3JpZEhlbHBdKTsgLy8gT3B0aW9uYWwgYm90dG9tIHNsb3QKCiAgICB2YXIgJHNsb3QgPSB0aGlzLm5vcm1hbGl6ZVNsb3QoKTsKICAgICRzbG90ID0gJHNsb3QgPyBoKCdmb290ZXInLCB7CiAgICAgIHN0YXRpY0NsYXNzOiAnYi1jYWxlbmRhci1mb290ZXInCiAgICB9LCAkc2xvdCkgOiBoKCk7CiAgICB2YXIgJHdpZGdldCA9IGgoJ2RpdicsIHsKICAgICAgc3RhdGljQ2xhc3M6ICdiLWNhbGVuZGFyLWlubmVyJywKICAgICAgc3R5bGU6IHRoaXMuYmxvY2sgPyB7fSA6IHsKICAgICAgICB3aWR0aDogdGhpcy53aWR0aAogICAgICB9LAogICAgICBhdHRyczogewogICAgICAgIGlkOiB3aWRnZXRJZCwKICAgICAgICBkaXI6IGlzUlRMID8gJ3J0bCcgOiAnbHRyJywKICAgICAgICBsYW5nOiB0aGlzLmNvbXB1dGVkTG9jYWxlIHx8IG51bGwsCiAgICAgICAgcm9sZTogJ2dyb3VwJywKICAgICAgICAnYXJpYS1kaXNhYmxlZCc6IGRpc2FibGVkID8gJ3RydWUnIDogbnVsbCwKICAgICAgICAvLyBJZiBkYXRlcGlja2VyIGNvbnRyb2xzIGFuIGlucHV0LCB0aGlzIHdpbGwgc3BlY2lmeSB0aGUgSUQgb2YgdGhlIGlucHV0CiAgICAgICAgJ2FyaWEtY29udHJvbHMnOiB0aGlzLmFyaWFDb250cm9scyB8fCBudWxsLAogICAgICAgIC8vIFRoaXMgc2hvdWxkIGJlIGEgcHJvcCAoc28gaXQgY2FuIGJlIGNoYW5nZWQgdG8gRGF0ZSBwaWNrZXIsIGV0YywgbG9jYWxpemVkCiAgICAgICAgJ2FyaWEtcm9sZWRlc2NyaXB0aW9uJzogdGhpcy5yb2xlRGVzY3JpcHRpb24gfHwgbnVsbCwKICAgICAgICAnYXJpYS1kZXNjcmliZWRieSc6IFsvLyBTaG91bGQgdGhlIGF0dHIgKGlmIHByZXNlbnQpIGdvIGxhc3Q/CiAgICAgICAgLy8gT3Igc2hvdWxkIHRoaXMgYXR0ciBiZSBhIHByb3A/CiAgICAgICAgdGhpcy5idkF0dHJzWydhcmlhLWRlc2NyaWJlZGJ5J10sIHZhbHVlSWQsIGdyaWRIZWxwSWRdLmZpbHRlcihpZGVudGl0eSkuam9pbignICcpCiAgICAgIH0sCiAgICAgIG9uOiB7CiAgICAgICAga2V5ZG93bjogdGhpcy5vbktleWRvd25XcmFwcGVyCiAgICAgIH0KICAgIH0sIFskaGVhZGVyLCAkbmF2LCAkZ3JpZCwgJHNsb3RdKTsgLy8gV3JhcCBpbiBhbiBvdXRlciBkaXYgdGhhdCBjYW4gYmUgc3R5bGVkCgogICAgcmV0dXJuIGgoJ2RpdicsIHsKICAgICAgc3RhdGljQ2xhc3M6ICdiLWNhbGVuZGFyJywKICAgICAgImNsYXNzIjogewogICAgICAgICdkLWJsb2NrJzogdGhpcy5ibG9jawogICAgICB9CiAgICB9LCBbJHdpZGdldF0pOwogIH0KfSk7"},null]}