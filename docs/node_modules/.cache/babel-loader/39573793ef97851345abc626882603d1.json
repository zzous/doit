{"remainingRequest":"/Users/zzou/Downloads/backup_sample/node_modules/thread-loader/dist/cjs.js!/Users/zzou/Downloads/backup_sample/node_modules/babel-loader/lib/index.js!/Users/zzou/Downloads/backup_sample/node_modules/bootstrap-vue/esm/components/form-spinbutton/form-spinbutton.js","dependencies":[{"path":"/Users/zzou/Downloads/backup_sample/node_modules/bootstrap-vue/esm/components/form-spinbutton/form-spinbutton.js","mtime":1610263603568},{"path":"/Users/zzou/Downloads/backup_sample/node_modules/cache-loader/dist/cjs.js","mtime":1582363961748},{"path":"/Users/zzou/Downloads/backup_sample/node_modules/thread-loader/dist/cjs.js","mtime":1582363962038},{"path":"/Users/zzou/Downloads/backup_sample/node_modules/babel-loader/lib/index.js","mtime":1585275399303}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5kYXRlLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLm5hbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5udW1iZXIudG8tZml4ZWQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZGVmaW5lLXByb3BlcnRpZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZGVmaW5lLXByb3BlcnR5IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3JzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi50aW1lcnMiOwoKdmFyIF93YXRjaDsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKE9iamVjdChzb3VyY2UpLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICB9IGVsc2UgewogICAgICBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKaW1wb3J0IHsgVnVlIH0gZnJvbSAnLi4vLi4vdnVlJzsKaW1wb3J0IHsgTkFNRV9GT1JNX1NQSU5CVVRUT04gfSBmcm9tICcuLi8uLi9jb25zdGFudHMvY29tcG9uZW50cyc7CmltcG9ydCB7IEVWRU5UX05BTUVfQ0hBTkdFIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL2V2ZW50cyc7CmltcG9ydCB7IFBST1BfVFlQRV9BUlJBWV9TVFJJTkcsIFBST1BfVFlQRV9CT09MRUFOLCBQUk9QX1RZUEVfQk9PTEVBTl9OVU1CRVIsIFBST1BfVFlQRV9GVU5DVElPTiwgUFJPUF9UWVBFX05VTUJFUl9TVFJJTkcsIFBST1BfVFlQRV9TVFJJTkcgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvcHJvcHMnOwppbXBvcnQgeyBDT0RFX0RPV04sIENPREVfRU5ELCBDT0RFX0hPTUUsIENPREVfUEFHRVVQLCBDT0RFX1VQLCBDT0RFX1BBR0VET1dOIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL2tleS1jb2Rlcyc7CmltcG9ydCB7IFNMT1RfTkFNRV9ERUNSRU1FTlQsIFNMT1RfTkFNRV9JTkNSRU1FTlQgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvc2xvdHMnOwppbXBvcnQgeyBhcnJheUluY2x1ZGVzLCBjb25jYXQgfSBmcm9tICcuLi8uLi91dGlscy9hcnJheSc7CmltcG9ydCB7IGF0dGVtcHRCbHVyLCBhdHRlbXB0Rm9jdXMgfSBmcm9tICcuLi8uLi91dGlscy9kb20nOwppbXBvcnQgeyBldmVudE9uT2ZmLCBzdG9wRXZlbnQgfSBmcm9tICcuLi8uLi91dGlscy9ldmVudHMnOwppbXBvcnQgeyBpZGVudGl0eSB9IGZyb20gJy4uLy4uL3V0aWxzL2lkZW50aXR5JzsKaW1wb3J0IHsgaXNOdWxsIH0gZnJvbSAnLi4vLi4vdXRpbHMvaW5zcGVjdCc7CmltcG9ydCB7IGlzTG9jYWxlUlRMIH0gZnJvbSAnLi4vLi4vdXRpbHMvbG9jYWxlJzsKaW1wb3J0IHsgbWF0aEZsb29yLCBtYXRoTWF4LCBtYXRoUG93LCBtYXRoUm91bmQgfSBmcm9tICcuLi8uLi91dGlscy9tYXRoJzsKaW1wb3J0IHsgbWFrZU1vZGVsTWl4aW4gfSBmcm9tICcuLi8uLi91dGlscy9tb2RlbCc7CmltcG9ydCB7IHRvRmxvYXQsIHRvSW50ZWdlciB9IGZyb20gJy4uLy4uL3V0aWxzL251bWJlcic7CmltcG9ydCB7IG9taXQsIHNvcnRLZXlzIH0gZnJvbSAnLi4vLi4vdXRpbHMvb2JqZWN0JzsKaW1wb3J0IHsgaGFzUHJvcEZ1bmN0aW9uLCBtYWtlUHJvcCwgbWFrZVByb3BzQ29uZmlndXJhYmxlIH0gZnJvbSAnLi4vLi4vdXRpbHMvcHJvcHMnOwppbXBvcnQgeyB0b1N0cmluZyB9IGZyb20gJy4uLy4uL3V0aWxzL3N0cmluZyc7CmltcG9ydCB7IGF0dHJzTWl4aW4gfSBmcm9tICcuLi8uLi9taXhpbnMvYXR0cnMnOwppbXBvcnQgeyBmb3JtU2l6ZU1peGluLCBwcm9wcyBhcyBmb3JtU2l6ZVByb3BzIH0gZnJvbSAnLi4vLi4vbWl4aW5zL2Zvcm0tc2l6ZSc7CmltcG9ydCB7IGZvcm1TdGF0ZU1peGluLCBwcm9wcyBhcyBmb3JtU3RhdGVQcm9wcyB9IGZyb20gJy4uLy4uL21peGlucy9mb3JtLXN0YXRlJzsKaW1wb3J0IHsgaWRNaXhpbiwgcHJvcHMgYXMgaWRQcm9wcyB9IGZyb20gJy4uLy4uL21peGlucy9pZCc7CmltcG9ydCB7IG5vcm1hbGl6ZVNsb3RNaXhpbiB9IGZyb20gJy4uLy4uL21peGlucy9ub3JtYWxpemUtc2xvdCc7CmltcG9ydCB7IHByb3BzIGFzIGZvcm1Db250cm9sUHJvcHMgfSBmcm9tICcuLi8uLi9taXhpbnMvZm9ybS1jb250cm9sJzsKaW1wb3J0IHsgQkljb25QbHVzLCBCSWNvbkRhc2ggfSBmcm9tICcuLi8uLi9pY29ucy9pY29ucyc7IC8vIC0tLSBDb25zdGFudHMgLS0tCgp2YXIgX21ha2VNb2RlbE1peGluID0gbWFrZU1vZGVsTWl4aW4oJ3ZhbHVlJywgewogIC8vIFNob3VsZCB0aGlzIHJlYWxseSBiZSBTdHJpbmcsIHRvIG1hdGNoIG5hdGl2ZSBudW1iZXIgaW5wdXRzPwogIHR5cGU6IFBST1BfVFlQRV9CT09MRUFOX05VTUJFUgp9KSwKICAgIG1vZGVsTWl4aW4gPSBfbWFrZU1vZGVsTWl4aW4ubWl4aW4sCiAgICBtb2RlbFByb3BzID0gX21ha2VNb2RlbE1peGluLnByb3BzLAogICAgTU9ERUxfUFJPUF9OQU1FID0gX21ha2VNb2RlbE1peGluLnByb3AsCiAgICBNT0RFTF9FVkVOVF9OQU1FID0gX21ha2VNb2RlbE1peGluLmV2ZW50OyAvLyBEZWZhdWx0IGZvciBzcGluIGJ1dHRvbiByYW5nZSBhbmQgc3RlcAoKCnZhciBERUZBVUxUX01JTiA9IDE7CnZhciBERUZBVUxUX01BWCA9IDEwMDsKdmFyIERFRkFVTFRfU1RFUCA9IDE7IC8vIERlbGF5IGJlZm9yZSBhdXRvLXJlcGVhdCBpbiBtcwoKdmFyIERFRkFVTFRfUkVQRUFUX0RFTEFZID0gNTAwOyAvLyBSZXBlYXQgaW50ZXJ2YWwgaW4gbXMKCnZhciBERUZBVUxUX1JFUEVBVF9JTlRFUlZBTCA9IDEwMDsgLy8gUmVwZWF0IHJhdGUgaW5jcmVhc2VkIGFmdGVyIG51bWJlciBvZiByZXBlYXRzCgp2YXIgREVGQVVMVF9SRVBFQVRfVEhSRVNIT0xEID0gMTA7IC8vIFJlcGVhdCBzcGVlZCBtdWx0aXBsaWVyIChzdGVwIG11bHRpcGxpZXIsIG11c3QgYmUgYW4gaW50ZWdlcikKCnZhciBERUZBVUxUX1JFUEVBVF9NVUxUSVBMSUVSID0gNDsKdmFyIEtFWV9DT0RFUyA9IFtDT0RFX1VQLCBDT0RFX0RPV04sIENPREVfSE9NRSwgQ09ERV9FTkQsIENPREVfUEFHRVVQLCBDT0RFX1BBR0VET1dOXTsgLy8gLS0tIFByb3BzIC0tLQoKZXhwb3J0IHZhciBwcm9wcyA9IG1ha2VQcm9wc0NvbmZpZ3VyYWJsZShzb3J0S2V5cyhfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgaWRQcm9wcyksIG1vZGVsUHJvcHMpLCBvbWl0KGZvcm1Db250cm9sUHJvcHMsIFsncmVxdWlyZWQnLCAnYXV0b2ZvY3VzJ10pKSwgZm9ybVNpemVQcm9wcyksIGZvcm1TdGF0ZVByb3BzKSwge30sIHsKICBhcmlhQ29udHJvbHM6IG1ha2VQcm9wKFBST1BfVFlQRV9TVFJJTkcpLAogIGFyaWFMYWJlbDogbWFrZVByb3AoUFJPUF9UWVBFX1NUUklORyksCiAgZm9ybWF0dGVyRm46IG1ha2VQcm9wKFBST1BfVFlQRV9GVU5DVElPTiksCiAgaW5saW5lOiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpLAogIGxhYmVsRGVjcmVtZW50OiBtYWtlUHJvcChQUk9QX1RZUEVfU1RSSU5HLCAnRGVjcmVtZW50JyksCiAgbGFiZWxJbmNyZW1lbnQ6IG1ha2VQcm9wKFBST1BfVFlQRV9TVFJJTkcsICdJbmNyZW1lbnQnKSwKICBsb2NhbGU6IG1ha2VQcm9wKFBST1BfVFlQRV9BUlJBWV9TVFJJTkcpLAogIG1heDogbWFrZVByb3AoUFJPUF9UWVBFX05VTUJFUl9TVFJJTkcsIERFRkFVTFRfTUFYKSwKICBtaW46IG1ha2VQcm9wKFBST1BfVFlQRV9OVU1CRVJfU1RSSU5HLCBERUZBVUxUX01JTiksCiAgcGxhY2Vob2xkZXI6IG1ha2VQcm9wKFBST1BfVFlQRV9TVFJJTkcpLAogIHJlYWRvbmx5OiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpLAogIHJlcGVhdERlbGF5OiBtYWtlUHJvcChQUk9QX1RZUEVfTlVNQkVSX1NUUklORywgREVGQVVMVF9SRVBFQVRfREVMQVkpLAogIHJlcGVhdEludGVydmFsOiBtYWtlUHJvcChQUk9QX1RZUEVfTlVNQkVSX1NUUklORywgREVGQVVMVF9SRVBFQVRfSU5URVJWQUwpLAogIHJlcGVhdFN0ZXBNdWx0aXBsaWVyOiBtYWtlUHJvcChQUk9QX1RZUEVfTlVNQkVSX1NUUklORywgREVGQVVMVF9SRVBFQVRfTVVMVElQTElFUiksCiAgcmVwZWF0VGhyZXNob2xkOiBtYWtlUHJvcChQUk9QX1RZUEVfTlVNQkVSX1NUUklORywgREVGQVVMVF9SRVBFQVRfVEhSRVNIT0xEKSwKICBzdGVwOiBtYWtlUHJvcChQUk9QX1RZUEVfTlVNQkVSX1NUUklORywgREVGQVVMVF9TVEVQKSwKICB2ZXJ0aWNhbDogbWFrZVByb3AoUFJPUF9UWVBFX0JPT0xFQU4sIGZhbHNlKSwKICB3cmFwOiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpCn0pKSwgTkFNRV9GT1JNX1NQSU5CVVRUT04pOyAvLyAtLS0gTWFpbiBDb21wb25lbnQgLS0tCi8vIEB2dWUvY29tcG9uZW50CgpleHBvcnQgdmFyIEJGb3JtU3BpbmJ1dHRvbiA9IC8qI19fUFVSRV9fKi9WdWUuZXh0ZW5kKHsKICBuYW1lOiBOQU1FX0ZPUk1fU1BJTkJVVFRPTiwKICAvLyBNaXhpbiBvcmRlciBpcyBpbXBvcnRhbnQhCiAgbWl4aW5zOiBbYXR0cnNNaXhpbiwgaWRNaXhpbiwgbW9kZWxNaXhpbiwgZm9ybVNpemVNaXhpbiwgZm9ybVN0YXRlTWl4aW4sIG5vcm1hbGl6ZVNsb3RNaXhpbl0sCiAgaW5oZXJpdEF0dHJzOiBmYWxzZSwKICBwcm9wczogcHJvcHMsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxvY2FsVmFsdWU6IHRvRmxvYXQodGhpc1tNT0RFTF9QUk9QX05BTUVdLCBudWxsKSwKICAgICAgaGFzRm9jdXM6IGZhbHNlCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIHNwaW5JZDogZnVuY3Rpb24gc3BpbklkKCkgewogICAgICByZXR1cm4gdGhpcy5zYWZlSWQoKTsKICAgIH0sCiAgICBjb21wdXRlZElubGluZTogZnVuY3Rpb24gY29tcHV0ZWRJbmxpbmUoKSB7CiAgICAgIHJldHVybiB0aGlzLmlubGluZSAmJiAhdGhpcy52ZXJ0aWNhbDsKICAgIH0sCiAgICBjb21wdXRlZFJlYWRvbmx5OiBmdW5jdGlvbiBjb21wdXRlZFJlYWRvbmx5KCkgewogICAgICByZXR1cm4gdGhpcy5yZWFkb25seSAmJiAhdGhpcy5kaXNhYmxlZDsKICAgIH0sCiAgICBjb21wdXRlZFJlcXVpcmVkOiBmdW5jdGlvbiBjb21wdXRlZFJlcXVpcmVkKCkgewogICAgICByZXR1cm4gdGhpcy5yZXF1aXJlZCAmJiAhdGhpcy5jb21wdXRlZFJlYWRvbmx5ICYmICF0aGlzLmRpc2FibGVkOwogICAgfSwKICAgIGNvbXB1dGVkU3RlcDogZnVuY3Rpb24gY29tcHV0ZWRTdGVwKCkgewogICAgICByZXR1cm4gdG9GbG9hdCh0aGlzLnN0ZXAsIERFRkFVTFRfU1RFUCk7CiAgICB9LAogICAgY29tcHV0ZWRNaW46IGZ1bmN0aW9uIGNvbXB1dGVkTWluKCkgewogICAgICByZXR1cm4gdG9GbG9hdCh0aGlzLm1pbiwgREVGQVVMVF9NSU4pOwogICAgfSwKICAgIGNvbXB1dGVkTWF4OiBmdW5jdGlvbiBjb21wdXRlZE1heCgpIHsKICAgICAgLy8gV2Ugcm91bmQgZG93biB0byB0aGUgbmVhcmVzdCBtYXhpbXVtIHN0ZXAgdmFsdWUKICAgICAgdmFyIG1heCA9IHRvRmxvYXQodGhpcy5tYXgsIERFRkFVTFRfTUFYKTsKICAgICAgdmFyIHN0ZXAgPSB0aGlzLmNvbXB1dGVkU3RlcDsKICAgICAgdmFyIG1pbiA9IHRoaXMuY29tcHV0ZWRNaW47CiAgICAgIHJldHVybiBtYXRoRmxvb3IoKG1heCAtIG1pbikgLyBzdGVwKSAqIHN0ZXAgKyBtaW47CiAgICB9LAogICAgY29tcHV0ZWREZWxheTogZnVuY3Rpb24gY29tcHV0ZWREZWxheSgpIHsKICAgICAgdmFyIGRlbGF5ID0gdG9JbnRlZ2VyKHRoaXMucmVwZWF0RGVsYXksIDApOwogICAgICByZXR1cm4gZGVsYXkgPiAwID8gZGVsYXkgOiBERUZBVUxUX1JFUEVBVF9ERUxBWTsKICAgIH0sCiAgICBjb21wdXRlZEludGVydmFsOiBmdW5jdGlvbiBjb21wdXRlZEludGVydmFsKCkgewogICAgICB2YXIgaW50ZXJ2YWwgPSB0b0ludGVnZXIodGhpcy5yZXBlYXRJbnRlcnZhbCwgMCk7CiAgICAgIHJldHVybiBpbnRlcnZhbCA+IDAgPyBpbnRlcnZhbCA6IERFRkFVTFRfUkVQRUFUX0lOVEVSVkFMOwogICAgfSwKICAgIGNvbXB1dGVkVGhyZXNob2xkOiBmdW5jdGlvbiBjb21wdXRlZFRocmVzaG9sZCgpIHsKICAgICAgcmV0dXJuIG1hdGhNYXgodG9JbnRlZ2VyKHRoaXMucmVwZWF0VGhyZXNob2xkLCBERUZBVUxUX1JFUEVBVF9USFJFU0hPTEQpLCAxKTsKICAgIH0sCiAgICBjb21wdXRlZFN0ZXBNdWx0aXBsaWVyOiBmdW5jdGlvbiBjb21wdXRlZFN0ZXBNdWx0aXBsaWVyKCkgewogICAgICByZXR1cm4gbWF0aE1heCh0b0ludGVnZXIodGhpcy5yZXBlYXRTdGVwTXVsdGlwbGllciwgREVGQVVMVF9SRVBFQVRfTVVMVElQTElFUiksIDEpOwogICAgfSwKICAgIGNvbXB1dGVkUHJlY2lzaW9uOiBmdW5jdGlvbiBjb21wdXRlZFByZWNpc2lvbigpIHsKICAgICAgLy8gUXVpY2sgYW5kIGRpcnR5IHdheSB0byBnZXQgdGhlIG51bWJlciBvZiBkZWNpbWFscwogICAgICB2YXIgc3RlcCA9IHRoaXMuY29tcHV0ZWRTdGVwOwogICAgICByZXR1cm4gbWF0aEZsb29yKHN0ZXApID09PSBzdGVwID8gMCA6IChzdGVwLnRvU3RyaW5nKCkuc3BsaXQoJy4nKVsxXSB8fCAnJykubGVuZ3RoOwogICAgfSwKICAgIGNvbXB1dGVkTXVsdGlwbGllcjogZnVuY3Rpb24gY29tcHV0ZWRNdWx0aXBsaWVyKCkgewogICAgICByZXR1cm4gbWF0aFBvdygxMCwgdGhpcy5jb21wdXRlZFByZWNpc2lvbiB8fCAwKTsKICAgIH0sCiAgICB2YWx1ZUFzRml4ZWQ6IGZ1bmN0aW9uIHZhbHVlQXNGaXhlZCgpIHsKICAgICAgdmFyIHZhbHVlID0gdGhpcy5sb2NhbFZhbHVlOwogICAgICByZXR1cm4gaXNOdWxsKHZhbHVlKSA/ICcnIDogdmFsdWUudG9GaXhlZCh0aGlzLmNvbXB1dGVkUHJlY2lzaW9uKTsKICAgIH0sCiAgICBjb21wdXRlZExvY2FsZTogZnVuY3Rpb24gY29tcHV0ZWRMb2NhbGUoKSB7CiAgICAgIHZhciBsb2NhbGVzID0gY29uY2F0KHRoaXMubG9jYWxlKS5maWx0ZXIoaWRlbnRpdHkpOwogICAgICB2YXIgbmYgPSBuZXcgSW50bC5OdW1iZXJGb3JtYXQobG9jYWxlcyk7CiAgICAgIHJldHVybiBuZi5yZXNvbHZlZE9wdGlvbnMoKS5sb2NhbGU7CiAgICB9LAogICAgY29tcHV0ZWRSVEw6IGZ1bmN0aW9uIGNvbXB1dGVkUlRMKCkgewogICAgICByZXR1cm4gaXNMb2NhbGVSVEwodGhpcy5jb21wdXRlZExvY2FsZSk7CiAgICB9LAogICAgZGVmYXVsdEZvcm1hdHRlcjogZnVuY3Rpb24gZGVmYXVsdEZvcm1hdHRlcigpIHsKICAgICAgLy8gUmV0dXJucyBhbmQgYEludGwuTnVtYmVyRm9ybWF0YCBmb3JtYXR0ZXIgbWV0aG9kIHJlZmVyZW5jZQogICAgICB2YXIgcHJlY2lzaW9uID0gdGhpcy5jb21wdXRlZFByZWNpc2lvbjsKICAgICAgdmFyIG5mID0gbmV3IEludGwuTnVtYmVyRm9ybWF0KHRoaXMuY29tcHV0ZWRMb2NhbGUsIHsKICAgICAgICBzdHlsZTogJ2RlY2ltYWwnLAogICAgICAgIHVzZUdyb3VwaW5nOiBmYWxzZSwKICAgICAgICBtaW5pbXVtSW50ZWdlckRpZ2l0czogMSwKICAgICAgICBtaW5pbXVtRnJhY3Rpb25EaWdpdHM6IHByZWNpc2lvbiwKICAgICAgICBtYXhpbXVtRnJhY3Rpb25EaWdpdHM6IHByZWNpc2lvbiwKICAgICAgICBub3RhdGlvbjogJ3N0YW5kYXJkJwogICAgICB9KTsgLy8gUmV0dXJuIHRoZSBmb3JtYXQgbWV0aG9kIHJlZmVyZW5jZQoKICAgICAgcmV0dXJuIG5mLmZvcm1hdDsKICAgIH0sCiAgICBjb21wdXRlZEZvcm1hdHRlcjogZnVuY3Rpb24gY29tcHV0ZWRGb3JtYXR0ZXIoKSB7CiAgICAgIHZhciBmb3JtYXR0ZXJGbiA9IHRoaXMuZm9ybWF0dGVyRm47CiAgICAgIHJldHVybiBoYXNQcm9wRnVuY3Rpb24oZm9ybWF0dGVyRm4pID8gZm9ybWF0dGVyRm4gOiB0aGlzLmRlZmF1bHRGb3JtYXR0ZXI7CiAgICB9LAogICAgY29tcHV0ZWRBdHRyczogZnVuY3Rpb24gY29tcHV0ZWRBdHRycygpIHsKICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgdGhpcy5idkF0dHJzKSwge30sIHsKICAgICAgICByb2xlOiAnZ3JvdXAnLAogICAgICAgIGxhbmc6IHRoaXMuY29tcHV0ZWRMb2NhbGUsCiAgICAgICAgdGFiaW5kZXg6IHRoaXMuZGlzYWJsZWQgPyBudWxsIDogJy0xJywKICAgICAgICB0aXRsZTogdGhpcy5hcmlhTGFiZWwKICAgICAgfSk7CiAgICB9LAogICAgY29tcHV0ZWRTcGluQXR0cnM6IGZ1bmN0aW9uIGNvbXB1dGVkU3BpbkF0dHJzKCkgewogICAgICB2YXIgc3BpbklkID0gdGhpcy5zcGluSWQsCiAgICAgICAgICB2YWx1ZSA9IHRoaXMubG9jYWxWYWx1ZSwKICAgICAgICAgIHJlcXVpcmVkID0gdGhpcy5jb21wdXRlZFJlcXVpcmVkLAogICAgICAgICAgZGlzYWJsZWQgPSB0aGlzLmRpc2FibGVkLAogICAgICAgICAgc3RhdGUgPSB0aGlzLnN0YXRlLAogICAgICAgICAgY29tcHV0ZWRGb3JtYXR0ZXIgPSB0aGlzLmNvbXB1dGVkRm9ybWF0dGVyOwogICAgICB2YXIgaGFzVmFsdWUgPSAhaXNOdWxsKHZhbHVlKTsKICAgICAgcmV0dXJuIF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7CiAgICAgICAgZGlyOiB0aGlzLmNvbXB1dGVkUlRMID8gJ3J0bCcgOiAnbHRyJwogICAgICB9LCB0aGlzLmJ2QXR0cnMpLCB7fSwgewogICAgICAgIGlkOiBzcGluSWQsCiAgICAgICAgcm9sZTogJ3NwaW5idXR0b24nLAogICAgICAgIHRhYmluZGV4OiBkaXNhYmxlZCA/IG51bGwgOiAnMCcsCiAgICAgICAgJ2FyaWEtbGl2ZSc6ICdvZmYnLAogICAgICAgICdhcmlhLWxhYmVsJzogdGhpcy5hcmlhTGFiZWwgfHwgbnVsbCwKICAgICAgICAnYXJpYS1jb250cm9scyc6IHRoaXMuYXJpYUNvbnRyb2xzIHx8IG51bGwsCiAgICAgICAgLy8gVE9ETzogTWF5IHdhbnQgdG8gY2hlY2sgaWYgdGhlIHZhbHVlIGlzIGluIHJhbmdlCiAgICAgICAgJ2FyaWEtaW52YWxpZCc6IHN0YXRlID09PSBmYWxzZSB8fCAhaGFzVmFsdWUgJiYgcmVxdWlyZWQgPyAndHJ1ZScgOiBudWxsLAogICAgICAgICdhcmlhLXJlcXVpcmVkJzogcmVxdWlyZWQgPyAndHJ1ZScgOiBudWxsLAogICAgICAgIC8vIFRoZXNlIGF0dHJzIGFyZSByZXF1aXJlZCBmb3Igcm9sZSBzcGluYnV0dG9uCiAgICAgICAgJ2FyaWEtdmFsdWVtaW4nOiB0b1N0cmluZyh0aGlzLmNvbXB1dGVkTWluKSwKICAgICAgICAnYXJpYS12YWx1ZW1heCc6IHRvU3RyaW5nKHRoaXMuY29tcHV0ZWRNYXgpLAogICAgICAgIC8vIFRoZXNlIHNob3VsZCBiZSBgbnVsbGAgaWYgdGhlIHZhbHVlIGlzIG91dCBvZiByYW5nZQogICAgICAgIC8vIFRoZXkgbXVzdCBhbHNvIGJlIG5vbi1leGlzdGVudCBhdHRycyBpZiB0aGUgdmFsdWUgaXMgb3V0IG9mIHJhbmdlIG9yIGBudWxsYAogICAgICAgICdhcmlhLXZhbHVlbm93JzogaGFzVmFsdWUgPyB2YWx1ZSA6IG51bGwsCiAgICAgICAgJ2FyaWEtdmFsdWV0ZXh0JzogaGFzVmFsdWUgPyBjb21wdXRlZEZvcm1hdHRlcih2YWx1ZSkgOiBudWxsCiAgICAgIH0pOwogICAgfQogIH0sCiAgd2F0Y2g6IChfd2F0Y2ggPSB7fSwgX2RlZmluZVByb3BlcnR5KF93YXRjaCwgTU9ERUxfUFJPUF9OQU1FLCBmdW5jdGlvbiAodmFsdWUpIHsKICAgIHRoaXMubG9jYWxWYWx1ZSA9IHRvRmxvYXQodmFsdWUsIG51bGwpOwogIH0pLCBfZGVmaW5lUHJvcGVydHkoX3dhdGNoLCAibG9jYWxWYWx1ZSIsIGZ1bmN0aW9uIGxvY2FsVmFsdWUodmFsdWUpIHsKICAgIHRoaXMuJGVtaXQoTU9ERUxfRVZFTlRfTkFNRSwgdmFsdWUpOwogIH0pLCBfZGVmaW5lUHJvcGVydHkoX3dhdGNoLCAiZGlzYWJsZWQiLCBmdW5jdGlvbiBkaXNhYmxlZChfZGlzYWJsZWQpIHsKICAgIGlmIChfZGlzYWJsZWQpIHsKICAgICAgdGhpcy5jbGVhclJlcGVhdCgpOwogICAgfQogIH0pLCBfZGVmaW5lUHJvcGVydHkoX3dhdGNoLCAicmVhZG9ubHkiLCBmdW5jdGlvbiByZWFkb25seShfcmVhZG9ubHkpIHsKICAgIGlmIChfcmVhZG9ubHkpIHsKICAgICAgdGhpcy5jbGVhclJlcGVhdCgpOwogICAgfQogIH0pLCBfd2F0Y2gpLAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICAvLyBDcmVhdGUgbm9uIHJlYWN0aXZlIHByb3BlcnRpZXMKICAgIHRoaXMuJF9hdXRvRGVsYXlUaW1lciA9IG51bGw7CiAgICB0aGlzLiRfYXV0b1JlcGVhdFRpbWVyID0gbnVsbDsKICAgIHRoaXMuJF9rZXlJc0Rvd24gPSBmYWxzZTsKICB9LAogIGJlZm9yZURlc3Ryb3k6IGZ1bmN0aW9uIGJlZm9yZURlc3Ryb3koKSB7CiAgICB0aGlzLmNsZWFyUmVwZWF0KCk7CiAgfSwKCiAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KICBkZWFjdGl2YXRlZDogZnVuY3Rpb24gZGVhY3RpdmF0ZWQoKSB7CiAgICB0aGlzLmNsZWFyUmVwZWF0KCk7CiAgfSwKICBtZXRob2RzOiB7CiAgICAvLyAtLS0gUHVibGljIG1ldGhvZHMgLS0tCiAgICBmb2N1czogZnVuY3Rpb24gZm9jdXMoKSB7CiAgICAgIGlmICghdGhpcy5kaXNhYmxlZCkgewogICAgICAgIGF0dGVtcHRGb2N1cyh0aGlzLiRyZWZzLnNwaW5uZXIpOwogICAgICB9CiAgICB9LAogICAgYmx1cjogZnVuY3Rpb24gYmx1cigpIHsKICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKSB7CiAgICAgICAgYXR0ZW1wdEJsdXIodGhpcy4kcmVmcy5zcGlubmVyKTsKICAgICAgfQogICAgfSwKICAgIC8vIC0tLSBQcml2YXRlIG1ldGhvZHMgLS0tCiAgICBlbWl0Q2hhbmdlOiBmdW5jdGlvbiBlbWl0Q2hhbmdlKCkgewogICAgICB0aGlzLiRlbWl0KEVWRU5UX05BTUVfQ0hBTkdFLCB0aGlzLmxvY2FsVmFsdWUpOwogICAgfSwKICAgIHN0ZXBWYWx1ZTogZnVuY3Rpb24gc3RlcFZhbHVlKGRpcmVjdGlvbikgewogICAgICAvLyBTZXRzIGEgbmV3IGluY3JlbWVudGVkIG9yIGRlY3JlbWVudGVkIHZhbHVlLCBzdXBwb3J0aW5nIG9wdGlvbmFsIHdyYXBwaW5nCiAgICAgIC8vIERpcmVjdGlvbiBpcyBlaXRoZXIgKzEgb3IgLTEgKG9yIGEgbXVsdGlwbGUgdGhlcmVvZikKICAgICAgdmFyIHZhbHVlID0gdGhpcy5sb2NhbFZhbHVlOwoKICAgICAgaWYgKCF0aGlzLmRpc2FibGVkICYmICFpc051bGwodmFsdWUpKSB7CiAgICAgICAgdmFyIHN0ZXAgPSB0aGlzLmNvbXB1dGVkU3RlcCAqIGRpcmVjdGlvbjsKICAgICAgICB2YXIgbWluID0gdGhpcy5jb21wdXRlZE1pbjsKICAgICAgICB2YXIgbWF4ID0gdGhpcy5jb21wdXRlZE1heDsKICAgICAgICB2YXIgbXVsdGlwbGllciA9IHRoaXMuY29tcHV0ZWRNdWx0aXBsaWVyOwogICAgICAgIHZhciB3cmFwID0gdGhpcy53cmFwOyAvLyBXZSBlbnN1cmUgdGhhdCB0aGUgdmFsdWUgc3RlcHMgbGlrZSBhIG5hdGl2ZSBpbnB1dAoKICAgICAgICB2YWx1ZSA9IG1hdGhSb3VuZCgodmFsdWUgLSBtaW4pIC8gc3RlcCkgKiBzdGVwICsgbWluICsgc3RlcDsgLy8gV2UgZW5zdXJlIHRoYXQgcHJlY2lzaW9uIGlzIG1haW50YWluZWQgKGRlY2ltYWxzKQoKICAgICAgICB2YWx1ZSA9IG1hdGhSb3VuZCh2YWx1ZSAqIG11bHRpcGxpZXIpIC8gbXVsdGlwbGllcjsgLy8gSGFuZGxlIGlmIHdyYXBwaW5nIGlzIGVuYWJsZWQKCiAgICAgICAgdGhpcy5sb2NhbFZhbHVlID0gdmFsdWUgPiBtYXggPyB3cmFwID8gbWluIDogbWF4IDogdmFsdWUgPCBtaW4gPyB3cmFwID8gbWF4IDogbWluIDogdmFsdWU7CiAgICAgIH0KICAgIH0sCiAgICBvbkZvY3VzQmx1cjogZnVuY3Rpb24gb25Gb2N1c0JsdXIoZXZlbnQpIHsKICAgICAgaWYgKCF0aGlzLmRpc2FibGVkKSB7CiAgICAgICAgdGhpcy5oYXNGb2N1cyA9IGV2ZW50LnR5cGUgPT09ICdmb2N1cyc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5oYXNGb2N1cyA9IGZhbHNlOwogICAgICB9CiAgICB9LAogICAgc3RlcFVwOiBmdW5jdGlvbiBzdGVwVXAoKSB7CiAgICAgIHZhciBtdWx0aXBsaWVyID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAxOwogICAgICB2YXIgdmFsdWUgPSB0aGlzLmxvY2FsVmFsdWU7CgogICAgICBpZiAoaXNOdWxsKHZhbHVlKSkgewogICAgICAgIHRoaXMubG9jYWxWYWx1ZSA9IHRoaXMuY29tcHV0ZWRNaW47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zdGVwVmFsdWUoKzEgKiBtdWx0aXBsaWVyKTsKICAgICAgfQogICAgfSwKICAgIHN0ZXBEb3duOiBmdW5jdGlvbiBzdGVwRG93bigpIHsKICAgICAgdmFyIG11bHRpcGxpZXIgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IDE7CiAgICAgIHZhciB2YWx1ZSA9IHRoaXMubG9jYWxWYWx1ZTsKCiAgICAgIGlmIChpc051bGwodmFsdWUpKSB7CiAgICAgICAgdGhpcy5sb2NhbFZhbHVlID0gdGhpcy53cmFwID8gdGhpcy5jb21wdXRlZE1heCA6IHRoaXMuY29tcHV0ZWRNaW47CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zdGVwVmFsdWUoLTEgKiBtdWx0aXBsaWVyKTsKICAgICAgfQogICAgfSwKICAgIG9uS2V5ZG93bjogZnVuY3Rpb24gb25LZXlkb3duKGV2ZW50KSB7CiAgICAgIHZhciBrZXlDb2RlID0gZXZlbnQua2V5Q29kZSwKICAgICAgICAgIGFsdEtleSA9IGV2ZW50LmFsdEtleSwKICAgICAgICAgIGN0cmxLZXkgPSBldmVudC5jdHJsS2V5LAogICAgICAgICAgbWV0YUtleSA9IGV2ZW50Lm1ldGFLZXk7CiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZiAqLwoKICAgICAgaWYgKHRoaXMuZGlzYWJsZWQgfHwgdGhpcy5yZWFkb25seSB8fCBhbHRLZXkgfHwgY3RybEtleSB8fCBtZXRhS2V5KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoYXJyYXlJbmNsdWRlcyhLRVlfQ09ERVMsIGtleUNvZGUpKSB7CiAgICAgICAgLy8gaHR0cHM6Ly93M2MuZ2l0aHViLmlvL2FyaWEtcHJhY3RpY2VzLyNzcGluYnV0dG9uCiAgICAgICAgc3RvcEV2ZW50KGV2ZW50LCB7CiAgICAgICAgICBwcm9wYWdhdGlvbjogZmFsc2UKICAgICAgICB9KTsKICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KCiAgICAgICAgaWYgKHRoaXMuJF9rZXlJc0Rvd24pIHsKICAgICAgICAgIC8vIEtleXByZXNzIGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3MKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHRoaXMucmVzZXRUaW1lcnMoKTsKCiAgICAgICAgaWYgKGFycmF5SW5jbHVkZXMoW0NPREVfVVAsIENPREVfRE9XTl0sIGtleUNvZGUpKSB7CiAgICAgICAgICAvLyBUaGUgZm9sbG93aW5nIHVzZSB0aGUgY3VzdG9tIGF1dG8tcmVwZWF0IGhhbmRsaW5nCiAgICAgICAgICB0aGlzLiRfa2V5SXNEb3duID0gdHJ1ZTsKCiAgICAgICAgICBpZiAoa2V5Q29kZSA9PT0gQ09ERV9VUCkgewogICAgICAgICAgICB0aGlzLmhhbmRsZVN0ZXBSZXBlYXQoZXZlbnQsIHRoaXMuc3RlcFVwKTsKICAgICAgICAgIH0gZWxzZSBpZiAoa2V5Q29kZSA9PT0gQ09ERV9ET1dOKSB7CiAgICAgICAgICAgIHRoaXMuaGFuZGxlU3RlcFJlcGVhdChldmVudCwgdGhpcy5zdGVwRG93bik7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIFRoZXNlIHVzZSBuYXRpdmUgT1Mga2V5IHJlcGVhdGluZwogICAgICAgICAgaWYgKGtleUNvZGUgPT09IENPREVfUEFHRVVQKSB7CiAgICAgICAgICAgIHRoaXMuc3RlcFVwKHRoaXMuY29tcHV0ZWRTdGVwTXVsdGlwbGllcik7CiAgICAgICAgICB9IGVsc2UgaWYgKGtleUNvZGUgPT09IENPREVfUEFHRURPV04pIHsKICAgICAgICAgICAgdGhpcy5zdGVwRG93bih0aGlzLmNvbXB1dGVkU3RlcE11bHRpcGxpZXIpOwogICAgICAgICAgfSBlbHNlIGlmIChrZXlDb2RlID09PSBDT0RFX0hPTUUpIHsKICAgICAgICAgICAgdGhpcy5sb2NhbFZhbHVlID0gdGhpcy5jb21wdXRlZE1pbjsKICAgICAgICAgIH0gZWxzZSBpZiAoa2V5Q29kZSA9PT0gQ09ERV9FTkQpIHsKICAgICAgICAgICAgdGhpcy5sb2NhbFZhbHVlID0gdGhpcy5jb21wdXRlZE1heDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBvbktleXVwOiBmdW5jdGlvbiBvbktleXVwKGV2ZW50KSB7CiAgICAgIC8vIEVtaXQgYSBjaGFuZ2UgZXZlbnQgd2hlbiB0aGUga2V5dXAgaGFwcGVucwogICAgICB2YXIga2V5Q29kZSA9IGV2ZW50LmtleUNvZGUsCiAgICAgICAgICBhbHRLZXkgPSBldmVudC5hbHRLZXksCiAgICAgICAgICBjdHJsS2V5ID0gZXZlbnQuY3RybEtleSwKICAgICAgICAgIG1ldGFLZXkgPSBldmVudC5tZXRhS2V5OwogICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KCiAgICAgIGlmICh0aGlzLmRpc2FibGVkIHx8IHRoaXMucmVhZG9ubHkgfHwgYWx0S2V5IHx8IGN0cmxLZXkgfHwgbWV0YUtleSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKGFycmF5SW5jbHVkZXMoS0VZX0NPREVTLCBrZXlDb2RlKSkgewogICAgICAgIHN0b3BFdmVudChldmVudCwgewogICAgICAgICAgcHJvcGFnYXRpb246IGZhbHNlCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5yZXNldFRpbWVycygpOwogICAgICAgIHRoaXMuJF9rZXlJc0Rvd24gPSBmYWxzZTsKICAgICAgICB0aGlzLmVtaXRDaGFuZ2UoKTsKICAgICAgfQogICAgfSwKICAgIGhhbmRsZVN0ZXBSZXBlYXQ6IGZ1bmN0aW9uIGhhbmRsZVN0ZXBSZXBlYXQoZXZlbnQsIHN0ZXBwZXIpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciBfcmVmID0gZXZlbnQgfHwge30sCiAgICAgICAgICB0eXBlID0gX3JlZi50eXBlLAogICAgICAgICAgYnV0dG9uID0gX3JlZi5idXR0b247CgogICAgICBpZiAoIXRoaXMuZGlzYWJsZWQgJiYgIXRoaXMucmVhZG9ubHkpIHsKICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KICAgICAgICBpZiAodHlwZSA9PT0gJ21vdXNlZG93bicgJiYgYnV0dG9uKSB7CiAgICAgICAgICAvLyBXZSBvbmx5IHJlc3BvbmQgdG8gbGVmdCAobWFpbiA9PT0gMCkgYnV0dG9uIGNsaWNrcwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5yZXNldFRpbWVycygpOyAvLyBTdGVwIHRoZSBjb3VudGVyIGluaXRpYWxseQoKICAgICAgICBzdGVwcGVyKDEpOwogICAgICAgIHZhciB0aHJlc2hvbGQgPSB0aGlzLmNvbXB1dGVkVGhyZXNob2xkOwogICAgICAgIHZhciBtdWx0aXBsaWVyID0gdGhpcy5jb21wdXRlZFN0ZXBNdWx0aXBsaWVyOwogICAgICAgIHZhciBkZWxheSA9IHRoaXMuY29tcHV0ZWREZWxheTsKICAgICAgICB2YXIgaW50ZXJ2YWwgPSB0aGlzLmNvbXB1dGVkSW50ZXJ2YWw7IC8vIEluaXRpYXRlIHRoZSBkZWxheS9yZXBlYXQgaW50ZXJ2YWwKCiAgICAgICAgdGhpcy4kX2F1dG9EZWxheVRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgY291bnQgPSAwOwogICAgICAgICAgX3RoaXMuJF9hdXRvUmVwZWF0VGltZXIgPSBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIC8vIEFmdGVyIE4gaW5pdGlhbCByZXBlYXRzLCB3ZSBpbmNyZWFzZSB0aGUgaW5jcmVtZW50aW5nIHN0ZXAgYW1vdW50CiAgICAgICAgICAgIC8vIFdlIGRvIHRoaXMgdG8gbWluaW1pemUgc2NyZWVuIHJlYWRlciBhbm5vdW5jZW1lbnRzIG9mIHRoZSB2YWx1ZQogICAgICAgICAgICAvLyAodmFsdWVzIGFyZSBhbm5vdW5jZWQgZXZlcnkgY2hhbmdlLCB3aGljaCBjYW4gYmUgY2hhdHR5IGZvciBTUiB1c2VycykKICAgICAgICAgICAgLy8gQW5kIHRvIG1ha2UgaXQgZWFzZXIgdG8gc2VsZWN0IGEgdmFsdWUgd2hlbiB0aGUgcmFuZ2UgaXMgbGFyZ2UKICAgICAgICAgICAgc3RlcHBlcihjb3VudCA8IHRocmVzaG9sZCA/IDEgOiBtdWx0aXBsaWVyKTsKICAgICAgICAgICAgY291bnQrKzsKICAgICAgICAgIH0sIGludGVydmFsKTsKICAgICAgICB9LCBkZWxheSk7CiAgICAgIH0KICAgIH0sCiAgICBvbk1vdXNldXA6IGZ1bmN0aW9uIG9uTW91c2V1cChldmVudCkgewogICAgICAvLyBgPGJvZHk+YCBsaXN0ZW5lciwgb25seSBlbmFibGVkIHdoZW4gbW91c2Vkb3duIHN0YXJ0cwogICAgICB2YXIgX3JlZjIgPSBldmVudCB8fCB7fSwKICAgICAgICAgIHR5cGUgPSBfcmVmMi50eXBlLAogICAgICAgICAgYnV0dG9uID0gX3JlZjIuYnV0dG9uOwogICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi8KCgogICAgICBpZiAodHlwZSA9PT0gJ21vdXNldXAnICYmIGJ1dHRvbikgewogICAgICAgIC8vIElnbm9yZSBub24gbGVmdCBidXR0b24gKG1haW4gPT09IDApIG1vdXNlIGJ1dHRvbiBjbGljawogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgc3RvcEV2ZW50KGV2ZW50LCB7CiAgICAgICAgcHJvcGFnYXRpb246IGZhbHNlCiAgICAgIH0pOwogICAgICB0aGlzLnJlc2V0VGltZXJzKCk7CiAgICAgIHRoaXMuc2V0TW91c2V1cChmYWxzZSk7IC8vIFRyaWdnZXIgdGhlIGNoYW5nZSBldmVudAoKICAgICAgdGhpcy5lbWl0Q2hhbmdlKCk7CiAgICB9LAogICAgc2V0TW91c2V1cDogZnVuY3Rpb24gc2V0TW91c2V1cChvbikgewogICAgICAvLyBFbmFibGUgb3IgZGlzYWJsZWQgdGhlIGJvZHkgbW91c2V1cC90b3VjaGVuZCBoYW5kbGVycwogICAgICAvLyBVc2UgdHJ5L2NhdGNoIHRvIGhhbmRsZSBjYXNlIHdoZW4gY2FsbGVkIHNlcnZlciBzaWRlCiAgICAgIHRyeSB7CiAgICAgICAgZXZlbnRPbk9mZihvbiwgZG9jdW1lbnQuYm9keSwgJ21vdXNldXAnLCB0aGlzLm9uTW91c2V1cCwgZmFsc2UpOwogICAgICAgIGV2ZW50T25PZmYob24sIGRvY3VtZW50LmJvZHksICd0b3VjaGVuZCcsIHRoaXMub25Nb3VzZXVwLCBmYWxzZSk7CiAgICAgIH0gY2F0Y2ggKF91bnVzZWQpIHt9CiAgICB9LAogICAgcmVzZXRUaW1lcnM6IGZ1bmN0aW9uIHJlc2V0VGltZXJzKCkgewogICAgICBjbGVhclRpbWVvdXQodGhpcy4kX2F1dG9EZWxheVRpbWVyKTsKICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLiRfYXV0b1JlcGVhdFRpbWVyKTsKICAgICAgdGhpcy4kX2F1dG9EZWxheVRpbWVyID0gbnVsbDsKICAgICAgdGhpcy4kX2F1dG9SZXBlYXRUaW1lciA9IG51bGw7CiAgICB9LAogICAgY2xlYXJSZXBlYXQ6IGZ1bmN0aW9uIGNsZWFyUmVwZWF0KCkgewogICAgICB0aGlzLnJlc2V0VGltZXJzKCk7CiAgICAgIHRoaXMuc2V0TW91c2V1cChmYWxzZSk7CiAgICAgIHRoaXMuJF9rZXlJc0Rvd24gPSBmYWxzZTsKICAgIH0KICB9LAogIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKGgpIHsKICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgIHZhciBzcGluSWQgPSB0aGlzLnNwaW5JZCwKICAgICAgICB2YWx1ZSA9IHRoaXMubG9jYWxWYWx1ZSwKICAgICAgICBpbmxpbmUgPSB0aGlzLmNvbXB1dGVkSW5saW5lLAogICAgICAgIHJlYWRvbmx5ID0gdGhpcy5jb21wdXRlZFJlYWRvbmx5LAogICAgICAgIHZlcnRpY2FsID0gdGhpcy52ZXJ0aWNhbCwKICAgICAgICBkaXNhYmxlZCA9IHRoaXMuZGlzYWJsZWQsCiAgICAgICAgY29tcHV0ZWRGb3JtYXR0ZXIgPSB0aGlzLmNvbXB1dGVkRm9ybWF0dGVyOwogICAgdmFyIGhhc1ZhbHVlID0gIWlzTnVsbCh2YWx1ZSk7CgogICAgdmFyIG1ha2VCdXR0b24gPSBmdW5jdGlvbiBtYWtlQnV0dG9uKHN0ZXBwZXIsIGxhYmVsLCBJY29uQ21wLCBrZXlSZWYsIHNob3J0Y3V0LCBidG5EaXNhYmxlZCwgc2xvdE5hbWUpIHsKICAgICAgdmFyICRpY29uID0gaChJY29uQ21wLCB7CiAgICAgICAgcHJvcHM6IHsKICAgICAgICAgIHNjYWxlOiBfdGhpczIuaGFzRm9jdXMgPyAxLjUgOiAxLjI1CiAgICAgICAgfSwKICAgICAgICBhdHRyczogewogICAgICAgICAgJ2FyaWEtaGlkZGVuJzogJ3RydWUnCiAgICAgICAgfQogICAgICB9KTsKICAgICAgdmFyIHNjb3BlID0gewogICAgICAgIGhhc0ZvY3VzOiBfdGhpczIuaGFzRm9jdXMKICAgICAgfTsKCiAgICAgIHZhciBoYW5kbGVyID0gZnVuY3Rpb24gaGFuZGxlcihldmVudCkgewogICAgICAgIGlmICghZGlzYWJsZWQgJiYgIXJlYWRvbmx5KSB7CiAgICAgICAgICBzdG9wRXZlbnQoZXZlbnQsIHsKICAgICAgICAgICAgcHJvcGFnYXRpb246IGZhbHNlCiAgICAgICAgICB9KTsKCiAgICAgICAgICBfdGhpczIuc2V0TW91c2V1cCh0cnVlKTsgLy8gU2luY2Ugd2UgYHByZXZlbnREZWZhdWx0KClgLCB3ZSBtdXN0IG1hbnVhbGx5IGZvY3VzIHRoZSBidXR0b24KCgogICAgICAgICAgYXR0ZW1wdEZvY3VzKGV2ZW50LmN1cnJlbnRUYXJnZXQpOwoKICAgICAgICAgIF90aGlzMi5oYW5kbGVTdGVwUmVwZWF0KGV2ZW50LCBzdGVwcGVyKTsKICAgICAgICB9CiAgICAgIH07CgogICAgICByZXR1cm4gaCgnYnV0dG9uJywgewogICAgICAgIHN0YXRpY0NsYXNzOiAnYnRuIGJ0bi1zbSBib3JkZXItMCByb3VuZGVkLTAnLAogICAgICAgICJjbGFzcyI6IHsKICAgICAgICAgICdweS0wJzogIXZlcnRpY2FsCiAgICAgICAgfSwKICAgICAgICBhdHRyczogewogICAgICAgICAgdGFiaW5kZXg6ICctMScsCiAgICAgICAgICB0eXBlOiAnYnV0dG9uJywKICAgICAgICAgIGRpc2FibGVkOiBkaXNhYmxlZCB8fCByZWFkb25seSB8fCBidG5EaXNhYmxlZCwKICAgICAgICAgICdhcmlhLWRpc2FibGVkJzogZGlzYWJsZWQgfHwgcmVhZG9ubHkgfHwgYnRuRGlzYWJsZWQgPyAndHJ1ZScgOiBudWxsLAogICAgICAgICAgJ2FyaWEtY29udHJvbHMnOiBzcGluSWQsCiAgICAgICAgICAnYXJpYS1sYWJlbCc6IGxhYmVsIHx8IG51bGwsCiAgICAgICAgICAnYXJpYS1rZXlzaG9ydGN1dHMnOiBzaG9ydGN1dCB8fCBudWxsCiAgICAgICAgfSwKICAgICAgICBvbjogewogICAgICAgICAgbW91c2Vkb3duOiBoYW5kbGVyLAogICAgICAgICAgdG91Y2hzdGFydDogaGFuZGxlcgogICAgICAgIH0sCiAgICAgICAga2V5OiBrZXlSZWYgfHwgbnVsbCwKICAgICAgICByZWY6IGtleVJlZgogICAgICB9LCBbX3RoaXMyLm5vcm1hbGl6ZVNsb3Qoc2xvdE5hbWUsIHNjb3BlKSB8fCAkaWNvbl0pOwogICAgfTsgLy8gVE9ETzogQWRkIGJ1dHRvbiBkaXNhYmxlZCBzdGF0ZSB3aGVuIGB3cmFwYCBpcyBgZmFsc2VgIGFuZCBhdCB2YWx1ZSBtYXgvbWluCgoKICAgIHZhciAkaW5jcmVtZW50ID0gbWFrZUJ1dHRvbih0aGlzLnN0ZXBVcCwgdGhpcy5sYWJlbEluY3JlbWVudCwgQkljb25QbHVzLCAnaW5jJywgJ0Fycm93VXAnLCBmYWxzZSwgU0xPVF9OQU1FX0lOQ1JFTUVOVCk7CiAgICB2YXIgJGRlY3JlbWVudCA9IG1ha2VCdXR0b24odGhpcy5zdGVwRG93biwgdGhpcy5sYWJlbERlY3JlbWVudCwgQkljb25EYXNoLCAnZGVjJywgJ0Fycm93RG93bicsIGZhbHNlLCBTTE9UX05BTUVfREVDUkVNRU5UKTsKICAgIHZhciAkaGlkZGVuID0gaCgpOwoKICAgIGlmICh0aGlzLm5hbWUgJiYgIWRpc2FibGVkKSB7CiAgICAgICRoaWRkZW4gPSBoKCdpbnB1dCcsIHsKICAgICAgICBhdHRyczogewogICAgICAgICAgdHlwZTogJ2hpZGRlbicsCiAgICAgICAgICBuYW1lOiB0aGlzLm5hbWUsCiAgICAgICAgICBmb3JtOiB0aGlzLmZvcm0gfHwgbnVsbCwKICAgICAgICAgIC8vIFRPRE86IFNob3VsZCB0aGlzIGJlIHNldCB0byAnJyBpZiB2YWx1ZSBpcyBvdXQgb2YgcmFuZ2U/CiAgICAgICAgICB2YWx1ZTogdGhpcy52YWx1ZUFzRml4ZWQKICAgICAgICB9LAogICAgICAgIGtleTogJ2hpZGRlbicKICAgICAgfSk7CiAgICB9CgogICAgdmFyICRzcGluID0gaCggLy8gV2UgdXNlICdvdXRwdXQnIGVsZW1lbnQgdG8gbWFrZSB0aGlzIGFjY2VwdCBhIGA8bGFiZWwgZm9yPSJpZCI+YCAoRXhjZXB0IElFKQogICAgJ291dHB1dCcsIHsKICAgICAgc3RhdGljQ2xhc3M6ICdmbGV4LWdyb3ctMScsCiAgICAgICJjbGFzcyI6IHsKICAgICAgICAnZC1mbGV4JzogdmVydGljYWwsCiAgICAgICAgJ2FsaWduLXNlbGYtY2VudGVyJzogIXZlcnRpY2FsLAogICAgICAgICdhbGlnbi1pdGVtcy1jZW50ZXInOiB2ZXJ0aWNhbCwKICAgICAgICAnYm9yZGVyLXRvcCc6IHZlcnRpY2FsLAogICAgICAgICdib3JkZXItYm90dG9tJzogdmVydGljYWwsCiAgICAgICAgJ2JvcmRlci1sZWZ0JzogIXZlcnRpY2FsLAogICAgICAgICdib3JkZXItcmlnaHQnOiAhdmVydGljYWwKICAgICAgfSwKICAgICAgYXR0cnM6IHRoaXMuY29tcHV0ZWRTcGluQXR0cnMsCiAgICAgIGtleTogJ291dHB1dCcsCiAgICAgIHJlZjogJ3NwaW5uZXInCiAgICB9LCBbaCgnYmRpJywgaGFzVmFsdWUgPyBjb21wdXRlZEZvcm1hdHRlcih2YWx1ZSkgOiB0aGlzLnBsYWNlaG9sZGVyIHx8ICcnKV0pOwogICAgcmV0dXJuIGgoJ2RpdicsIHsKICAgICAgc3RhdGljQ2xhc3M6ICdiLWZvcm0tc3BpbmJ1dHRvbiBmb3JtLWNvbnRyb2wnLAogICAgICAiY2xhc3MiOiBbewogICAgICAgIGRpc2FibGVkOiBkaXNhYmxlZCwKICAgICAgICByZWFkb25seTogcmVhZG9ubHksCiAgICAgICAgZm9jdXM6IHRoaXMuaGFzRm9jdXMsCiAgICAgICAgJ2QtaW5saW5lLWZsZXgnOiBpbmxpbmUgfHwgdmVydGljYWwsCiAgICAgICAgJ2QtZmxleCc6ICFpbmxpbmUgJiYgIXZlcnRpY2FsLAogICAgICAgICdhbGlnbi1pdGVtcy1zdHJldGNoJzogIXZlcnRpY2FsLAogICAgICAgICdmbGV4LWNvbHVtbic6IHZlcnRpY2FsCiAgICAgIH0sIHRoaXMuc2l6ZUZvcm1DbGFzcywgdGhpcy5zdGF0ZUNsYXNzXSwKICAgICAgYXR0cnM6IHRoaXMuY29tcHV0ZWRBdHRycywKICAgICAgb246IHsKICAgICAgICBrZXlkb3duOiB0aGlzLm9uS2V5ZG93biwKICAgICAgICBrZXl1cDogdGhpcy5vbktleXVwLAogICAgICAgIC8vIFdlIHVzZSBjYXB0dXJlIHBoYXNlIChgIWAgcHJlZml4KSBzaW5jZSBmb2N1cyBhbmQgYmx1ciBkbyBub3QgYnViYmxlCiAgICAgICAgJyFmb2N1cyc6IHRoaXMub25Gb2N1c0JsdXIsCiAgICAgICAgJyFibHVyJzogdGhpcy5vbkZvY3VzQmx1cgogICAgICB9CiAgICB9LCB2ZXJ0aWNhbCA/IFskaW5jcmVtZW50LCAkaGlkZGVuLCAkc3BpbiwgJGRlY3JlbWVudF0gOiBbJGRlY3JlbWVudCwgJGhpZGRlbiwgJHNwaW4sICRpbmNyZW1lbnRdKTsKICB9Cn0pOw=="},null]}