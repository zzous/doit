{"remainingRequest":"/Users/zzou/Downloads/backup_sample/node_modules/thread-loader/dist/cjs.js!/Users/zzou/Downloads/backup_sample/node_modules/babel-loader/lib/index.js!/Users/zzou/Downloads/backup_sample/node_modules/bootstrap-vue/esm/components/carousel/carousel.js","dependencies":[{"path":"/Users/zzou/Downloads/backup_sample/node_modules/bootstrap-vue/esm/components/carousel/carousel.js","mtime":1610263603568},{"path":"/Users/zzou/Downloads/backup_sample/node_modules/cache-loader/dist/cjs.js","mtime":1582363961748},{"path":"/Users/zzou/Downloads/backup_sample/node_modules/thread-loader/dist/cjs.js","mtime":1582363962038},{"path":"/Users/zzou/Downloads/backup_sample/node_modules/babel-loader/lib/index.js","mtime":1585275399303}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5kYXRlLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmZ1bmN0aW9uLmJpbmQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZGVmaW5lLXByb3BlcnRpZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZGVmaW5lLXByb3BlcnR5IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3JzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLmV4ZWMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi50aW1lcnMiOwoKdmFyIF93YXRjaDsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKE9iamVjdChzb3VyY2UpLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICB9IGVsc2UgewogICAgICBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKaW1wb3J0IHsgVnVlIH0gZnJvbSAnLi4vLi4vdnVlJzsKaW1wb3J0IHsgTkFNRV9DQVJPVVNFTCB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9jb21wb25lbnRzJzsKaW1wb3J0IHsgSVNfQlJPV1NFUiwgSEFTX1BPSU5URVJfRVZFTlRfU1VQUE9SVCwgSEFTX1RPVUNIX1NVUFBPUlQgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvZW52JzsKaW1wb3J0IHsgRVZFTlRfTkFNRV9QQVVTRUQsIEVWRU5UX05BTUVfU0xJRElOR19FTkQsIEVWRU5UX05BTUVfU0xJRElOR19TVEFSVCwgRVZFTlRfTkFNRV9VTlBBVVNFRCwgRVZFTlRfT1BUSU9OU19OT19DQVBUVVJFIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL2V2ZW50cyc7CmltcG9ydCB7IENPREVfRU5URVIsIENPREVfTEVGVCwgQ09ERV9SSUdIVCwgQ09ERV9TUEFDRSB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9rZXktY29kZXMnOwppbXBvcnQgeyBQUk9QX1RZUEVfQk9PTEVBTiwgUFJPUF9UWVBFX05VTUJFUiwgUFJPUF9UWVBFX05VTUJFUl9TVFJJTkcsIFBST1BfVFlQRV9TVFJJTkcgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvcHJvcHMnOwppbXBvcnQgeyBhZGRDbGFzcywgZ2V0QWN0aXZlRWxlbWVudCwgcmVmbG93LCByZW1vdmVDbGFzcywgcmVxdWVzdEFGLCBzZWxlY3RBbGwsIHNldEF0dHIgfSBmcm9tICcuLi8uLi91dGlscy9kb20nOwppbXBvcnQgeyBldmVudE9uLCBldmVudE9mZiwgc3RvcEV2ZW50IH0gZnJvbSAnLi4vLi4vdXRpbHMvZXZlbnRzJzsKaW1wb3J0IHsgaXNVbmRlZmluZWQgfSBmcm9tICcuLi8uLi91dGlscy9pbnNwZWN0JzsKaW1wb3J0IHsgbWF0aEFicywgbWF0aEZsb29yLCBtYXRoTWF4LCBtYXRoTWluIH0gZnJvbSAnLi4vLi4vdXRpbHMvbWF0aCc7CmltcG9ydCB7IG1ha2VNb2RlbE1peGluIH0gZnJvbSAnLi4vLi4vdXRpbHMvbW9kZWwnOwppbXBvcnQgeyB0b0ludGVnZXIgfSBmcm9tICcuLi8uLi91dGlscy9udW1iZXInOwppbXBvcnQgeyBub29wIH0gZnJvbSAnLi4vLi4vdXRpbHMvbm9vcCc7CmltcG9ydCB7IHNvcnRLZXlzIH0gZnJvbSAnLi4vLi4vdXRpbHMvb2JqZWN0JzsKaW1wb3J0IHsgb2JzZXJ2ZURvbSB9IGZyb20gJy4uLy4uL3V0aWxzL29ic2VydmUtZG9tJzsKaW1wb3J0IHsgbWFrZVByb3AsIG1ha2VQcm9wc0NvbmZpZ3VyYWJsZSB9IGZyb20gJy4uLy4uL3V0aWxzL3Byb3BzJzsKaW1wb3J0IHsgaWRNaXhpbiwgcHJvcHMgYXMgaWRQcm9wcyB9IGZyb20gJy4uLy4uL21peGlucy9pZCc7CmltcG9ydCB7IG5vcm1hbGl6ZVNsb3RNaXhpbiB9IGZyb20gJy4uLy4uL21peGlucy9ub3JtYWxpemUtc2xvdCc7IC8vIC0tLSBDb25zdGFudHMgLS0tCgp2YXIgX21ha2VNb2RlbE1peGluID0gbWFrZU1vZGVsTWl4aW4oJ3ZhbHVlJywgewogIHR5cGU6IFBST1BfVFlQRV9OVU1CRVIsCiAgZGVmYXVsdFZhbHVlOiAwCn0pLAogICAgbW9kZWxNaXhpbiA9IF9tYWtlTW9kZWxNaXhpbi5taXhpbiwKICAgIG1vZGVsUHJvcHMgPSBfbWFrZU1vZGVsTWl4aW4ucHJvcHMsCiAgICBNT0RFTF9QUk9QX05BTUUgPSBfbWFrZU1vZGVsTWl4aW4ucHJvcCwKICAgIE1PREVMX0VWRU5UX05BTUUgPSBfbWFrZU1vZGVsTWl4aW4uZXZlbnQ7IC8vIFNsaWRlIGRpcmVjdGlvbmFsIGNsYXNzZXMKCgp2YXIgRElSRUNUSU9OID0gewogIG5leHQ6IHsKICAgIGRpckNsYXNzOiAnY2Fyb3VzZWwtaXRlbS1sZWZ0JywKICAgIG92ZXJsYXlDbGFzczogJ2Nhcm91c2VsLWl0ZW0tbmV4dCcKICB9LAogIHByZXY6IHsKICAgIGRpckNsYXNzOiAnY2Fyb3VzZWwtaXRlbS1yaWdodCcsCiAgICBvdmVybGF5Q2xhc3M6ICdjYXJvdXNlbC1pdGVtLXByZXYnCiAgfQp9OyAvLyBGYWxsYmFjayBUcmFuc2l0aW9uIGR1cmF0aW9uICh3aXRoIGEgbGl0dGxlIGJ1ZmZlcikgaW4gbXMKCnZhciBUUkFOU19EVVJBVElPTiA9IDYwMCArIDUwOyAvLyBUaW1lIGZvciBtb3VzZSBjb21wYXQgZXZlbnRzIHRvIGZpcmUgYWZ0ZXIgdG91Y2gKCnZhciBUT1VDSF9FVkVOVF9DT01QQVRfV0FJVCA9IDUwMDsgLy8gTnVtYmVyIG9mIHBpeGVscyB0byBjb25zaWRlciB0b3VjaCBtb3ZlIGEgc3dpcGUKCnZhciBTV0lQRV9USFJFU0hPTEQgPSA0MDsgLy8gUG9pbnRlckV2ZW50IHBvaW50ZXIgdHlwZXMKCnZhciBQb2ludGVyVHlwZSA9IHsKICBUT1VDSDogJ3RvdWNoJywKICBQRU46ICdwZW4nCn07IC8vIFRyYW5zaXRpb24gRXZlbnQgbmFtZXMKCnZhciBUcmFuc2l0aW9uRW5kRXZlbnRzID0gewogIFdlYmtpdFRyYW5zaXRpb246ICd3ZWJraXRUcmFuc2l0aW9uRW5kJywKICBNb3pUcmFuc2l0aW9uOiAndHJhbnNpdGlvbmVuZCcsCiAgT1RyYW5zaXRpb246ICdvdHJhbnNpdGlvbmVuZCBvVHJhbnNpdGlvbkVuZCcsCiAgdHJhbnNpdGlvbjogJ3RyYW5zaXRpb25lbmQnCn07IC8vIC0tLSBIZWxwZXIgbWV0aG9kcyAtLS0KLy8gUmV0dXJuIHRoZSBicm93c2VyIHNwZWNpZmljIHRyYW5zaXRpb25FbmQgZXZlbnQgbmFtZQoKdmFyIGdldFRyYW5zaXRpb25FbmRFdmVudCA9IGZ1bmN0aW9uIGdldFRyYW5zaXRpb25FbmRFdmVudChlbCkgewogIGZvciAodmFyIG5hbWUgaW4gVHJhbnNpdGlvbkVuZEV2ZW50cykgewogICAgaWYgKCFpc1VuZGVmaW5lZChlbC5zdHlsZVtuYW1lXSkpIHsKICAgICAgcmV0dXJuIFRyYW5zaXRpb25FbmRFdmVudHNbbmFtZV07CiAgICB9CiAgfSAvLyBGYWxsYmFjawoKICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwoKCiAgcmV0dXJuIG51bGw7Cn07IC8vIC0tLSBQcm9wcyAtLS0KCgpleHBvcnQgdmFyIHByb3BzID0gbWFrZVByb3BzQ29uZmlndXJhYmxlKHNvcnRLZXlzKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBpZFByb3BzKSwgbW9kZWxQcm9wcyksIHt9LCB7CiAgYmFja2dyb3VuZDogbWFrZVByb3AoUFJPUF9UWVBFX1NUUklORyksCiAgY29udHJvbHM6IG1ha2VQcm9wKFBST1BfVFlQRV9CT09MRUFOLCBmYWxzZSksCiAgLy8gRW5hYmxlIGNyb3NzLWZhZGUgYW5pbWF0aW9uIGluc3RlYWQgb2Ygc2xpZGUgYW5pbWF0aW9uCiAgZmFkZTogbWFrZVByb3AoUFJPUF9UWVBFX0JPT0xFQU4sIGZhbHNlKSwKICAvLyBTbmlmZmVkIGJ5IGNhcm91c2VsLXNsaWRlCiAgaW1nSGVpZ2h0OiBtYWtlUHJvcChQUk9QX1RZUEVfTlVNQkVSX1NUUklORyksCiAgLy8gU25pZmZlZCBieSBjYXJvdXNlbC1zbGlkZQogIGltZ1dpZHRoOiBtYWtlUHJvcChQUk9QX1RZUEVfTlVNQkVSX1NUUklORyksCiAgaW5kaWNhdG9yczogbWFrZVByb3AoUFJPUF9UWVBFX0JPT0xFQU4sIGZhbHNlKSwKICBpbnRlcnZhbDogbWFrZVByb3AoUFJPUF9UWVBFX05VTUJFUiwgNTAwMCksCiAgbGFiZWxHb3RvU2xpZGU6IG1ha2VQcm9wKFBST1BfVFlQRV9TVFJJTkcsICdHb3RvIHNsaWRlJyksCiAgbGFiZWxJbmRpY2F0b3JzOiBtYWtlUHJvcChQUk9QX1RZUEVfU1RSSU5HLCAnU2VsZWN0IGEgc2xpZGUgdG8gZGlzcGxheScpLAogIGxhYmVsTmV4dDogbWFrZVByb3AoUFJPUF9UWVBFX1NUUklORywgJ05leHQgc2xpZGUnKSwKICBsYWJlbFByZXY6IG1ha2VQcm9wKFBST1BfVFlQRV9TVFJJTkcsICdQcmV2aW91cyBzbGlkZScpLAogIC8vIERpc2FibGUgc2xpZGUvZmFkZSBhbmltYXRpb24KICBub0FuaW1hdGlvbjogbWFrZVByb3AoUFJPUF9UWVBFX0JPT0xFQU4sIGZhbHNlKSwKICAvLyBEaXNhYmxlIHBhdXNlIG9uIGhvdmVyCiAgbm9Ib3ZlclBhdXNlOiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpLAogIC8vIFNuaWZmZWQgYnkgY2Fyb3VzZWwtc2xpZGUKICBub1RvdWNoOiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpLAogIC8vIERpc2FibGUgd3JhcHBpbmcvbG9vcGluZyB3aGVuIHN0YXJ0L2VuZCBpcyByZWFjaGVkCiAgbm9XcmFwOiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpCn0pKSwgTkFNRV9DQVJPVVNFTCk7IC8vIC0tLSBNYWluIGNvbXBvbmVudCAtLS0KLy8gQHZ1ZS9jb21wb25lbnQKCmV4cG9ydCB2YXIgQkNhcm91c2VsID0gLyojX19QVVJFX18qL1Z1ZS5leHRlbmQoewogIG5hbWU6IE5BTUVfQ0FST1VTRUwsCiAgbWl4aW5zOiBbaWRNaXhpbiwgbW9kZWxNaXhpbiwgbm9ybWFsaXplU2xvdE1peGluXSwKICBwcm92aWRlOiBmdW5jdGlvbiBwcm92aWRlKCkgewogICAgcmV0dXJuIHsKICAgICAgYnZDYXJvdXNlbDogdGhpcwogICAgfTsKICB9LAogIHByb3BzOiBwcm9wcywKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaW5kZXg6IHRoaXNbTU9ERUxfUFJPUF9OQU1FXSB8fCAwLAogICAgICBpc1NsaWRpbmc6IGZhbHNlLAogICAgICB0cmFuc2l0aW9uRW5kRXZlbnQ6IG51bGwsCiAgICAgIHNsaWRlczogW10sCiAgICAgIGRpcmVjdGlvbjogbnVsbCwKICAgICAgaXNQYXVzZWQ6ICEodG9JbnRlZ2VyKHRoaXMuaW50ZXJ2YWwsIDApID4gMCksCiAgICAgIC8vIFRvdWNoIGV2ZW50IGhhbmRsaW5nIHZhbHVlcwogICAgICB0b3VjaFN0YXJ0WDogMCwKICAgICAgdG91Y2hEZWx0YVg6IDAKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgbnVtU2xpZGVzOiBmdW5jdGlvbiBudW1TbGlkZXMoKSB7CiAgICAgIHJldHVybiB0aGlzLnNsaWRlcy5sZW5ndGg7CiAgICB9CiAgfSwKICB3YXRjaDogKF93YXRjaCA9IHt9LCBfZGVmaW5lUHJvcGVydHkoX3dhdGNoLCBNT0RFTF9QUk9QX05BTUUsIGZ1bmN0aW9uIChuZXdWYWx1ZSwgb2xkVmFsdWUpIHsKICAgIGlmIChuZXdWYWx1ZSAhPT0gb2xkVmFsdWUpIHsKICAgICAgdGhpcy5zZXRTbGlkZSh0b0ludGVnZXIobmV3VmFsdWUsIDApKTsKICAgIH0KICB9KSwgX2RlZmluZVByb3BlcnR5KF93YXRjaCwgImludGVydmFsIiwgZnVuY3Rpb24gaW50ZXJ2YWwobmV3VmFsdWUsIG9sZFZhbHVlKSB7CiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwogICAgaWYgKG5ld1ZhbHVlID09PSBvbGRWYWx1ZSkgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKCFuZXdWYWx1ZSkgewogICAgICAvLyBQYXVzaW5nIHNsaWRlIHNob3cKICAgICAgdGhpcy5wYXVzZShmYWxzZSk7CiAgICB9IGVsc2UgewogICAgICAvLyBSZXN0YXJ0aW5nIG9yIENoYW5naW5nIGludGVydmFsCiAgICAgIHRoaXMucGF1c2UodHJ1ZSk7CiAgICAgIHRoaXMuc3RhcnQoZmFsc2UpOwogICAgfQogIH0pLCBfZGVmaW5lUHJvcGVydHkoX3dhdGNoLCAiaXNQYXVzZWQiLCBmdW5jdGlvbiBpc1BhdXNlZChuZXdWYWx1ZSwgb2xkVmFsdWUpIHsKICAgIGlmIChuZXdWYWx1ZSAhPT0gb2xkVmFsdWUpIHsKICAgICAgdGhpcy4kZW1pdChuZXdWYWx1ZSA/IEVWRU5UX05BTUVfUEFVU0VEIDogRVZFTlRfTkFNRV9VTlBBVVNFRCk7CiAgICB9CiAgfSksIF9kZWZpbmVQcm9wZXJ0eShfd2F0Y2gsICJpbmRleCIsIGZ1bmN0aW9uIGluZGV4KHRvLCBmcm9tKSB7CiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwogICAgaWYgKHRvID09PSBmcm9tIHx8IHRoaXMuaXNTbGlkaW5nKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLmRvU2xpZGUodG8sIGZyb20pOwogIH0pLCBfd2F0Y2gpLAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICAvLyBDcmVhdGUgcHJpdmF0ZSBub24tcmVhY3RpdmUgcHJvcHMKICAgIHRoaXMuJF9pbnRlcnZhbCA9IG51bGw7CiAgICB0aGlzLiRfYW5pbWF0aW9uVGltZW91dCA9IG51bGw7CiAgICB0aGlzLiRfdG91Y2hUaW1lb3V0ID0gbnVsbDsKICAgIHRoaXMuJF9vYnNlcnZlciA9IG51bGw7IC8vIFNldCBpbml0aWFsIHBhdXNlZCBzdGF0ZQoKICAgIHRoaXMuaXNQYXVzZWQgPSAhKHRvSW50ZWdlcih0aGlzLmludGVydmFsLCAwKSA+IDApOwogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIC8vIENhY2hlIGN1cnJlbnQgYnJvd3NlciB0cmFuc2l0aW9uZW5kIGV2ZW50IG5hbWUKICAgIHRoaXMudHJhbnNpdGlvbkVuZEV2ZW50ID0gZ2V0VHJhbnNpdGlvbkVuZEV2ZW50KHRoaXMuJGVsKSB8fCBudWxsOyAvLyBHZXQgYWxsIHNsaWRlcwoKICAgIHRoaXMudXBkYXRlU2xpZGVzKCk7IC8vIE9ic2VydmUgY2hpbGQgY2hhbmdlcyBzbyB3ZSBjYW4gdXBkYXRlIHNsaWRlIGxpc3QKCiAgICB0aGlzLnNldE9ic2VydmVyKHRydWUpOwogIH0sCiAgYmVmb3JlRGVzdHJveTogZnVuY3Rpb24gYmVmb3JlRGVzdHJveSgpIHsKICAgIHRoaXMuY2xlYXJJbnRlcnZhbCgpOwogICAgdGhpcy5jbGVhckFuaW1hdGlvblRpbWVvdXQoKTsKICAgIHRoaXMuY2xlYXJUb3VjaFRpbWVvdXQoKTsKICAgIHRoaXMuc2V0T2JzZXJ2ZXIoZmFsc2UpOwogIH0sCiAgbWV0aG9kczogewogICAgY2xlYXJJbnRlcnZhbDogZnVuY3Rpb24gKF9jbGVhckludGVydmFsKSB7CiAgICAgIGZ1bmN0aW9uIGNsZWFySW50ZXJ2YWwoKSB7CiAgICAgICAgcmV0dXJuIF9jbGVhckludGVydmFsLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIGNsZWFySW50ZXJ2YWwudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIF9jbGVhckludGVydmFsLnRvU3RyaW5nKCk7CiAgICAgIH07CgogICAgICByZXR1cm4gY2xlYXJJbnRlcnZhbDsKICAgIH0oZnVuY3Rpb24gKCkgewogICAgICBjbGVhckludGVydmFsKHRoaXMuJF9pbnRlcnZhbCk7CiAgICAgIHRoaXMuJF9pbnRlcnZhbCA9IG51bGw7CiAgICB9KSwKICAgIGNsZWFyQW5pbWF0aW9uVGltZW91dDogZnVuY3Rpb24gY2xlYXJBbmltYXRpb25UaW1lb3V0KCkgewogICAgICBjbGVhclRpbWVvdXQodGhpcy4kX2FuaW1hdGlvblRpbWVvdXQpOwogICAgICB0aGlzLiRfYW5pbWF0aW9uVGltZW91dCA9IG51bGw7CiAgICB9LAogICAgY2xlYXJUb3VjaFRpbWVvdXQ6IGZ1bmN0aW9uIGNsZWFyVG91Y2hUaW1lb3V0KCkgewogICAgICBjbGVhclRpbWVvdXQodGhpcy4kX3RvdWNoVGltZW91dCk7CiAgICAgIHRoaXMuJF90b3VjaFRpbWVvdXQgPSBudWxsOwogICAgfSwKICAgIHNldE9ic2VydmVyOiBmdW5jdGlvbiBzZXRPYnNlcnZlcigpIHsKICAgICAgdmFyIG9uID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiBmYWxzZTsKICAgICAgdGhpcy4kX29ic2VydmVyICYmIHRoaXMuJF9vYnNlcnZlci5kaXNjb25uZWN0KCk7CiAgICAgIHRoaXMuJF9vYnNlcnZlciA9IG51bGw7CgogICAgICBpZiAob24pIHsKICAgICAgICB0aGlzLiRfb2JzZXJ2ZXIgPSBvYnNlcnZlRG9tKHRoaXMuJHJlZnMuaW5uZXIsIHRoaXMudXBkYXRlU2xpZGVzLmJpbmQodGhpcyksIHsKICAgICAgICAgIHN1YnRyZWU6IGZhbHNlLAogICAgICAgICAgY2hpbGRMaXN0OiB0cnVlLAogICAgICAgICAgYXR0cmlidXRlczogdHJ1ZSwKICAgICAgICAgIGF0dHJpYnV0ZUZpbHRlcjogWydpZCddCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICAvLyBTZXQgc2xpZGUKICAgIHNldFNsaWRlOiBmdW5jdGlvbiBzZXRTbGlkZShzbGlkZSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgdmFyIGRpcmVjdGlvbiA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogbnVsbDsgLy8gRG9uJ3QgYW5pbWF0ZSB3aGVuIHBhZ2UgaXMgbm90IHZpc2libGUKCiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZjogZGlmZmljdWx0IHRvIHRlc3QgKi8KCiAgICAgIGlmIChJU19CUk9XU0VSICYmIGRvY3VtZW50LnZpc2liaWxpdHlTdGF0ZSAmJiBkb2N1bWVudC5oaWRkZW4pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBub1dyYXAgPSB0aGlzLm5vV3JhcDsKICAgICAgdmFyIG51bVNsaWRlcyA9IHRoaXMubnVtU2xpZGVzOyAvLyBNYWtlIHN1cmUgd2UgaGF2ZSBhbiBpbnRlZ2VyICh5b3UgbmV2ZXIga25vdyEpCgogICAgICBzbGlkZSA9IG1hdGhGbG9vcihzbGlkZSk7IC8vIERvbid0IGRvIGFueXRoaW5nIGlmIG5vdGhpbmcgdG8gc2xpZGUgdG8KCiAgICAgIGlmIChudW1TbGlkZXMgPT09IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gRG9uJ3QgY2hhbmdlIHNsaWRlIHdoaWxlIHRyYW5zaXRpb25pbmcsIHdhaXQgdW50aWwgdHJhbnNpdGlvbiBpcyBkb25lCgoKICAgICAgaWYgKHRoaXMuaXNTbGlkaW5nKSB7CiAgICAgICAgLy8gU2NoZWR1bGUgc2xpZGUgYWZ0ZXIgc2xpZGluZyBjb21wbGV0ZQogICAgICAgIHRoaXMuJG9uY2UoRVZFTlRfTkFNRV9TTElESU5HX0VORCwgZnVuY3Rpb24gKCkgewogICAgICAgICAgLy8gV3JhcCBpbiBgcmVxdWVzdEFGKClgIHRvIGFsbG93IHRoZSBzbGlkZSB0byBwcm9wZXJseSBmaW5pc2ggdG8gYXZvaWQgZ2xpdGNoaW5nCiAgICAgICAgICByZXF1ZXN0QUYoZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gX3RoaXMuc2V0U2xpZGUoc2xpZGUsIGRpcmVjdGlvbik7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuZGlyZWN0aW9uID0gZGlyZWN0aW9uOyAvLyBTZXQgbmV3IHNsaWRlIGluZGV4CiAgICAgIC8vIFdyYXAgYXJvdW5kIGlmIG5lY2Vzc2FyeSAoaWYgbm8td3JhcCBub3QgZW5hYmxlZCkKCiAgICAgIHRoaXMuaW5kZXggPSBzbGlkZSA+PSBudW1TbGlkZXMgPyBub1dyYXAgPyBudW1TbGlkZXMgLSAxIDogMCA6IHNsaWRlIDwgMCA/IG5vV3JhcCA/IDAgOiBudW1TbGlkZXMgLSAxIDogc2xpZGU7IC8vIEVuc3VyZSB0aGUgdi1tb2RlbCBpcyBzeW5jaGVkIHVwIGlmIG5vLXdyYXAgaXMgZW5hYmxlZAogICAgICAvLyBhbmQgdXNlciB0cmllZCB0byBzbGlkZSBwYXNzIGVpdGhlciBlbmRzCgogICAgICBpZiAobm9XcmFwICYmIHRoaXMuaW5kZXggIT09IHNsaWRlICYmIHRoaXMuaW5kZXggIT09IHRoaXNbTU9ERUxfUFJPUF9OQU1FXSkgewogICAgICAgIHRoaXMuJGVtaXQoTU9ERUxfRVZFTlRfTkFNRSwgdGhpcy5pbmRleCk7CiAgICAgIH0KICAgIH0sCiAgICAvLyBQcmV2aW91cyBzbGlkZQogICAgcHJldjogZnVuY3Rpb24gcHJldigpIHsKICAgICAgdGhpcy5zZXRTbGlkZSh0aGlzLmluZGV4IC0gMSwgJ3ByZXYnKTsKICAgIH0sCiAgICAvLyBOZXh0IHNsaWRlCiAgICBuZXh0OiBmdW5jdGlvbiBuZXh0KCkgewogICAgICB0aGlzLnNldFNsaWRlKHRoaXMuaW5kZXggKyAxLCAnbmV4dCcpOwogICAgfSwKICAgIC8vIFBhdXNlIGF1dG8gcm90YXRpb24KICAgIHBhdXNlOiBmdW5jdGlvbiBwYXVzZShldmVudCkgewogICAgICBpZiAoIWV2ZW50KSB7CiAgICAgICAgdGhpcy5pc1BhdXNlZCA9IHRydWU7CiAgICAgIH0KCiAgICAgIHRoaXMuY2xlYXJJbnRlcnZhbCgpOwogICAgfSwKICAgIC8vIFN0YXJ0IGF1dG8gcm90YXRlIHNsaWRlcwogICAgc3RhcnQ6IGZ1bmN0aW9uIHN0YXJ0KGV2ZW50KSB7CiAgICAgIGlmICghZXZlbnQpIHsKICAgICAgICB0aGlzLmlzUGF1c2VkID0gZmFsc2U7CiAgICAgIH0KICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IG1vc3QgbGlrZWx5IHdpbGwgbmV2ZXIgaGFwcGVuLCBidXQganVzdCBpbiBjYXNlICovCgoKICAgICAgdGhpcy5jbGVhckludGVydmFsKCk7IC8vIERvbid0IHN0YXJ0IGlmIG5vIGludGVydmFsLCBvciBsZXNzIHRoYW4gMiBzbGlkZXMKCiAgICAgIGlmICh0aGlzLmludGVydmFsICYmIHRoaXMubnVtU2xpZGVzID4gMSkgewogICAgICAgIHRoaXMuJF9pbnRlcnZhbCA9IHNldEludGVydmFsKHRoaXMubmV4dCwgbWF0aE1heCgxMDAwLCB0aGlzLmludGVydmFsKSk7CiAgICAgIH0KICAgIH0sCiAgICAvLyBSZXN0YXJ0IGF1dG8gcm90YXRlIHNsaWRlcyB3aGVuIGZvY3VzL2hvdmVyIGxlYXZlcyB0aGUgY2Fyb3VzZWwKCiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwogICAgcmVzdGFydDogZnVuY3Rpb24gcmVzdGFydCgpIHsKICAgICAgaWYgKCF0aGlzLiRlbC5jb250YWlucyhnZXRBY3RpdmVFbGVtZW50KCkpKSB7CiAgICAgICAgdGhpcy5zdGFydCgpOwogICAgICB9CiAgICB9LAogICAgZG9TbGlkZTogZnVuY3Rpb24gZG9TbGlkZSh0bywgZnJvbSkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBpc0N5Y2xpbmcgPSBCb29sZWFuKHRoaXMuaW50ZXJ2YWwpOyAvLyBEZXRlcm1pbmUgc2xpZGluZyBkaXJlY3Rpb24KCiAgICAgIHZhciBkaXJlY3Rpb24gPSB0aGlzLmNhbGNEaXJlY3Rpb24odGhpcy5kaXJlY3Rpb24sIGZyb20sIHRvKTsKICAgICAgdmFyIG92ZXJsYXlDbGFzcyA9IGRpcmVjdGlvbi5vdmVybGF5Q2xhc3M7CiAgICAgIHZhciBkaXJDbGFzcyA9IGRpcmVjdGlvbi5kaXJDbGFzczsgLy8gRGV0ZXJtaW5lIGN1cnJlbnQgYW5kIG5leHQgc2xpZGVzCgogICAgICB2YXIgY3VycmVudFNsaWRlID0gdGhpcy5zbGlkZXNbZnJvbV07CiAgICAgIHZhciBuZXh0U2xpZGUgPSB0aGlzLnNsaWRlc1t0b107IC8vIERvbid0IGRvIGFueXRoaW5nIGlmIHRoZXJlIGFyZW4ndCBhbnkgc2xpZGVzIHRvIHNsaWRlIHRvCgogICAgICBpZiAoIWN1cnJlbnRTbGlkZSB8fCAhbmV4dFNsaWRlKSB7CiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQgKi8KICAgICAgICByZXR1cm47CiAgICAgIH0gLy8gU3RhcnQgYW5pbWF0aW5nCgoKICAgICAgdGhpcy5pc1NsaWRpbmcgPSB0cnVlOwoKICAgICAgaWYgKGlzQ3ljbGluZykgewogICAgICAgIHRoaXMucGF1c2UoZmFsc2UpOwogICAgICB9CgogICAgICB0aGlzLiRlbWl0KEVWRU5UX05BTUVfU0xJRElOR19TVEFSVCwgdG8pOyAvLyBVcGRhdGUgdi1tb2RlbAoKICAgICAgdGhpcy4kZW1pdChNT0RFTF9FVkVOVF9OQU1FLCB0aGlzLmluZGV4KTsKCiAgICAgIGlmICh0aGlzLm5vQW5pbWF0aW9uKSB7CiAgICAgICAgYWRkQ2xhc3MobmV4dFNsaWRlLCAnYWN0aXZlJyk7CiAgICAgICAgcmVtb3ZlQ2xhc3MoY3VycmVudFNsaWRlLCAnYWN0aXZlJyk7CiAgICAgICAgdGhpcy5pc1NsaWRpbmcgPSBmYWxzZTsgLy8gTm90aWZ5IG91cnNlbHZlcyB0aGF0IHdlJ3JlIGRvbmUgc2xpZGluZyAoc2xpZCkKCiAgICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIF90aGlzMi4kZW1pdChFVkVOVF9OQU1FX1NMSURJTkdfRU5ELCB0byk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYWRkQ2xhc3MobmV4dFNsaWRlLCBvdmVybGF5Q2xhc3MpOyAvLyBUcmlnZ2VyIGEgcmVmbG93IG9mIG5leHQgc2xpZGUKCiAgICAgICAgcmVmbG93KG5leHRTbGlkZSk7CiAgICAgICAgYWRkQ2xhc3MoY3VycmVudFNsaWRlLCBkaXJDbGFzcyk7CiAgICAgICAgYWRkQ2xhc3MobmV4dFNsaWRlLCBkaXJDbGFzcyk7IC8vIFRyYW5zaXRpb24gRW5kIGhhbmRsZXIKCiAgICAgICAgdmFyIGNhbGxlZCA9IGZhbHNlOwogICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBkaWZmaWN1bHQgdG8gdGVzdCAqLwoKICAgICAgICB2YXIgb25jZVRyYW5zRW5kID0gZnVuY3Rpb24gb25jZVRyYW5zRW5kKCkgewogICAgICAgICAgaWYgKGNhbGxlZCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgY2FsbGVkID0gdHJ1ZTsKICAgICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZjogdHJhbnNpdGlvbiBldmVudHMgY2FudCBiZSB0ZXN0ZWQgaW4gSlNET00gKi8KCiAgICAgICAgICBpZiAoX3RoaXMyLnRyYW5zaXRpb25FbmRFdmVudCkgewogICAgICAgICAgICB2YXIgZXZlbnRzID0gX3RoaXMyLnRyYW5zaXRpb25FbmRFdmVudC5zcGxpdCgvXHMrLyk7CgogICAgICAgICAgICBldmVudHMuZm9yRWFjaChmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICAgICAgICByZXR1cm4gZXZlbnRPZmYobmV4dFNsaWRlLCBldmVudCwgb25jZVRyYW5zRW5kLCBFVkVOVF9PUFRJT05TX05PX0NBUFRVUkUpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBfdGhpczIuY2xlYXJBbmltYXRpb25UaW1lb3V0KCk7CgogICAgICAgICAgcmVtb3ZlQ2xhc3MobmV4dFNsaWRlLCBkaXJDbGFzcyk7CiAgICAgICAgICByZW1vdmVDbGFzcyhuZXh0U2xpZGUsIG92ZXJsYXlDbGFzcyk7CiAgICAgICAgICBhZGRDbGFzcyhuZXh0U2xpZGUsICdhY3RpdmUnKTsKICAgICAgICAgIHJlbW92ZUNsYXNzKGN1cnJlbnRTbGlkZSwgJ2FjdGl2ZScpOwogICAgICAgICAgcmVtb3ZlQ2xhc3MoY3VycmVudFNsaWRlLCBkaXJDbGFzcyk7CiAgICAgICAgICByZW1vdmVDbGFzcyhjdXJyZW50U2xpZGUsIG92ZXJsYXlDbGFzcyk7CiAgICAgICAgICBzZXRBdHRyKGN1cnJlbnRTbGlkZSwgJ2FyaWEtY3VycmVudCcsICdmYWxzZScpOwogICAgICAgICAgc2V0QXR0cihuZXh0U2xpZGUsICdhcmlhLWN1cnJlbnQnLCAndHJ1ZScpOwogICAgICAgICAgc2V0QXR0cihjdXJyZW50U2xpZGUsICdhcmlhLWhpZGRlbicsICd0cnVlJyk7CiAgICAgICAgICBzZXRBdHRyKG5leHRTbGlkZSwgJ2FyaWEtaGlkZGVuJywgJ2ZhbHNlJyk7CiAgICAgICAgICBfdGhpczIuaXNTbGlkaW5nID0gZmFsc2U7CiAgICAgICAgICBfdGhpczIuZGlyZWN0aW9uID0gbnVsbDsgLy8gTm90aWZ5IG91cnNlbHZlcyB0aGF0IHdlJ3JlIGRvbmUgc2xpZGluZyAoc2xpZCkKCiAgICAgICAgICBfdGhpczIuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgcmV0dXJuIF90aGlzMi4kZW1pdChFVkVOVF9OQU1FX1NMSURJTkdfRU5ELCB0byk7CiAgICAgICAgICB9KTsKICAgICAgICB9OyAvLyBTZXQgdXAgdHJhbnNpdGlvbmVuZCBoYW5kbGVyCgogICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBpZjogdHJhbnNpdGlvbiBldmVudHMgY2FudCBiZSB0ZXN0ZWQgaW4gSlNET00gKi8KCgogICAgICAgIGlmICh0aGlzLnRyYW5zaXRpb25FbmRFdmVudCkgewogICAgICAgICAgdmFyIGV2ZW50cyA9IHRoaXMudHJhbnNpdGlvbkVuZEV2ZW50LnNwbGl0KC9ccysvKTsKICAgICAgICAgIGV2ZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgICByZXR1cm4gZXZlbnRPbihuZXh0U2xpZGUsIGV2ZW50LCBvbmNlVHJhbnNFbmQsIEVWRU5UX09QVElPTlNfTk9fQ0FQVFVSRSk7CiAgICAgICAgICB9KTsKICAgICAgICB9IC8vIEZhbGxiYWNrIHRvIHNldFRpbWVvdXQoKQoKCiAgICAgICAgdGhpcy4kX2FuaW1hdGlvblRpbWVvdXQgPSBzZXRUaW1lb3V0KG9uY2VUcmFuc0VuZCwgVFJBTlNfRFVSQVRJT04pOwogICAgICB9CgogICAgICBpZiAoaXNDeWNsaW5nKSB7CiAgICAgICAgdGhpcy5zdGFydChmYWxzZSk7CiAgICAgIH0KICAgIH0sCiAgICAvLyBVcGRhdGUgc2xpZGUgbGlzdAogICAgdXBkYXRlU2xpZGVzOiBmdW5jdGlvbiB1cGRhdGVTbGlkZXMoKSB7CiAgICAgIHRoaXMucGF1c2UodHJ1ZSk7IC8vIEdldCBhbGwgc2xpZGVzIGFzIERPTSBlbGVtZW50cwoKICAgICAgdGhpcy5zbGlkZXMgPSBzZWxlY3RBbGwoJy5jYXJvdXNlbC1pdGVtJywgdGhpcy4kcmVmcy5pbm5lcik7CiAgICAgIHZhciBudW1TbGlkZXMgPSB0aGlzLnNsaWRlcy5sZW5ndGg7IC8vIEtlZXAgc2xpZGUgbnVtYmVyIGluIHJhbmdlCgogICAgICB2YXIgaW5kZXggPSBtYXRoTWF4KDAsIG1hdGhNaW4obWF0aEZsb29yKHRoaXMuaW5kZXgpLCBudW1TbGlkZXMgLSAxKSk7CiAgICAgIHRoaXMuc2xpZGVzLmZvckVhY2goZnVuY3Rpb24gKHNsaWRlLCBpZHgpIHsKICAgICAgICB2YXIgbiA9IGlkeCArIDE7CgogICAgICAgIGlmIChpZHggPT09IGluZGV4KSB7CiAgICAgICAgICBhZGRDbGFzcyhzbGlkZSwgJ2FjdGl2ZScpOwogICAgICAgICAgc2V0QXR0cihzbGlkZSwgJ2FyaWEtY3VycmVudCcsICd0cnVlJyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlbW92ZUNsYXNzKHNsaWRlLCAnYWN0aXZlJyk7CiAgICAgICAgICBzZXRBdHRyKHNsaWRlLCAnYXJpYS1jdXJyZW50JywgJ2ZhbHNlJyk7CiAgICAgICAgfQoKICAgICAgICBzZXRBdHRyKHNsaWRlLCAnYXJpYS1wb3NpbnNldCcsIFN0cmluZyhuKSk7CiAgICAgICAgc2V0QXR0cihzbGlkZSwgJ2FyaWEtc2V0c2l6ZScsIFN0cmluZyhudW1TbGlkZXMpKTsKICAgICAgfSk7IC8vIFNldCBzbGlkZSBhcyBhY3RpdmUKCiAgICAgIHRoaXMuc2V0U2xpZGUoaW5kZXgpOwogICAgICB0aGlzLnN0YXJ0KHRoaXMuaXNQYXVzZWQpOwogICAgfSwKICAgIGNhbGNEaXJlY3Rpb246IGZ1bmN0aW9uIGNhbGNEaXJlY3Rpb24oKSB7CiAgICAgIHZhciBkaXJlY3Rpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IG51bGw7CiAgICAgIHZhciBjdXJJbmRleCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogMDsKICAgICAgdmFyIG5leHRJbmRleCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogMDsKCiAgICAgIGlmICghZGlyZWN0aW9uKSB7CiAgICAgICAgcmV0dXJuIG5leHRJbmRleCA+IGN1ckluZGV4ID8gRElSRUNUSU9OLm5leHQgOiBESVJFQ1RJT04ucHJldjsKICAgICAgfQoKICAgICAgcmV0dXJuIERJUkVDVElPTltkaXJlY3Rpb25dOwogICAgfSwKICAgIGhhbmRsZUNsaWNrOiBmdW5jdGlvbiBoYW5kbGVDbGljayhldmVudCwgZm4pIHsKICAgICAgdmFyIGtleUNvZGUgPSBldmVudC5rZXlDb2RlOwoKICAgICAgaWYgKGV2ZW50LnR5cGUgPT09ICdjbGljaycgfHwga2V5Q29kZSA9PT0gQ09ERV9TUEFDRSB8fCBrZXlDb2RlID09PSBDT0RFX0VOVEVSKSB7CiAgICAgICAgc3RvcEV2ZW50KGV2ZW50KTsKICAgICAgICBmbigpOwogICAgICB9CiAgICB9LAoKICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBKU0RPTSBkb2Vzbid0IHN1cHBvcnQgdG91Y2ggZXZlbnRzICovCiAgICBoYW5kbGVTd2lwZTogZnVuY3Rpb24gaGFuZGxlU3dpcGUoKSB7CiAgICAgIHZhciBhYnNEZWx0YVggPSBtYXRoQWJzKHRoaXMudG91Y2hEZWx0YVgpOwoKICAgICAgaWYgKGFic0RlbHRhWCA8PSBTV0lQRV9USFJFU0hPTEQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBkaXJlY3Rpb24gPSBhYnNEZWx0YVggLyB0aGlzLnRvdWNoRGVsdGFYOyAvLyBSZXNldCB0b3VjaCBkZWx0YSBYCiAgICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS90d2JzL2Jvb3RzdHJhcC9wdWxsLzI4NTU4CgogICAgICB0aGlzLnRvdWNoRGVsdGFYID0gMDsKCiAgICAgIGlmIChkaXJlY3Rpb24gPiAwKSB7CiAgICAgICAgLy8gU3dpcGUgbGVmdAogICAgICAgIHRoaXMucHJldigpOwogICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA8IDApIHsKICAgICAgICAvLyBTd2lwZSByaWdodAogICAgICAgIHRoaXMubmV4dCgpOwogICAgICB9CiAgICB9LAoKICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBKU0RPTSBkb2Vzbid0IHN1cHBvcnQgdG91Y2ggZXZlbnRzICovCiAgICB0b3VjaFN0YXJ0OiBmdW5jdGlvbiB0b3VjaFN0YXJ0KGV2ZW50KSB7CiAgICAgIGlmIChIQVNfUE9JTlRFUl9FVkVOVF9TVVBQT1JUICYmIFBvaW50ZXJUeXBlW2V2ZW50LnBvaW50ZXJUeXBlLnRvVXBwZXJDYXNlKCldKSB7CiAgICAgICAgdGhpcy50b3VjaFN0YXJ0WCA9IGV2ZW50LmNsaWVudFg7CiAgICAgIH0gZWxzZSBpZiAoIUhBU19QT0lOVEVSX0VWRU5UX1NVUFBPUlQpIHsKICAgICAgICB0aGlzLnRvdWNoU3RhcnRYID0gZXZlbnQudG91Y2hlc1swXS5jbGllbnRYOwogICAgICB9CiAgICB9LAoKICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBKU0RPTSBkb2Vzbid0IHN1cHBvcnQgdG91Y2ggZXZlbnRzICovCiAgICB0b3VjaE1vdmU6IGZ1bmN0aW9uIHRvdWNoTW92ZShldmVudCkgewogICAgICAvLyBFbnN1cmUgc3dpcGluZyB3aXRoIG9uZSB0b3VjaCBhbmQgbm90IHBpbmNoaW5nCiAgICAgIGlmIChldmVudC50b3VjaGVzICYmIGV2ZW50LnRvdWNoZXMubGVuZ3RoID4gMSkgewogICAgICAgIHRoaXMudG91Y2hEZWx0YVggPSAwOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMudG91Y2hEZWx0YVggPSBldmVudC50b3VjaGVzWzBdLmNsaWVudFggLSB0aGlzLnRvdWNoU3RhcnRYOwogICAgICB9CiAgICB9LAoKICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBKU0RPTSBkb2Vzbid0IHN1cHBvcnQgdG91Y2ggZXZlbnRzICovCiAgICB0b3VjaEVuZDogZnVuY3Rpb24gdG91Y2hFbmQoZXZlbnQpIHsKICAgICAgaWYgKEhBU19QT0lOVEVSX0VWRU5UX1NVUFBPUlQgJiYgUG9pbnRlclR5cGVbZXZlbnQucG9pbnRlclR5cGUudG9VcHBlckNhc2UoKV0pIHsKICAgICAgICB0aGlzLnRvdWNoRGVsdGFYID0gZXZlbnQuY2xpZW50WCAtIHRoaXMudG91Y2hTdGFydFg7CiAgICAgIH0KCiAgICAgIHRoaXMuaGFuZGxlU3dpcGUoKTsgLy8gSWYgaXQncyBhIHRvdWNoLWVuYWJsZWQgZGV2aWNlLCBtb3VzZWVudGVyL2xlYXZlIGFyZSBmaXJlZCBhcwogICAgICAvLyBwYXJ0IG9mIHRoZSBtb3VzZSBjb21wYXRpYmlsaXR5IGV2ZW50cyBvbiBmaXJzdCB0YXAgLSB0aGUgY2Fyb3VzZWwKICAgICAgLy8gd291bGQgc3RvcCBjeWNsaW5nIHVudGlsIHVzZXIgdGFwcGVkIG91dCBvZiBpdDsKICAgICAgLy8gaGVyZSwgd2UgbGlzdGVuIGZvciB0b3VjaGVuZCwgZXhwbGljaXRseSBwYXVzZSB0aGUgY2Fyb3VzZWwKICAgICAgLy8gKGFzIGlmIGl0J3MgdGhlIHNlY29uZCB0aW1lIHdlIHRhcCBvbiBpdCwgbW91c2VlbnRlciBjb21wYXQgZXZlbnQKICAgICAgLy8gaXMgTk9UIGZpcmVkKSBhbmQgYWZ0ZXIgYSB0aW1lb3V0ICh0byBhbGxvdyBmb3IgbW91c2UgY29tcGF0aWJpbGl0eQogICAgICAvLyBldmVudHMgdG8gZmlyZSkgd2UgZXhwbGljaXRseSByZXN0YXJ0IGN5Y2xpbmcKCiAgICAgIHRoaXMucGF1c2UoZmFsc2UpOwogICAgICB0aGlzLmNsZWFyVG91Y2hUaW1lb3V0KCk7CiAgICAgIHRoaXMuJF90b3VjaFRpbWVvdXQgPSBzZXRUaW1lb3V0KHRoaXMuc3RhcnQsIFRPVUNIX0VWRU5UX0NPTVBBVF9XQUlUICsgbWF0aE1heCgxMDAwLCB0aGlzLmludGVydmFsKSk7CiAgICB9CiAgfSwKICByZW5kZXI6IGZ1bmN0aW9uIHJlbmRlcihoKSB7CiAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICB2YXIgaW5kaWNhdG9ycyA9IHRoaXMuaW5kaWNhdG9ycywKICAgICAgICBiYWNrZ3JvdW5kID0gdGhpcy5iYWNrZ3JvdW5kLAogICAgICAgIG5vQW5pbWF0aW9uID0gdGhpcy5ub0FuaW1hdGlvbiwKICAgICAgICBub0hvdmVyUGF1c2UgPSB0aGlzLm5vSG92ZXJQYXVzZSwKICAgICAgICBub1RvdWNoID0gdGhpcy5ub1RvdWNoLAogICAgICAgIGluZGV4ID0gdGhpcy5pbmRleCwKICAgICAgICBpc1NsaWRpbmcgPSB0aGlzLmlzU2xpZGluZywKICAgICAgICBwYXVzZSA9IHRoaXMucGF1c2UsCiAgICAgICAgcmVzdGFydCA9IHRoaXMucmVzdGFydCwKICAgICAgICB0b3VjaFN0YXJ0ID0gdGhpcy50b3VjaFN0YXJ0LAogICAgICAgIHRvdWNoRW5kID0gdGhpcy50b3VjaEVuZDsKICAgIHZhciBpZElubmVyID0gdGhpcy5zYWZlSWQoJ19fQlZfaW5uZXJfJyk7IC8vIFdyYXBwZXIgZm9yIHNsaWRlcwoKICAgIHZhciAkaW5uZXIgPSBoKCdkaXYnLCB7CiAgICAgIHN0YXRpY0NsYXNzOiAnY2Fyb3VzZWwtaW5uZXInLAogICAgICBhdHRyczogewogICAgICAgIGlkOiBpZElubmVyLAogICAgICAgIHJvbGU6ICdsaXN0JwogICAgICB9LAogICAgICByZWY6ICdpbm5lcicKICAgIH0sIFt0aGlzLm5vcm1hbGl6ZVNsb3QoKV0pOyAvLyBQcmV2IGFuZCBuZXh0IGNvbnRyb2xzCgogICAgdmFyICRjb250cm9scyA9IGgoKTsKCiAgICBpZiAodGhpcy5jb250cm9scykgewogICAgICB2YXIgbWFrZUNvbnRyb2wgPSBmdW5jdGlvbiBtYWtlQ29udHJvbChkaXJlY3Rpb24sIGxhYmVsLCBoYW5kbGVyKSB7CiAgICAgICAgdmFyIGhhbmRsZXJXcmFwcGVyID0gZnVuY3Rpb24gaGFuZGxlcldyYXBwZXIoZXZlbnQpIHsKICAgICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgICAgICAgICBpZiAoIWlzU2xpZGluZykgewogICAgICAgICAgICBfdGhpczMuaGFuZGxlQ2xpY2soZXZlbnQsIGhhbmRsZXIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3RvcEV2ZW50KGV2ZW50LCB7CiAgICAgICAgICAgICAgcHJvcGFnYXRpb246IGZhbHNlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH07CgogICAgICAgIHJldHVybiBoKCdhJywgewogICAgICAgICAgc3RhdGljQ2xhc3M6ICJjYXJvdXNlbC1jb250cm9sLSIuY29uY2F0KGRpcmVjdGlvbiksCiAgICAgICAgICBhdHRyczogewogICAgICAgICAgICBocmVmOiAnIycsCiAgICAgICAgICAgIHJvbGU6ICdidXR0b24nLAogICAgICAgICAgICAnYXJpYS1jb250cm9scyc6IGlkSW5uZXIsCiAgICAgICAgICAgICdhcmlhLWRpc2FibGVkJzogaXNTbGlkaW5nID8gJ3RydWUnIDogbnVsbAogICAgICAgICAgfSwKICAgICAgICAgIG9uOiB7CiAgICAgICAgICAgIGNsaWNrOiBoYW5kbGVyV3JhcHBlciwKICAgICAgICAgICAga2V5ZG93bjogaGFuZGxlcldyYXBwZXIKICAgICAgICAgIH0KICAgICAgICB9LCBbaCgnc3BhbicsIHsKICAgICAgICAgIHN0YXRpY0NsYXNzOiAiY2Fyb3VzZWwtY29udHJvbC0iLmNvbmNhdChkaXJlY3Rpb24sICItaWNvbiIpLAogICAgICAgICAgYXR0cnM6IHsKICAgICAgICAgICAgJ2FyaWEtaGlkZGVuJzogJ3RydWUnCiAgICAgICAgICB9CiAgICAgICAgfSksIGgoJ3NwYW4nLCB7CiAgICAgICAgICAiY2xhc3MiOiAnc3Itb25seScKICAgICAgICB9LCBbbGFiZWxdKV0pOwogICAgICB9OwoKICAgICAgJGNvbnRyb2xzID0gW21ha2VDb250cm9sKCdwcmV2JywgdGhpcy5sYWJlbFByZXYsIHRoaXMucHJldiksIG1ha2VDb250cm9sKCduZXh0JywgdGhpcy5sYWJlbE5leHQsIHRoaXMubmV4dCldOwogICAgfSAvLyBJbmRpY2F0b3JzCgoKICAgIHZhciAkaW5kaWNhdG9ycyA9IGgoJ29sJywgewogICAgICBzdGF0aWNDbGFzczogJ2Nhcm91c2VsLWluZGljYXRvcnMnLAogICAgICBkaXJlY3RpdmVzOiBbewogICAgICAgIG5hbWU6ICdzaG93JywKICAgICAgICB2YWx1ZTogaW5kaWNhdG9ycwogICAgICB9XSwKICAgICAgYXR0cnM6IHsKICAgICAgICBpZDogdGhpcy5zYWZlSWQoJ19fQlZfaW5kaWNhdG9yc18nKSwKICAgICAgICAnYXJpYS1oaWRkZW4nOiBpbmRpY2F0b3JzID8gJ2ZhbHNlJyA6ICd0cnVlJywKICAgICAgICAnYXJpYS1sYWJlbCc6IHRoaXMubGFiZWxJbmRpY2F0b3JzLAogICAgICAgICdhcmlhLW93bnMnOiBpZElubmVyCiAgICAgIH0KICAgIH0sIHRoaXMuc2xpZGVzLm1hcChmdW5jdGlvbiAoc2xpZGUsIGkpIHsKICAgICAgdmFyIGhhbmRsZXIgPSBmdW5jdGlvbiBoYW5kbGVyKGV2ZW50KSB7CiAgICAgICAgX3RoaXMzLmhhbmRsZUNsaWNrKGV2ZW50LCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczMuc2V0U2xpZGUoaSk7CiAgICAgICAgfSk7CiAgICAgIH07CgogICAgICByZXR1cm4gaCgnbGknLCB7CiAgICAgICAgImNsYXNzIjogewogICAgICAgICAgYWN0aXZlOiBpID09PSBpbmRleAogICAgICAgIH0sCiAgICAgICAgYXR0cnM6IHsKICAgICAgICAgIHJvbGU6ICdidXR0b24nLAogICAgICAgICAgaWQ6IF90aGlzMy5zYWZlSWQoIl9fQlZfaW5kaWNhdG9yXyIuY29uY2F0KGkgKyAxLCAiXyIpKSwKICAgICAgICAgIHRhYmluZGV4OiBpbmRpY2F0b3JzID8gJzAnIDogJy0xJywKICAgICAgICAgICdhcmlhLWN1cnJlbnQnOiBpID09PSBpbmRleCA/ICd0cnVlJyA6ICdmYWxzZScsCiAgICAgICAgICAnYXJpYS1sYWJlbCc6ICIiLmNvbmNhdChfdGhpczMubGFiZWxHb3RvU2xpZGUsICIgIikuY29uY2F0KGkgKyAxKSwKICAgICAgICAgICdhcmlhLWRlc2NyaWJlZGJ5Jzogc2xpZGUuaWQgfHwgbnVsbCwKICAgICAgICAgICdhcmlhLWNvbnRyb2xzJzogaWRJbm5lcgogICAgICAgIH0sCiAgICAgICAgb246IHsKICAgICAgICAgIGNsaWNrOiBoYW5kbGVyLAogICAgICAgICAga2V5ZG93bjogaGFuZGxlcgogICAgICAgIH0sCiAgICAgICAga2V5OiAic2xpZGVfIi5jb25jYXQoaSkKICAgICAgfSk7CiAgICB9KSk7CiAgICB2YXIgb24gPSB7CiAgICAgIG1vdXNlZW50ZXI6IG5vSG92ZXJQYXVzZSA/IG5vb3AgOiBwYXVzZSwKICAgICAgbW91c2VsZWF2ZTogbm9Ib3ZlclBhdXNlID8gbm9vcCA6IHJlc3RhcnQsCiAgICAgIGZvY3VzaW46IHBhdXNlLAogICAgICBmb2N1c291dDogcmVzdGFydCwKICAgICAga2V5ZG93bjogZnVuY3Rpb24ga2V5ZG93bihldmVudCkgewogICAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovCiAgICAgICAgaWYgKC9pbnB1dHx0ZXh0YXJlYS9pLnRlc3QoZXZlbnQudGFyZ2V0LnRhZ05hbWUpKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YXIga2V5Q29kZSA9IGV2ZW50LmtleUNvZGU7CgogICAgICAgIGlmIChrZXlDb2RlID09PSBDT0RFX0xFRlQgfHwga2V5Q29kZSA9PT0gQ09ERV9SSUdIVCkgewogICAgICAgICAgc3RvcEV2ZW50KGV2ZW50KTsKCiAgICAgICAgICBfdGhpczNba2V5Q29kZSA9PT0gQ09ERV9MRUZUID8gJ3ByZXYnIDogJ25leHQnXSgpOwogICAgICAgIH0KICAgICAgfQogICAgfTsgLy8gVG91Y2ggc3VwcG9ydCBldmVudCBoYW5kbGVycyBmb3IgZW52aXJvbm1lbnQKCiAgICBpZiAoSEFTX1RPVUNIX1NVUFBPUlQgJiYgIW5vVG91Y2gpIHsKICAgICAgLy8gQXR0YWNoIGFwcHJvcHJpYXRlIGxpc3RlbmVycyAocHJlcGVuZCBldmVudCBuYW1lIHdpdGggJyYnIGZvciBwYXNzaXZlIG1vZGUpCgogICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dDogSlNET00gZG9lc24ndCBzdXBwb3J0IHRvdWNoIGV2ZW50cyAqLwogICAgICBpZiAoSEFTX1BPSU5URVJfRVZFTlRfU1VQUE9SVCkgewogICAgICAgIG9uWycmcG9pbnRlcmRvd24nXSA9IHRvdWNoU3RhcnQ7CiAgICAgICAgb25bJyZwb2ludGVydXAnXSA9IHRvdWNoRW5kOwogICAgICB9IGVsc2UgewogICAgICAgIG9uWycmdG91Y2hzdGFydCddID0gdG91Y2hTdGFydDsKICAgICAgICBvblsnJnRvdWNobW92ZSddID0gdGhpcy50b3VjaE1vdmU7CiAgICAgICAgb25bJyZ0b3VjaGVuZCddID0gdG91Y2hFbmQ7CiAgICAgIH0KICAgIH0gLy8gUmV0dXJuIHRoZSBjYXJvdXNlbAoKCiAgICByZXR1cm4gaCgnZGl2JywgewogICAgICBzdGF0aWNDbGFzczogJ2Nhcm91c2VsJywKICAgICAgImNsYXNzIjogewogICAgICAgIHNsaWRlOiAhbm9BbmltYXRpb24sCiAgICAgICAgJ2Nhcm91c2VsLWZhZGUnOiAhbm9BbmltYXRpb24gJiYgdGhpcy5mYWRlLAogICAgICAgICdwb2ludGVyLWV2ZW50JzogSEFTX1RPVUNIX1NVUFBPUlQgJiYgSEFTX1BPSU5URVJfRVZFTlRfU1VQUE9SVCAmJiAhbm9Ub3VjaAogICAgICB9LAogICAgICBzdHlsZTogewogICAgICAgIGJhY2tncm91bmQ6IGJhY2tncm91bmQKICAgICAgfSwKICAgICAgYXR0cnM6IHsKICAgICAgICByb2xlOiAncmVnaW9uJywKICAgICAgICBpZDogdGhpcy5zYWZlSWQoKSwKICAgICAgICAnYXJpYS1idXN5JzogaXNTbGlkaW5nID8gJ3RydWUnIDogJ2ZhbHNlJwogICAgICB9LAogICAgICBvbjogb24KICAgIH0sIFskaW5uZXIsICRjb250cm9scywgJGluZGljYXRvcnNdKTsKICB9Cn0pOw=="},null]}