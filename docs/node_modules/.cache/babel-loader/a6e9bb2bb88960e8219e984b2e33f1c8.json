{"remainingRequest":"/Users/zzou/Downloads/backup_sample/node_modules/thread-loader/dist/cjs.js!/Users/zzou/Downloads/backup_sample/node_modules/babel-loader/lib/index.js!/Users/zzou/Downloads/backup_sample/node_modules/bootstrap-vue/esm/components/form-file/form-file.js","dependencies":[{"path":"/Users/zzou/Downloads/backup_sample/node_modules/bootstrap-vue/esm/components/form-file/form-file.js","mtime":1610263603568},{"path":"/Users/zzou/Downloads/backup_sample/node_modules/cache-loader/dist/cjs.js","mtime":1582363961748},{"path":"/Users/zzou/Downloads/backup_sample/node_modules/thread-loader/dist/cjs.js","mtime":1582363962038},{"path":"/Users/zzou/Downloads/backup_sample/node_modules/babel-loader/lib/index.js","mtime":1585275399303}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZXZlcnkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zbGljZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnNvbWUiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmRlZmluZS1wcm9wZXJ0aWVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9ycyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5jb25zdHJ1Y3RvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy50cmltIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwoKdmFyIF93YXRjaDsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgewogIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsKCiAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsKICAgIHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOwogICAgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgewogICAgICByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsKICAgIH0pOwogICAga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOwogIH0KCiAgcmV0dXJuIGtleXM7Cn0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7CiAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsKICAgIHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OwoKICAgIGlmIChpICUgMikgewogICAgICBvd25LZXlzKE9iamVjdChzb3VyY2UpLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsKICAgICAgfSk7CiAgICB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7CiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7CiAgICB9IGVsc2UgewogICAgICBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsKICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsKICAgICAgfSk7CiAgICB9CiAgfQoKICByZXR1cm4gdGFyZ2V0Owp9CgpmdW5jdGlvbiBfZGVmaW5lUHJvcGVydHkob2JqLCBrZXksIHZhbHVlKSB7CiAgaWYgKGtleSBpbiBvYmopIHsKICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShvYmosIGtleSwgewogICAgICB2YWx1ZTogdmFsdWUsCiAgICAgIGVudW1lcmFibGU6IHRydWUsCiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSwKICAgICAgd3JpdGFibGU6IHRydWUKICAgIH0pOwogIH0gZWxzZSB7CiAgICBvYmpba2V5XSA9IHZhbHVlOwogIH0KCiAgcmV0dXJuIG9iajsKfQoKaW1wb3J0IHsgVnVlIH0gZnJvbSAnLi4vLi4vdnVlJzsKaW1wb3J0IHsgTkFNRV9GT1JNX0ZJTEUgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvY29tcG9uZW50cyc7CmltcG9ydCB7IEhBU19QUk9NSVNFX1NVUFBPUlQgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvZW52JzsKaW1wb3J0IHsgRVZFTlRfTkFNRV9DSEFOR0UsIEVWRU5UX09QVElPTlNfUEFTU0lWRSB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9ldmVudHMnOwppbXBvcnQgeyBQUk9QX1RZUEVfQVJSQVksIFBST1BfVFlQRV9CT09MRUFOLCBQUk9QX1RZUEVfRlVOQ1RJT04sIFBST1BfVFlQRV9TVFJJTkcgfSBmcm9tICcuLi8uLi9jb25zdGFudHMvcHJvcHMnOwppbXBvcnQgeyBTTE9UX05BTUVfRFJPUF9QTEFDRUhPTERFUiwgU0xPVF9OQU1FX0ZJTEVfTkFNRSwgU0xPVF9OQU1FX1BMQUNFSE9MREVSIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL3Nsb3RzJzsKaW1wb3J0IHsgUlhfRVhURU5TSU9OLCBSWF9TVEFSIH0gZnJvbSAnLi4vLi4vY29uc3RhbnRzL3JlZ2V4JzsKaW1wb3J0IHsgRmlsZSB9IGZyb20gJy4uLy4uL2NvbnN0YW50cy9zYWZlLXR5cGVzJzsKaW1wb3J0IHsgZnJvbSBhcyBhcnJheUZyb20sIGZsYXR0ZW4sIGZsYXR0ZW5EZWVwIH0gZnJvbSAnLi4vLi4vdXRpbHMvYXJyYXknOwppbXBvcnQgeyBjbG9uZURlZXAgfSBmcm9tICcuLi8uLi91dGlscy9jbG9uZS1kZWVwJzsKaW1wb3J0IHsgY2xvc2VzdCB9IGZyb20gJy4uLy4uL3V0aWxzL2RvbSc7CmltcG9ydCB7IGV2ZW50T24sIGV2ZW50T2ZmLCBzdG9wRXZlbnQgfSBmcm9tICcuLi8uLi91dGlscy9ldmVudHMnOwppbXBvcnQgeyBpZGVudGl0eSB9IGZyb20gJy4uLy4uL3V0aWxzL2lkZW50aXR5JzsKaW1wb3J0IHsgaXNBcnJheSwgaXNGaWxlLCBpc0Z1bmN0aW9uLCBpc051bGwsIGlzVW5kZWZpbmVkT3JOdWxsIH0gZnJvbSAnLi4vLi4vdXRpbHMvaW5zcGVjdCc7CmltcG9ydCB7IGxvb3NlRXF1YWwgfSBmcm9tICcuLi8uLi91dGlscy9sb29zZS1lcXVhbCc7CmltcG9ydCB7IG1ha2VNb2RlbE1peGluIH0gZnJvbSAnLi4vLi4vdXRpbHMvbW9kZWwnOwppbXBvcnQgeyBzb3J0S2V5cyB9IGZyb20gJy4uLy4uL3V0aWxzL29iamVjdCc7CmltcG9ydCB7IGhhc1Byb3BGdW5jdGlvbiwgbWFrZVByb3AsIG1ha2VQcm9wc0NvbmZpZ3VyYWJsZSB9IGZyb20gJy4uLy4uL3V0aWxzL3Byb3BzJzsKaW1wb3J0IHsgZXNjYXBlUmVnRXhwIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3RyaW5nJzsKaW1wb3J0IHsgd2FybiB9IGZyb20gJy4uLy4uL3V0aWxzL3dhcm4nOwppbXBvcnQgeyBhdHRyc01peGluIH0gZnJvbSAnLi4vLi4vbWl4aW5zL2F0dHJzJzsKaW1wb3J0IHsgZm9ybUNvbnRyb2xNaXhpbiwgcHJvcHMgYXMgZm9ybUNvbnRyb2xQcm9wcyB9IGZyb20gJy4uLy4uL21peGlucy9mb3JtLWNvbnRyb2wnOwppbXBvcnQgeyBmb3JtQ3VzdG9tTWl4aW4sIHByb3BzIGFzIGZvcm1DdXN0b21Qcm9wcyB9IGZyb20gJy4uLy4uL21peGlucy9mb3JtLWN1c3RvbSc7CmltcG9ydCB7IGZvcm1TdGF0ZU1peGluLCBwcm9wcyBhcyBmb3JtU3RhdGVQcm9wcyB9IGZyb20gJy4uLy4uL21peGlucy9mb3JtLXN0YXRlJzsKaW1wb3J0IHsgaWRNaXhpbiwgcHJvcHMgYXMgaWRQcm9wcyB9IGZyb20gJy4uLy4uL21peGlucy9pZCc7CmltcG9ydCB7IG5vcm1hbGl6ZVNsb3RNaXhpbiB9IGZyb20gJy4uLy4uL21peGlucy9ub3JtYWxpemUtc2xvdCc7CmltcG9ydCB7IHByb3BzIGFzIGZvcm1TaXplUHJvcHMgfSBmcm9tICcuLi8uLi9taXhpbnMvZm9ybS1zaXplJzsgLy8gLS0tIENvbnN0YW50cyAtLS0KCnZhciBfbWFrZU1vZGVsTWl4aW4gPSBtYWtlTW9kZWxNaXhpbigndmFsdWUnLCB7CiAgdHlwZTogW1BST1BfVFlQRV9BUlJBWSwgRmlsZV0sCiAgZGVmYXVsdFZhbHVlOiBudWxsLAogIHZhbGlkYXRvcjogZnVuY3Rpb24gdmFsaWRhdG9yKHZhbHVlKSB7CiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqLwogICAgaWYgKHZhbHVlID09PSAnJykgewogICAgICB3YXJuKFZBTFVFX0VNUFRZX0RFUFJFQ0FURURfTVNHLCBOQU1FX0ZPUk1fRklMRSk7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQoKICAgIHJldHVybiBpc1VuZGVmaW5lZE9yTnVsbCh2YWx1ZSkgfHwgaXNWYWxpZFZhbHVlKHZhbHVlKTsKICB9Cn0pLAogICAgbW9kZWxNaXhpbiA9IF9tYWtlTW9kZWxNaXhpbi5taXhpbiwKICAgIG1vZGVsUHJvcHMgPSBfbWFrZU1vZGVsTWl4aW4ucHJvcHMsCiAgICBNT0RFTF9QUk9QX05BTUUgPSBfbWFrZU1vZGVsTWl4aW4ucHJvcCwKICAgIE1PREVMX0VWRU5UX05BTUUgPSBfbWFrZU1vZGVsTWl4aW4uZXZlbnQ7Cgp2YXIgVkFMVUVfRU1QVFlfREVQUkVDQVRFRF9NU0cgPSAnU2V0dGluZyAidmFsdWUiLyJ2LW1vZGVsIiB0byBhbiBlbXB0eSBzdHJpbmcgZm9yIHJlc2V0IGlzIGRlcHJlY2F0ZWQuIFNldCB0byAibnVsbCIgaW5zdGVhZC4nOyAvLyAtLS0gSGVscGVyIG1ldGhvZHMgLS0tCgp2YXIgaXNWYWxpZFZhbHVlID0gZnVuY3Rpb24gaXNWYWxpZFZhbHVlKHZhbHVlKSB7CiAgcmV0dXJuIGlzRmlsZSh2YWx1ZSkgfHwgaXNBcnJheSh2YWx1ZSkgJiYgdmFsdWUuZXZlcnkoZnVuY3Rpb24gKHYpIHsKICAgIHJldHVybiBpc1ZhbGlkVmFsdWUodik7CiAgfSk7Cn07IC8vIEhlbHBlciBtZXRob2QgdG8gInNhZmVseSIgZ2V0IHRoZSBlbnRyeSBmcm9tIGEgZGF0YS10cmFuc2ZlciBpdGVtCgovKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dDogbm90IHN1cHBvcnRlZCBpbiBKU0RPTSAqLwoKCnZhciBnZXREYXRhVHJhbnNmZXJJdGVtRW50cnkgPSBmdW5jdGlvbiBnZXREYXRhVHJhbnNmZXJJdGVtRW50cnkoaXRlbSkgewogIHJldHVybiBpc0Z1bmN0aW9uKGl0ZW0uZ2V0QXNFbnRyeSkgPyBpdGVtLmdldEFzRW50cnkoKSA6IGlzRnVuY3Rpb24oaXRlbS53ZWJraXRHZXRBc0VudHJ5KSA/IGl0ZW0ud2Via2l0R2V0QXNFbnRyeSgpIDogbnVsbDsKfTsgLy8gRHJvcCBoYW5kbGVyIGZ1bmN0aW9uIHRvIGdldCBhbGwgZmlsZXMKCi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBub3Qgc3VwcG9ydGVkIGluIEpTRE9NICovCgoKdmFyIGdldEFsbEZpbGVFbnRyaWVzID0gZnVuY3Rpb24gZ2V0QWxsRmlsZUVudHJpZXMoZGF0YVRyYW5zZmVySXRlbUxpc3QpIHsKICB2YXIgdHJhdmVyc2VEaXJlY3RvcmllcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogdHJ1ZTsKICByZXR1cm4gUHJvbWlzZS5hbGwoYXJyYXlGcm9tKGRhdGFUcmFuc2Zlckl0ZW1MaXN0KS5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgIHJldHVybiBpdGVtLmtpbmQgPT09ICdmaWxlJzsKICB9KS5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgIHZhciBlbnRyeSA9IGdldERhdGFUcmFuc2Zlckl0ZW1FbnRyeShpdGVtKTsKCiAgICBpZiAoZW50cnkpIHsKICAgICAgaWYgKGVudHJ5LmlzRGlyZWN0b3J5ICYmIHRyYXZlcnNlRGlyZWN0b3JpZXMpIHsKICAgICAgICByZXR1cm4gZ2V0QWxsRmlsZUVudHJpZXNJbkRpcmVjdG9yeShlbnRyeS5jcmVhdGVSZWFkZXIoKSwgIiIuY29uY2F0KGVudHJ5Lm5hbWUsICIvIikpOwogICAgICB9IGVsc2UgaWYgKGVudHJ5LmlzRmlsZSkgewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgZW50cnkuZmlsZShmdW5jdGlvbiAoZmlsZSkgewogICAgICAgICAgICBmaWxlLiRwYXRoID0gJyc7CiAgICAgICAgICAgIHJlc29sdmUoZmlsZSk7CiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBudWxsOwogIH0pLmZpbHRlcihpZGVudGl0eSkpOwp9OyAvLyBHZXQgYWxsIHRoZSBmaWxlIGVudHJpZXMgKHJlY3Vyc2l2ZSkgaW4gYSBkaXJlY3RvcnkKCi8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBub3Qgc3VwcG9ydGVkIGluIEpTRE9NICovCgoKdmFyIGdldEFsbEZpbGVFbnRyaWVzSW5EaXJlY3RvcnkgPSBmdW5jdGlvbiBnZXRBbGxGaWxlRW50cmllc0luRGlyZWN0b3J5KGRpcmVjdG9yeVJlYWRlcikgewogIHZhciBwYXRoID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAnJzsKICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgIHZhciBlbnRyeVByb21pc2VzID0gW107CgogICAgdmFyIHJlYWREaXJlY3RvcnlFbnRyaWVzID0gZnVuY3Rpb24gcmVhZERpcmVjdG9yeUVudHJpZXMoKSB7CiAgICAgIGRpcmVjdG9yeVJlYWRlci5yZWFkRW50cmllcyhmdW5jdGlvbiAoZW50cmllcykgewogICAgICAgIGlmIChlbnRyaWVzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgcmVzb2x2ZShQcm9taXNlLmFsbChlbnRyeVByb21pc2VzKS50aGVuKGZ1bmN0aW9uIChlbnRyaWVzKSB7CiAgICAgICAgICAgIHJldHVybiBmbGF0dGVuKGVudHJpZXMpOwogICAgICAgICAgfSkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBlbnRyeVByb21pc2VzLnB1c2goUHJvbWlzZS5hbGwoZW50cmllcy5tYXAoZnVuY3Rpb24gKGVudHJ5KSB7CiAgICAgICAgICAgIGlmIChlbnRyeSkgewogICAgICAgICAgICAgIGlmIChlbnRyeS5pc0RpcmVjdG9yeSkgewogICAgICAgICAgICAgICAgcmV0dXJuIGdldEFsbEZpbGVFbnRyaWVzSW5EaXJlY3RvcnkoZW50cnkuY3JlYXRlUmVhZGVyKCksICIiLmNvbmNhdChwYXRoKS5jb25jYXQoZW50cnkubmFtZSwgIi8iKSk7CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChlbnRyeS5pc0ZpbGUpIHsKICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgICAgICAgICBlbnRyeS5maWxlKGZ1bmN0aW9uIChmaWxlKSB7CiAgICAgICAgICAgICAgICAgICAgZmlsZS4kcGF0aCA9ICIiLmNvbmNhdChwYXRoKS5jb25jYXQoZmlsZS5uYW1lKTsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZpbGUpOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICB9KS5maWx0ZXIoaWRlbnRpdHkpKSk7CiAgICAgICAgICByZWFkRGlyZWN0b3J5RW50cmllcygpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9OwoKICAgIHJlYWREaXJlY3RvcnlFbnRyaWVzKCk7CiAgfSk7Cn07IC8vIC0tLSBQcm9wcyAtLS0KCgp2YXIgcHJvcHMgPSBtYWtlUHJvcHNDb25maWd1cmFibGUoc29ydEtleXMoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoX29iamVjdFNwcmVhZCh7fSwgaWRQcm9wcyksIG1vZGVsUHJvcHMpLCBmb3JtQ29udHJvbFByb3BzKSwgZm9ybUN1c3RvbVByb3BzKSwgZm9ybVN0YXRlUHJvcHMpLCBmb3JtU2l6ZVByb3BzKSwge30sIHsKICBhY2NlcHQ6IG1ha2VQcm9wKFBST1BfVFlQRV9TVFJJTkcsICcnKSwKICBicm93c2VUZXh0OiBtYWtlUHJvcChQUk9QX1RZUEVfU1RSSU5HLCAnQnJvd3NlJyksCiAgLy8gSW5zdHJ1Y3QgaW5wdXQgdG8gY2FwdHVyZSBmcm9tIGNhbWVyYQogIGNhcHR1cmU6IG1ha2VQcm9wKFBST1BfVFlQRV9CT09MRUFOLCBmYWxzZSksCiAgZGlyZWN0b3J5OiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpLAogIGRyb3BQbGFjZWhvbGRlcjogbWFrZVByb3AoUFJPUF9UWVBFX1NUUklORywgJ0Ryb3AgZmlsZXMgaGVyZScpLAogIGZpbGVOYW1lRm9ybWF0dGVyOiBtYWtlUHJvcChQUk9QX1RZUEVfRlVOQ1RJT04pLAogIG11bHRpcGxlOiBtYWtlUHJvcChQUk9QX1RZUEVfQk9PTEVBTiwgZmFsc2UpLAogIG5vRHJvcDogbWFrZVByb3AoUFJPUF9UWVBFX0JPT0xFQU4sIGZhbHNlKSwKICBub0Ryb3BQbGFjZWhvbGRlcjogbWFrZVByb3AoUFJPUF9UWVBFX1NUUklORywgJ05vdCBhbGxvd2VkJyksCiAgLy8gVE9ETzoKICAvLyAgIFNob3VsZCB3ZSBkZXByZWNhdGUgdGhpcyBhbmQgb25seSBzdXBwb3J0IGZsYXQgZmlsZSBzdHJ1Y3R1cmVzPwogIC8vICAgTmVzdGVkIGZpbGUgc3RydWN0dXJlcyBhcmUgb25seSBzdXBwb3J0ZWQgd2hlbiBmaWxlcyBhcmUgZHJvcHBlZAogIC8vICAgQSBDaHJvbWl1bSAiYnVnIiBwcmV2ZW50cyBgd2Via2l0RW50cmllc2AgZnJvbSBiZWluZyBwb3B1bGF0ZWQKICAvLyAgIG9uIHRoZSBmaWxlIGlucHV0J3MgYGNoYW5nZWAgZXZlbnQgYW5kIGlzIG1hcmtlZCBhcyAiV29udEZpeCIKICAvLyAgIE1vemlsbGEgaW1wbGVtZW50ZWQgdGhlIGJlaGF2aW9yIHRoZSBzYW1lIHdheSBhcyBDaHJvbWl1bQogIC8vICAgU2VlOiBodHRwczovL2J1Z3MuY2hyb21pdW0ub3JnL3AvY2hyb21pdW0vaXNzdWVzL2RldGFpbD9pZD0xMzg5ODcKICAvLyAgIFNlZTogaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTMyNjAzMQogIG5vVHJhdmVyc2U6IG1ha2VQcm9wKFBST1BfVFlQRV9CT09MRUFOLCBmYWxzZSksCiAgcGxhY2Vob2xkZXI6IG1ha2VQcm9wKFBST1BfVFlQRV9TVFJJTkcsICdObyBmaWxlIGNob3NlbicpCn0pKSwgTkFNRV9GT1JNX0ZJTEUpOyAvLyAtLS0gTWFpbiBjb21wb25lbnQgLS0tCi8vIEB2dWUvY29tcG9uZW50CgpleHBvcnQgdmFyIEJGb3JtRmlsZSA9IC8qI19fUFVSRV9fKi9WdWUuZXh0ZW5kKHsKICBuYW1lOiBOQU1FX0ZPUk1fRklMRSwKICBtaXhpbnM6IFthdHRyc01peGluLCBpZE1peGluLCBtb2RlbE1peGluLCBub3JtYWxpemVTbG90TWl4aW4sIGZvcm1Db250cm9sTWl4aW4sIGZvcm1TdGF0ZU1peGluLCBmb3JtQ3VzdG9tTWl4aW4sIG5vcm1hbGl6ZVNsb3RNaXhpbl0sCiAgaW5oZXJpdEF0dHJzOiBmYWxzZSwKICBwcm9wczogcHJvcHMsCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGZpbGVzOiBbXSwKICAgICAgZHJhZ2dpbmc6IGZhbHNlLAogICAgICAvLyBJRSAxMSBkb2Vzbid0IHJlc3BlY3Qgc2V0dGluZyBgZXZlbnQuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3RgLAogICAgICAvLyBzbyB3ZSBoYW5kbGUgaXQgb3Vyc2VsdmVzIGFzIHdlbGwKICAgICAgLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzQ2OTE1OTcxLzI3NDQ3NzYKICAgICAgZHJvcEFsbG93ZWQ6ICF0aGlzLm5vRHJvcCwKICAgICAgaGFzRm9jdXM6IGZhbHNlCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC8vIENvbnZlcnQgYGFjY2VwdGAgdG8gYW4gYXJyYXkgb2YgYFt7IFJlZ0V4cHIsIGlzTWltZSB9LCAuLi5dYAogICAgY29tcHV0ZWRBY2NlcHQ6IGZ1bmN0aW9uIGNvbXB1dGVkQWNjZXB0KCkgewogICAgICB2YXIgYWNjZXB0ID0gdGhpcy5hY2NlcHQ7CiAgICAgIGFjY2VwdCA9IChhY2NlcHQgfHwgJycpLnRyaW0oKS5zcGxpdCgvWyxcc10rLykuZmlsdGVyKGlkZW50aXR5KTsgLy8gQWxsb3cgYW55IGZpbGUgdHlwZS9leHRlbnNpb24KCiAgICAgIGlmIChhY2NlcHQubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KCiAgICAgIHJldHVybiBhY2NlcHQubWFwKGZ1bmN0aW9uIChleHRPclR5cGUpIHsKICAgICAgICB2YXIgcHJvcCA9ICduYW1lJzsKICAgICAgICB2YXIgc3RhcnRNYXRjaCA9ICdeJzsKICAgICAgICB2YXIgZW5kTWF0Y2ggPSAnJCc7CgogICAgICAgIGlmIChSWF9FWFRFTlNJT04udGVzdChleHRPclR5cGUpKSB7CiAgICAgICAgICAvLyBGaWxlIGV4dGVuc2lvbiAvXC5leHQkLwogICAgICAgICAgc3RhcnRNYXRjaCA9ICcnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBNSU1FIHR5cGUgL15taW1lXC8uKyQvIG9yIC9ebWltZVwvdHlwZSQvCiAgICAgICAgICBwcm9wID0gJ3R5cGUnOwoKICAgICAgICAgIGlmIChSWF9TVEFSLnRlc3QoZXh0T3JUeXBlKSkgewogICAgICAgICAgICBlbmRNYXRjaCA9ICcuKyQnOyAvLyBSZW1vdmUgdHJhaWxpbmcgYCpgCgogICAgICAgICAgICBleHRPclR5cGUgPSBleHRPclR5cGUuc2xpY2UoMCwgLTEpOwogICAgICAgICAgfQogICAgICAgIH0gLy8gRXNjYXBlIGFsbCBSZWdFeHAgc3BlY2lhbCBjaGFycwoKCiAgICAgICAgZXh0T3JUeXBlID0gZXNjYXBlUmVnRXhwKGV4dE9yVHlwZSk7CiAgICAgICAgdmFyIHJ4ID0gbmV3IFJlZ0V4cCgiIi5jb25jYXQoc3RhcnRNYXRjaCkuY29uY2F0KGV4dE9yVHlwZSkuY29uY2F0KGVuZE1hdGNoKSk7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHJ4OiByeCwKICAgICAgICAgIHByb3A6IHByb3AKICAgICAgICB9OwogICAgICB9KTsKICAgIH0sCiAgICBjb21wdXRlZENhcHR1cmU6IGZ1bmN0aW9uIGNvbXB1dGVkQ2FwdHVyZSgpIHsKICAgICAgdmFyIGNhcHR1cmUgPSB0aGlzLmNhcHR1cmU7CiAgICAgIHJldHVybiBjYXB0dXJlID09PSB0cnVlIHx8IGNhcHR1cmUgPT09ICcnID8gdHJ1ZSA6IGNhcHR1cmUgfHwgbnVsbDsKICAgIH0sCiAgICBjb21wdXRlZEF0dHJzOiBmdW5jdGlvbiBjb21wdXRlZEF0dHJzKCkgewogICAgICB2YXIgbmFtZSA9IHRoaXMubmFtZSwKICAgICAgICAgIGRpc2FibGVkID0gdGhpcy5kaXNhYmxlZCwKICAgICAgICAgIHJlcXVpcmVkID0gdGhpcy5yZXF1aXJlZCwKICAgICAgICAgIGZvcm0gPSB0aGlzLmZvcm0sCiAgICAgICAgICBjb21wdXRlZENhcHR1cmUgPSB0aGlzLmNvbXB1dGVkQ2FwdHVyZSwKICAgICAgICAgIGFjY2VwdCA9IHRoaXMuYWNjZXB0LAogICAgICAgICAgbXVsdGlwbGUgPSB0aGlzLm11bHRpcGxlLAogICAgICAgICAgZGlyZWN0b3J5ID0gdGhpcy5kaXJlY3Rvcnk7CiAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIHRoaXMuYnZBdHRycyksIHt9LCB7CiAgICAgICAgdHlwZTogJ2ZpbGUnLAogICAgICAgIGlkOiB0aGlzLnNhZmVJZCgpLAogICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgZGlzYWJsZWQ6IGRpc2FibGVkLAogICAgICAgIHJlcXVpcmVkOiByZXF1aXJlZCwKICAgICAgICBmb3JtOiBmb3JtIHx8IG51bGwsCiAgICAgICAgY2FwdHVyZTogY29tcHV0ZWRDYXB0dXJlLAogICAgICAgIGFjY2VwdDogYWNjZXB0IHx8IG51bGwsCiAgICAgICAgbXVsdGlwbGU6IG11bHRpcGxlLAogICAgICAgIGRpcmVjdG9yeTogZGlyZWN0b3J5LAogICAgICAgIHdlYmtpdGRpcmVjdG9yeTogZGlyZWN0b3J5LAogICAgICAgICdhcmlhLXJlcXVpcmVkJzogcmVxdWlyZWQgPyAndHJ1ZScgOiBudWxsCiAgICAgIH0pOwogICAgfSwKICAgIGNvbXB1dGVkRmlsZU5hbWVGb3JtYXR0ZXI6IGZ1bmN0aW9uIGNvbXB1dGVkRmlsZU5hbWVGb3JtYXR0ZXIoKSB7CiAgICAgIHZhciBmaWxlTmFtZUZvcm1hdHRlciA9IHRoaXMuZmlsZU5hbWVGb3JtYXR0ZXI7CiAgICAgIHJldHVybiBoYXNQcm9wRnVuY3Rpb24oZmlsZU5hbWVGb3JtYXR0ZXIpID8gZmlsZU5hbWVGb3JtYXR0ZXIgOiB0aGlzLmRlZmF1bHRGaWxlTmFtZUZvcm1hdHRlcjsKICAgIH0sCiAgICBjbG9uZWRGaWxlczogZnVuY3Rpb24gY2xvbmVkRmlsZXMoKSB7CiAgICAgIHJldHVybiBjbG9uZURlZXAodGhpcy5maWxlcyk7CiAgICB9LAogICAgZmxhdHRlbmVkRmlsZXM6IGZ1bmN0aW9uIGZsYXR0ZW5lZEZpbGVzKCkgewogICAgICByZXR1cm4gZmxhdHRlbkRlZXAodGhpcy5maWxlcyk7CiAgICB9LAogICAgZmlsZU5hbWVzOiBmdW5jdGlvbiBmaWxlTmFtZXMoKSB7CiAgICAgIHJldHVybiB0aGlzLmZsYXR0ZW5lZEZpbGVzLm1hcChmdW5jdGlvbiAoZmlsZSkgewogICAgICAgIHJldHVybiBmaWxlLm5hbWU7CiAgICAgIH0pOwogICAgfSwKICAgIGxhYmVsQ29udGVudDogZnVuY3Rpb24gbGFiZWxDb250ZW50KCkgewogICAgICAvLyBEcmFnaW5nIGFjdGl2ZQoKICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IHVzZWQgYnkgZHJhZy9kcm9wIHdoaWNoIGNhbid0IGJlIHRlc3RlZCBlYXNpbHkgKi8KICAgICAgaWYgKHRoaXMuZHJhZ2dpbmcgJiYgIXRoaXMubm9Ecm9wKSB7CiAgICAgICAgcmV0dXJuICgvLyBUT0RPOiBBZGQgYWRkaXRpb25hbCBzY29wZSB3aXRoIGZpbGUgY291bnQsIGFuZCBvdGhlciBub3QtYWxsb3dlZCByZWFzb25zCiAgICAgICAgICB0aGlzLm5vcm1hbGl6ZVNsb3QoU0xPVF9OQU1FX0RST1BfUExBQ0VIT0xERVIsIHsKICAgICAgICAgICAgYWxsb3dlZDogdGhpcy5kcm9wQWxsb3dlZAogICAgICAgICAgfSkgfHwgKHRoaXMuZHJvcEFsbG93ZWQgPyB0aGlzLmRyb3BQbGFjZWhvbGRlciA6IHRoaXMuJGNyZWF0ZUVsZW1lbnQoJ3NwYW4nLCB7CiAgICAgICAgICAgIHN0YXRpY0NsYXNzOiAndGV4dC1kYW5nZXInCiAgICAgICAgICB9LCB0aGlzLm5vRHJvcFBsYWNlaG9sZGVyKSkKICAgICAgICApOwogICAgICB9IC8vIE5vIGZpbGUgY2hvc2VuCgoKICAgICAgaWYgKHRoaXMuZmlsZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubm9ybWFsaXplU2xvdChTTE9UX05BTUVfUExBQ0VIT0xERVIpIHx8IHRoaXMucGxhY2Vob2xkZXI7CiAgICAgIH0KCiAgICAgIHZhciBmbGF0dGVuZWRGaWxlcyA9IHRoaXMuZmxhdHRlbmVkRmlsZXMsCiAgICAgICAgICBjbG9uZWRGaWxlcyA9IHRoaXMuY2xvbmVkRmlsZXMsCiAgICAgICAgICBmaWxlTmFtZXMgPSB0aGlzLmZpbGVOYW1lcywKICAgICAgICAgIGNvbXB1dGVkRmlsZU5hbWVGb3JtYXR0ZXIgPSB0aGlzLmNvbXB1dGVkRmlsZU5hbWVGb3JtYXR0ZXI7IC8vIFRoZXJlIGlzIGEgc2xvdCBmb3IgZm9ybWF0dGluZyB0aGUgZmlsZXMvbmFtZXMKCiAgICAgIGlmICh0aGlzLmhhc05vcm1hbGl6ZWRTbG90KFNMT1RfTkFNRV9GSUxFX05BTUUpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubm9ybWFsaXplU2xvdChTTE9UX05BTUVfRklMRV9OQU1FLCB7CiAgICAgICAgICBmaWxlczogZmxhdHRlbmVkRmlsZXMsCiAgICAgICAgICBmaWxlc1RyYXZlcnNlZDogY2xvbmVkRmlsZXMsCiAgICAgICAgICBuYW1lczogZmlsZU5hbWVzCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjb21wdXRlZEZpbGVOYW1lRm9ybWF0dGVyKGZsYXR0ZW5lZEZpbGVzLCBjbG9uZWRGaWxlcywgZmlsZU5hbWVzKTsKICAgIH0KICB9LAogIHdhdGNoOiAoX3dhdGNoID0ge30sIF9kZWZpbmVQcm9wZXJ0eShfd2F0Y2gsIE1PREVMX1BST1BfTkFNRSwgZnVuY3Rpb24gKG5ld1ZhbHVlKSB7CiAgICBpZiAoIW5ld1ZhbHVlIHx8IGlzQXJyYXkobmV3VmFsdWUpICYmIG5ld1ZhbHVlLmxlbmd0aCA9PT0gMCkgewogICAgICB0aGlzLnJlc2V0KCk7CiAgICB9CiAgfSksIF9kZWZpbmVQcm9wZXJ0eShfd2F0Y2gsICJmaWxlcyIsIGZ1bmN0aW9uIGZpbGVzKG5ld1ZhbHVlLCBvbGRWYWx1ZSkgewogICAgaWYgKCFsb29zZUVxdWFsKG5ld1ZhbHVlLCBvbGRWYWx1ZSkpIHsKICAgICAgdmFyIG11bHRpcGxlID0gdGhpcy5tdWx0aXBsZSwKICAgICAgICAgIG5vVHJhdmVyc2UgPSB0aGlzLm5vVHJhdmVyc2U7CiAgICAgIHZhciBmaWxlcyA9ICFtdWx0aXBsZSB8fCBub1RyYXZlcnNlID8gZmxhdHRlbkRlZXAobmV3VmFsdWUpIDogbmV3VmFsdWU7CiAgICAgIHRoaXMuJGVtaXQoTU9ERUxfRVZFTlRfTkFNRSwgbXVsdGlwbGUgPyBmaWxlcyA6IGZpbGVzWzBdIHx8IG51bGwpOwogICAgfQogIH0pLCBfd2F0Y2gpLAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICAvLyBDcmVhdGUgcHJpdmF0ZSBub24tcmVhY3RpdmUgcHJvcHMKICAgIHRoaXMuJF9mb3JtID0gbnVsbDsKICB9LAogIG1vdW50ZWQ6IGZ1bmN0aW9uIG1vdW50ZWQoKSB7CiAgICAvLyBMaXN0ZW4gZm9yIGZvcm0gcmVzZXQgZXZlbnRzLCB0byByZXNldCB0aGUgZmlsZSBpbnB1dAogICAgdmFyICRmb3JtID0gY2xvc2VzdCgnZm9ybScsIHRoaXMuJGVsKTsKCiAgICBpZiAoJGZvcm0pIHsKICAgICAgZXZlbnRPbigkZm9ybSwgJ3Jlc2V0JywgdGhpcy5yZXNldCwgRVZFTlRfT1BUSU9OU19QQVNTSVZFKTsKICAgICAgdGhpcy4kX2Zvcm0gPSAkZm9ybTsKICAgIH0KICB9LAogIGJlZm9yZURlc3Ryb3k6IGZ1bmN0aW9uIGJlZm9yZURlc3Ryb3koKSB7CiAgICB2YXIgJGZvcm0gPSB0aGlzLiRfZm9ybTsKCiAgICBpZiAoJGZvcm0pIHsKICAgICAgZXZlbnRPZmYoJGZvcm0sICdyZXNldCcsIHRoaXMucmVzZXQsIEVWRU5UX09QVElPTlNfUEFTU0lWRSk7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBpc0ZpbGVWYWxpZDogZnVuY3Rpb24gaXNGaWxlVmFsaWQoZmlsZSkgewogICAgICBpZiAoIWZpbGUpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHZhciBhY2NlcHQgPSB0aGlzLmNvbXB1dGVkQWNjZXB0OwogICAgICByZXR1cm4gYWNjZXB0ID8gYWNjZXB0LnNvbWUoZnVuY3Rpb24gKGEpIHsKICAgICAgICByZXR1cm4gYS5yeC50ZXN0KGZpbGVbYS5wcm9wXSk7CiAgICAgIH0pIDogdHJ1ZTsKICAgIH0sCiAgICBpc0ZpbGVzQXJyYXlWYWxpZDogZnVuY3Rpb24gaXNGaWxlc0FycmF5VmFsaWQoZmlsZXMpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBpc0FycmF5KGZpbGVzKSA/IGZpbGVzLmV2ZXJ5KGZ1bmN0aW9uIChmaWxlKSB7CiAgICAgICAgcmV0dXJuIF90aGlzLmlzRmlsZVZhbGlkKGZpbGUpOwogICAgICB9KSA6IHRoaXMuaXNGaWxlVmFsaWQoZmlsZXMpOwogICAgfSwKICAgIGRlZmF1bHRGaWxlTmFtZUZvcm1hdHRlcjogZnVuY3Rpb24gZGVmYXVsdEZpbGVOYW1lRm9ybWF0dGVyKGZsYXR0ZW5lZEZpbGVzLCBjbG9uZWRGaWxlcywgZmlsZU5hbWVzKSB7CiAgICAgIHJldHVybiBmaWxlTmFtZXMuam9pbignLCAnKTsKICAgIH0sCiAgICBzZXRGaWxlczogZnVuY3Rpb24gc2V0RmlsZXMoZmlsZXMpIHsKICAgICAgLy8gUmVzZXQgdGhlIGRyYWdnaW5nIGZsYWdzCiAgICAgIHRoaXMuZHJvcEFsbG93ZWQgPSAhdGhpcy5ub0Ryb3A7CiAgICAgIHRoaXMuZHJhZ2dpbmcgPSBmYWxzZTsgLy8gU2V0IHRoZSBzZWxlY3RlZCBmaWxlcwoKICAgICAgdGhpcy5maWxlcyA9IHRoaXMubXVsdGlwbGUgPyB0aGlzLmRpcmVjdG9yeSA/IGZpbGVzIDogZmxhdHRlbkRlZXAoZmlsZXMpIDogZmxhdHRlbkRlZXAoZmlsZXMpLnNsaWNlKDAsIDEpOwogICAgfSwKCiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dDogdXNlZCBieSBEcmFnL0Ryb3AgKi8KICAgIHNldElucHV0RmlsZXM6IGZ1bmN0aW9uIHNldElucHV0RmlsZXMoZmlsZXMpIHsKICAgICAgLy8gVHJ5IGFuIHNldCB0aGUgZmlsZSBpbnB1dCBmaWxlcyBhcnJheSBzbyB0aGF0IGByZXF1aXJlZGAKICAgICAgLy8gY29uc3RyYWludCB3b3JrcyBmb3IgZHJvcHBlZCBmaWxlcyAod2lsbCBmYWlsIGluIElFMTEgdGhvdWdoKQogICAgICAvLyBUbyBiZSB1c2VkIG9ubHkgd2hlbiBkcm9wcGluZyBmaWxlcwogICAgICB0cnkgewogICAgICAgIC8vIEZpcmVmb3ggPCA2MiB3b3JrYXJvdW5kIGV4cGxvaXRpbmcgaHR0cHM6Ly9idWd6aWxsYS5tb3ppbGxhLm9yZy9zaG93X2J1Zy5jZ2k/aWQ9MTQyMjY1NQogICAgICAgIHZhciBkYXRhVHJhbnNmZXIgPSBuZXcgQ2xpcGJvYXJkRXZlbnQoJycpLmNsaXBib2FyZERhdGEgfHwgbmV3IERhdGFUcmFuc2ZlcigpOyAvLyBBZGQgZmxhdHRlbmVkIGZpbGVzIHRvIHRlbXAgYGRhdGFUcmFuc2ZlcmAgb2JqZWN0IHRvIGdldCBhIHRydWUgYEZpbGVMaXN0YCBhcnJheQoKICAgICAgICBmbGF0dGVuRGVlcChjbG9uZURlZXAoZmlsZXMpKS5mb3JFYWNoKGZ1bmN0aW9uIChmaWxlKSB7CiAgICAgICAgICAvLyBNYWtlIHN1cmUgdG8gcmVtb3ZlIHRoZSBjdXN0b20gYCRwYXRoYCBhdHRyaWJ1dGUKICAgICAgICAgIGRlbGV0ZSBmaWxlLiRwYXRoOwogICAgICAgICAgZGF0YVRyYW5zZmVyLml0ZW1zLmFkZChmaWxlKTsKICAgICAgICB9KTsKICAgICAgICB0aGlzLiRyZWZzLmlucHV0LmZpbGVzID0gZGF0YVRyYW5zZmVyLmZpbGVzOwogICAgICB9IGNhdGNoIChfdW51c2VkKSB7fQogICAgfSwKICAgIHJlc2V0OiBmdW5jdGlvbiByZXNldCgpIHsKICAgICAgLy8gSUUgMTEgZG9lc24ndCBzdXBwb3J0IHNldHRpbmcgYCRpbnB1dC52YWx1ZWAgdG8gYCcnYCBvciBgbnVsbGAKICAgICAgLy8gU28gd2UgdXNlIHRoaXMgbGl0dGxlIGV4dHJhIGhhY2sgdG8gcmVzZXQgdGhlIHZhbHVlLCBqdXN0IGluIGNhc2UKICAgICAgLy8gVGhpcyBhbHNvIGFwcGVhcnMgdG8gd29yayBvbiBtb2Rlcm4gYnJvd3NlcnMgYXMgd2VsbAogICAgICAvLyBXcmFwcGVkIGluIHRyeSBpbiBjYXNlIElFIDExIG9yIG1vYmlsZSBTYWZhcmkgY3JhcCBvdXQKICAgICAgdHJ5IHsKICAgICAgICB2YXIgJGlucHV0ID0gdGhpcy4kcmVmcy5pbnB1dDsKICAgICAgICAkaW5wdXQudmFsdWUgPSAnJzsKICAgICAgICAkaW5wdXQudHlwZSA9ICcnOwogICAgICAgICRpbnB1dC50eXBlID0gJ2ZpbGUnOwogICAgICB9IGNhdGNoIChfdW51c2VkMikge30KCiAgICAgIHRoaXMuZmlsZXMgPSBbXTsKICAgIH0sCiAgICBoYW5kbGVGaWxlczogZnVuY3Rpb24gaGFuZGxlRmlsZXMoZmlsZXMpIHsKICAgICAgdmFyIGlzRHJvcCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CgogICAgICBpZiAoaXNEcm9wKSB7CiAgICAgICAgLy8gV2hlbiBkcm9wcGVkLCBtYWtlIHN1cmUgdG8gZmlsdGVyIGZpbGVzIHdpdGggdGhlIGludGVybmFsIGBhY2NlcHRgIGxvZ2ljCiAgICAgICAgdmFyIGZpbHRlcmVkRmlsZXMgPSBmaWxlcy5maWx0ZXIodGhpcy5pc0ZpbGVzQXJyYXlWYWxpZCk7IC8vIE9ubHkgdXBkYXRlIGZpbGVzIHdoZW4gd2UgaGF2ZSBhbnkgYWZ0ZXIgZmlsdGVyaW5nCgogICAgICAgIGlmIChmaWx0ZXJlZEZpbGVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHRoaXMuc2V0RmlsZXMoZmlsdGVyZWRGaWxlcyk7IC8vIFRyeSBhbiBzZXQgdGhlIGZpbGUgaW5wdXQncyBmaWxlcyBhcnJheSBzbyB0aGF0IGByZXF1aXJlZGAKICAgICAgICAgIC8vIGNvbnN0cmFpbnQgd29ya3MgZm9yIGRyb3BwZWQgZmlsZXMgKHdpbGwgZmFpbCBpbiBJRSAxMSB0aG91Z2gpCgogICAgICAgICAgdGhpcy5zZXRJbnB1dEZpbGVzKGZpbHRlcmVkRmlsZXMpOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBXZSBhbHdheXMgdXBkYXRlIHRoZSBmaWxlcyBmcm9tIHRoZSBgY2hhbmdlYCBldmVudAogICAgICAgIHRoaXMuc2V0RmlsZXMoZmlsZXMpOwogICAgICB9CiAgICB9LAogICAgZm9jdXNIYW5kbGVyOiBmdW5jdGlvbiBmb2N1c0hhbmRsZXIoZXZlbnQpIHsKICAgICAgLy8gQm9vdHN0cmFwIHY0IGRvZXNuJ3QgaGF2ZSBmb2N1cyBzdHlsaW5nIGZvciBjdXN0b20gZmlsZSBpbnB1dAogICAgICAvLyBGaXJlZm94IGhhcyBhIGBbdHlwZT1maWxlXTpmb2N1cyB+IHNpYmxpbmdgIHNlbGVjdG9yIGlzc3VlLAogICAgICAvLyBzbyB3ZSBhZGQgYSBgZm9jdXNgIGNsYXNzIHRvIGdldCBhcm91bmQgdGhlc2UgYnVncwogICAgICBpZiAodGhpcy5wbGFpbiB8fCBldmVudC50eXBlID09PSAnZm9jdXNvdXQnKSB7CiAgICAgICAgdGhpcy5oYXNGb2N1cyA9IGZhbHNlOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIEFkZCBmb2N1cyBzdHlsaW5nIGZvciBjdXN0b20gZmlsZSBpbnB1dAogICAgICAgIHRoaXMuaGFzRm9jdXMgPSB0cnVlOwogICAgICB9CiAgICB9LAogICAgb25DaGFuZ2U6IGZ1bmN0aW9uIG9uQ2hhbmdlKGV2ZW50KSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIHR5cGUgPSBldmVudC50eXBlLAogICAgICAgICAgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0LAogICAgICAgICAgX2V2ZW50JGRhdGFUcmFuc2ZlciA9IGV2ZW50LmRhdGFUcmFuc2ZlciwKICAgICAgICAgIGRhdGFUcmFuc2ZlciA9IF9ldmVudCRkYXRhVHJhbnNmZXIgPT09IHZvaWQgMCA/IHt9IDogX2V2ZW50JGRhdGFUcmFuc2ZlcjsKICAgICAgdmFyIGlzRHJvcCA9IHR5cGUgPT09ICdkcm9wJzsgLy8gQWx3YXlzIGVtaXQgb3JpZ2luYWwgZXZlbnQKCiAgICAgIHRoaXMuJGVtaXQoRVZFTlRfTkFNRV9DSEFOR0UsIGV2ZW50KTsKICAgICAgdmFyIGl0ZW1zID0gYXJyYXlGcm9tKGRhdGFUcmFuc2Zlci5pdGVtcyB8fCBbXSk7CgogICAgICBpZiAoSEFTX1BST01JU0VfU1VQUE9SVCAmJiBpdGVtcy5sZW5ndGggPiAwICYmICFpc051bGwoZ2V0RGF0YVRyYW5zZmVySXRlbUVudHJ5KGl0ZW1zWzBdKSkpIHsKICAgICAgICAvLyBEcm9wIGhhbmRsaW5nIGZvciBtb2Rlcm4gYnJvd3NlcnMKICAgICAgICAvLyBTdXBwb3J0cyBuZXN0ZWQgZGlyZWN0b3J5IHN0cnVjdHVyZXMgaW4gYGRpcmVjdG9yeWAgbW9kZQoKICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dDogbm90IHN1cHBvcnRlZCBpbiBKU0RPTSAqLwogICAgICAgIGdldEFsbEZpbGVFbnRyaWVzKGl0ZW1zLCB0aGlzLmRpcmVjdG9yeSkudGhlbihmdW5jdGlvbiAoZmlsZXMpIHsKICAgICAgICAgIHJldHVybiBfdGhpczIuaGFuZGxlRmlsZXMoZmlsZXMsIGlzRHJvcCk7CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gU3RhbmRhcmQgZmlsZSBpbnB1dCBoYW5kbGluZyAobmF0aXZlIGZpbGUgaW5wdXQgY2hhbmdlIGV2ZW50KSwKICAgICAgICAvLyBvciBmYWxsYmFjayBkcm9wIG1vZGUgKElFIDExIC8gT3BlcmEpIHdoaWNoIGRvbid0IHN1cHBvcnQgYGRpcmVjdG9yeWAgbW9kZQogICAgICAgIHZhciBmaWxlcyA9IGFycmF5RnJvbSh0YXJnZXQuZmlsZXMgfHwgZGF0YVRyYW5zZmVyLmZpbGVzIHx8IFtdKS5tYXAoZnVuY3Rpb24gKGZpbGUpIHsKICAgICAgICAgIC8vIEFkZCBjdXN0b20gYCRwYXRoYCBwcm9wZXJ0eSB0byBlYWNoIGZpbGUgKHRvIGJlIGNvbnNpc3RlbnQgd2l0aCBkcm9wIG1vZGUpCiAgICAgICAgICBmaWxlLiRwYXRoID0gZmlsZS53ZWJraXRSZWxhdGl2ZVBhdGggfHwgJyc7CiAgICAgICAgICByZXR1cm4gZmlsZTsKICAgICAgICB9KTsKICAgICAgICB0aGlzLmhhbmRsZUZpbGVzKGZpbGVzLCBpc0Ryb3ApOwogICAgICB9CiAgICB9LAogICAgb25EcmFnZW50ZXI6IGZ1bmN0aW9uIG9uRHJhZ2VudGVyKGV2ZW50KSB7CiAgICAgIHN0b3BFdmVudChldmVudCk7CiAgICAgIHRoaXMuZHJhZ2dpbmcgPSB0cnVlOwogICAgICB2YXIgX2V2ZW50JGRhdGFUcmFuc2ZlcjIgPSBldmVudC5kYXRhVHJhbnNmZXIsCiAgICAgICAgICBkYXRhVHJhbnNmZXIgPSBfZXZlbnQkZGF0YVRyYW5zZmVyMiA9PT0gdm9pZCAwID8ge30gOiBfZXZlbnQkZGF0YVRyYW5zZmVyMjsgLy8gRWFybHkgZXhpdCB3aGVuIHRoZSBpbnB1dCBvciBkcm9wcGluZyBpcyBkaXNhYmxlZAoKICAgICAgaWYgKHRoaXMubm9Ecm9wIHx8IHRoaXMuZGlzYWJsZWQgfHwgIXRoaXMuZHJvcEFsbG93ZWQpIHsKICAgICAgICAvLyBTaG93IGRlbnkgZmVlZGJhY2sKCiAgICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IG5vdCBzdXBwb3J0ZWQgaW4gSlNET00gKi8KICAgICAgICBkYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9ICdub25lJzsKICAgICAgICB0aGlzLmRyb3BBbGxvd2VkID0gZmFsc2U7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0OiBub3Qgc3VwcG9ydGVkIGluIEpTRE9NICovCgoKICAgICAgZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSAnY29weSc7CiAgICB9LAogICAgLy8gTm90ZSB0aGlzIGV2ZW50IGZpcmVzIHJlcGVhdGVkbHkgd2hpbGUgdGhlIG1vdXNlIGlzIG92ZXIgdGhlIGRyb3B6b25lIGF0CiAgICAvLyBpbnRlcnZhbHMgaW4gdGhlIG1pbGxpc2Vjb25kcywgc28gYXZvaWQgZG9pbmcgbXVjaCBwcm9jZXNzaW5nIGluIGhlcmUKICAgIG9uRHJhZ292ZXI6IGZ1bmN0aW9uIG9uRHJhZ292ZXIoZXZlbnQpIHsKICAgICAgc3RvcEV2ZW50KGV2ZW50KTsKICAgICAgdGhpcy5kcmFnZ2luZyA9IHRydWU7CiAgICAgIHZhciBfZXZlbnQkZGF0YVRyYW5zZmVyMyA9IGV2ZW50LmRhdGFUcmFuc2ZlciwKICAgICAgICAgIGRhdGFUcmFuc2ZlciA9IF9ldmVudCRkYXRhVHJhbnNmZXIzID09PSB2b2lkIDAgPyB7fSA6IF9ldmVudCRkYXRhVHJhbnNmZXIzOyAvLyBFYXJseSBleGl0IHdoZW4gdGhlIGlucHV0IG9yIGRyb3BwaW5nIGlzIGRpc2FibGVkCgogICAgICBpZiAodGhpcy5ub0Ryb3AgfHwgdGhpcy5kaXNhYmxlZCB8fCAhdGhpcy5kcm9wQWxsb3dlZCkgewogICAgICAgIC8vIFNob3cgZGVueSBmZWVkYmFjawoKICAgICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dDogbm90IHN1cHBvcnRlZCBpbiBKU0RPTSAqLwogICAgICAgIGRhdGFUcmFuc2Zlci5kcm9wRWZmZWN0ID0gJ25vbmUnOwogICAgICAgIHRoaXMuZHJvcEFsbG93ZWQgPSBmYWxzZTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgLyogaXN0YW5idWwgaWdub3JlIG5leHQ6IG5vdCBzdXBwb3J0ZWQgaW4gSlNET00gKi8KCgogICAgICBkYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9ICdjb3B5JzsKICAgIH0sCiAgICBvbkRyYWdsZWF2ZTogZnVuY3Rpb24gb25EcmFnbGVhdmUoZXZlbnQpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICBzdG9wRXZlbnQoZXZlbnQpOwogICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMzLmRyYWdnaW5nID0gZmFsc2U7IC8vIFJlc2V0IGBkcm9wQWxsb3dlZGAgdG8gZGVmYXVsdAoKICAgICAgICBfdGhpczMuZHJvcEFsbG93ZWQgPSAhX3RoaXMzLm5vRHJvcDsKICAgICAgfSk7CiAgICB9LAogICAgLy8gVHJpZ2dlcmVkIGJ5IGEgZmlsZSBkcm9wIG9udG8gZHJvcCB0YXJnZXQKICAgIG9uRHJvcDogZnVuY3Rpb24gb25Ecm9wKGV2ZW50KSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgc3RvcEV2ZW50KGV2ZW50KTsKICAgICAgdGhpcy5kcmFnZ2luZyA9IGZhbHNlOyAvLyBFYXJseSBleGl0IHdoZW4gdGhlIGlucHV0IG9yIGRyb3BwaW5nIGlzIGRpc2FibGVkCgogICAgICBpZiAodGhpcy5ub0Ryb3AgfHwgdGhpcy5kaXNhYmxlZCB8fCAhdGhpcy5kcm9wQWxsb3dlZCkgewogICAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIFJlc2V0IGBkcm9wQWxsb3dlZGAgdG8gZGVmYXVsdAogICAgICAgICAgX3RoaXM0LmRyb3BBbGxvd2VkID0gIV90aGlzNC5ub0Ryb3A7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLm9uQ2hhbmdlKGV2ZW50KTsKICAgIH0KICB9LAogIHJlbmRlcjogZnVuY3Rpb24gcmVuZGVyKGgpIHsKICAgIHZhciBjdXN0b20gPSB0aGlzLmN1c3RvbSwKICAgICAgICBwbGFpbiA9IHRoaXMucGxhaW4sCiAgICAgICAgc2l6ZSA9IHRoaXMuc2l6ZSwKICAgICAgICBkcmFnZ2luZyA9IHRoaXMuZHJhZ2dpbmcsCiAgICAgICAgc3RhdGVDbGFzcyA9IHRoaXMuc3RhdGVDbGFzcywKICAgICAgICBidkF0dHJzID0gdGhpcy5idkF0dHJzOyAvLyBGb3JtIElucHV0CgogICAgdmFyICRpbnB1dCA9IGgoJ2lucHV0JywgewogICAgICAiY2xhc3MiOiBbewogICAgICAgICdmb3JtLWNvbnRyb2wtZmlsZSc6IHBsYWluLAogICAgICAgICdjdXN0b20tZmlsZS1pbnB1dCc6IGN1c3RvbSwKICAgICAgICBmb2N1czogY3VzdG9tICYmIHRoaXMuaGFzRm9jdXMKICAgICAgfSwgc3RhdGVDbGFzc10sCiAgICAgIC8vIFdpdGggSUUgMTEsIHRoZSBpbnB1dCBnZXRzIGluIHRoZSAid2F5IiBvZiB0aGUgZHJvcCBldmVudHMsCiAgICAgIC8vIHNvIHdlIG1vdmUgaXQgb3V0IG9mIHRoZSB3YXkgYnkgcHV0dGluZyBpdCBiZWhpbmQgdGhlIGxhYmVsCiAgICAgIC8vIEJvb3RzdHJhcCB2NCBoYXMgaXQgaW4gZnJvbnQKICAgICAgc3R5bGU6IGN1c3RvbSA/IHsKICAgICAgICB6SW5kZXg6IC01CiAgICAgIH0gOiB7fSwKICAgICAgYXR0cnM6IHRoaXMuY29tcHV0ZWRBdHRycywKICAgICAgb246IHsKICAgICAgICBjaGFuZ2U6IHRoaXMub25DaGFuZ2UsCiAgICAgICAgZm9jdXNpbjogdGhpcy5mb2N1c0hhbmRsZXIsCiAgICAgICAgZm9jdXNvdXQ6IHRoaXMuZm9jdXNIYW5kbGVyLAogICAgICAgIHJlc2V0OiB0aGlzLnJlc2V0CiAgICAgIH0sCiAgICAgIHJlZjogJ2lucHV0JwogICAgfSk7CgogICAgaWYgKHBsYWluKSB7CiAgICAgIHJldHVybiAkaW5wdXQ7CiAgICB9IC8vIE92ZXJsYXkgbGFiZWwKCgogICAgdmFyICRsYWJlbCA9IGgoJ2xhYmVsJywgewogICAgICBzdGF0aWNDbGFzczogJ2N1c3RvbS1maWxlLWxhYmVsJywKICAgICAgImNsYXNzIjogewogICAgICAgIGRyYWdnaW5nOiBkcmFnZ2luZwogICAgICB9LAogICAgICBhdHRyczogewogICAgICAgICJmb3IiOiB0aGlzLnNhZmVJZCgpLAogICAgICAgIC8vIFRoaXMgZ29lcyBhd2F5IGluIEJvb3RzdHJhcCB2NQogICAgICAgICdkYXRhLWJyb3dzZSc6IHRoaXMuYnJvd3NlVGV4dCB8fCBudWxsCiAgICAgIH0KICAgIH0sIFtoKCdzcGFuJywgewogICAgICBzdGF0aWNDbGFzczogJ2QtYmxvY2sgZm9ybS1maWxlLXRleHQnLAogICAgICAvLyBgcG9pbnRlci1ldmVudHM6IG5vbmVgIGlzIHVzZWQgdG8gbWFrZSBzdXJlCiAgICAgIC8vIHRoZSBkcmFnIGV2ZW50cyBmaXJlIG9ubHkgb24gdGhlIGxhYmVsCiAgICAgIHN0eWxlOiB7CiAgICAgICAgcG9pbnRlckV2ZW50czogJ25vbmUnCiAgICAgIH0KICAgIH0sIFt0aGlzLmxhYmVsQ29udGVudF0pXSk7IC8vIFJldHVybiByZW5kZXJlZCBjdXN0b20gZmlsZSBpbnB1dAoKICAgIHJldHVybiBoKCdkaXYnLCB7CiAgICAgIHN0YXRpY0NsYXNzOiAnY3VzdG9tLWZpbGUgYi1mb3JtLWZpbGUnLAogICAgICAiY2xhc3MiOiBbX2RlZmluZVByb3BlcnR5KHt9LCAiYi1jdXN0b20tY29udHJvbC0iLmNvbmNhdChzaXplKSwgc2l6ZSksIHN0YXRlQ2xhc3MsIGJ2QXR0cnNbImNsYXNzIl1dLAogICAgICBzdHlsZTogYnZBdHRycy5zdHlsZSwKICAgICAgYXR0cnM6IHsKICAgICAgICBpZDogdGhpcy5zYWZlSWQoJ19CVl9maWxlX291dGVyXycpCiAgICAgIH0sCiAgICAgIG9uOiB7CiAgICAgICAgZHJhZ2VudGVyOiB0aGlzLm9uRHJhZ2VudGVyLAogICAgICAgIGRyYWdvdmVyOiB0aGlzLm9uRHJhZ292ZXIsCiAgICAgICAgZHJhZ2xlYXZlOiB0aGlzLm9uRHJhZ2xlYXZlLAogICAgICAgIGRyb3A6IHRoaXMub25Ecm9wCiAgICAgIH0KICAgIH0sIFskaW5wdXQsICRsYWJlbF0pOwogIH0KfSk7"},null]}